# ----------------------------------------
#		R E G U L A R	T I L E S E T
# ----------------------------------------

# % production will always be before
# ------------- ENERGY -----------------
building_energy_grid = {
	base_buildtime = @b1_time
	base_cap_amount = 1
	position_priority = 210		# Basic boost

	category = resource

	prerequisites = {
		tech_power_hub_1
	}

	show_tech_unlock_if = {
		tec_is_biohive = no
	}
	
	upgrades = {
		building_energy_nexus
	}

	potential = {
		exists = owner
		owner = {
			tec_is_biohive = no
		}
		NOR = {
			has_modifier = resort_colony
			has_modifier = crucible_colony
		}
		OR = {
			NOT = {
				uses_habitat_capitals = yes
			}
			AND = {
				exists = owner
				owner = { is_gestalt = yes }
			}
			has_planet_flag = energy_habitat
		}
	}

	destroy_trigger = {
		exists = owner
		OR = {
			OR = {
				has_modifier = resort_colony
				has_modifier = crucible_colony
			}
			owner = {
				tec_is_biohive = yes
			}
			AND = {
				owner = {
					is_ai = yes
				}
				has_any_generator_district_or_building = no
			}
		}
	}

	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 1
		}

		inline_script = {
			script = buildings/inline_evolved_machine_prod_extra_cost
			tier = 1
		}
	}

	planet_modifier = {
		planet_technician_energy_produces_add = 1
	}

	inline_script = {
		script = jobs/inline_evolved_technician
		regular_count = 1
		hive_count = 1
		machine_count = 1
		machine_aquatic_count = 1
		display = with_desc
		trigger = ""
	}

	inline_script = {
		script = buildings/inline_evolved_production_extra_districts
		district = district_generator
		trigger = "
			is_robot_empire = yes
		"
		tier = 1
	}
}

building_energy_nexus = {
	base_buildtime = @b2_time
	can_build = no
	position_priority = 210		# Basic boost

	category = resource


	prerequisites = {
		tech_power_hub_2
	}

	show_tech_unlock_if = {
		tec_is_biohive = no
	}

	allow = {
		has_upgraded_capital = yes
	}

	destroy_trigger = {
		exists = owner
		OR = {
			OR = {
				has_modifier = resort_colony
				has_modifier = crucible_colony
			}
			AND = {
				owner = {
					is_ai = yes
				}
				has_any_generator_district_or_building = no
			}
			owner = {
				tec_is_biohive = yes
			}
		}
	}

	upgrades = {
		"building_energy_complex"
	}

	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 2
		}

		inline_script = {
			script = buildings/inline_evolved_rare_resource_cost
			tier = 2
			rare = exotic_gases
		}

		inline_script = {
			script = buildings/inline_evolved_machine_prod_extra_cost
			tier = 2
		}

		inline_script = {
			script = buildings/inline_evolved_ring_production_cost
			rare = exotic_gases
		}
	}

	planet_modifier = {
		planet_technician_energy_produces_add = 2
	}

	triggered_planet_modifier = {
		potential = {
			has_ringworld_output_boost = yes
		}
		modifier = {
			planet_technician_energy_produces_add = 1
		}
	}

	inline_script = {
		script = jobs/inline_evolved_technician
		regular_count = 2
		hive_count = 2
		machine_count = 2
		machine_aquatic_count = 2
		display = with_desc
		trigger = ""
	}
	
	inline_script = {
		script = buildings/inline_evolved_production_extra_districts
		district = district_generator
		trigger = "
			is_robot_empire = yes
		"
		tier = 2
	}
}

building_energy_complex = {
	icon = building_tec_energy_complex
	base_buildtime = @b3_time
	can_build = no
	position_priority = 210		# Basic boost

	category = resource

	prerequisites = {
		"tech_tec_power_hub_3"
	}

	show_tech_unlock_if = {
		tec_is_biohive = no
	}

	allow = {
		has_upgraded_capital = yes
	}

	destroy_trigger = {
		exists = owner
		OR = {
			OR = {
				has_modifier = resort_colony
				has_modifier = crucible_colony
			}
			owner = {
				tec_is_biohive = yes
			}
			AND = {
				owner = {
					is_ai = yes
				}
				has_any_generator_district_or_building = no
			}
		}
	}
		
	resources = {
		category = planet_buildings

		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 4
		}

		inline_script = {
			script = buildings/inline_evolved_rare_resource_cost
			tier = 3
			rare = exotic_gases
		}

		inline_script = {
			script = buildings/inline_evolved_machine_prod_extra_cost
			tier = 3
		}

		inline_script = {
			script = buildings/inline_evolved_exotic_resource_cost
			exotic = sr_living_metal
		}

		inline_script = {
			script = buildings/inline_evolved_ring_production_cost
			rare = exotic_gases
		}
	}

	planet_modifier = {
		planet_technician_energy_produces_add = 3
	}

	triggered_planet_modifier = {
		potential = {
			has_ringworld_output_boost = yes
		}
		modifier = {
			planet_technician_energy_produces_add = 2
		}
	}

	inline_script = {
		script = jobs/inline_evolved_technician
		regular_count = 4
		hive_count = 4
		machine_count = 4
		machine_aquatic_count = 4
		display = with_desc
		trigger = ""
	}

	inline_script = {
		script = buildings/inline_evolved_production_extra_districts
		district = district_generator
		trigger = "
			is_robot_empire = yes
		"
		tier = 3
	}
}

# ------------- MINERALS -----------------
building_mineral_purification_plant = {
	base_buildtime = @b1_time
	base_cap_amount = 1
	position_priority = 210		# Basic boost

	category = resource

	prerequisites = {
		tech_mineral_purification_1
	}

	show_tech_unlock_if = {
		tec_is_biohive = no
	}

	upgrades = {
		building_mineral_purification_hub
	}

	potential = {
		exists = owner
		owner = {
			tec_is_biohive = no
		}
		NOR = {
			has_modifier = resort_colony
			has_modifier = crucible_colony
		}

		NOR = { # Ringworlds don't have mines
			tec_is_ringworld = yes
		}
		OR = { # Habitats only have mines if they're built on an appropriate deposit
			uses_habitat_capitals = no
			has_planet_flag = mining_habitat
		}
	}
		
	destroy_trigger = {
		exists = owner
		OR = {
			owner = {
				tec_is_biohive = yes
			}
			has_modifier = resort_colony
			AND = {
				owner = {
					is_ai = yes
				}
				has_any_mining_district = no
			}
		}
	}

	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 1
		}

		inline_script = {
			script = buildings/inline_evolved_machine_prod_extra_cost
			tier = 1
		}
	}

	inline_script = {
		script = buildings/inline_evolved_production_extra_districts
		district = district_mining
		tier = 1
	}

	inline_script = {
		script = jobs/inline_evolved_miner
		regular_count = 1
		regular_aquatic_count = 1
		hive_count = 1
		hive_aquatic_count = 1
		machine_count = 1
		display = with_desc
		trigger = ""
	}

	planet_modifier = {
		planet_miners_minerals_produces_add = 1
	}

	triggered_desc = {
		trigger = { tec_has_scrap_miner = no }
		text = building_mineral_purification_plant_desc
	}

	triggered_desc = {
		trigger = { tec_has_scrap_miner = yes }
		text = building_scrap_processing_plant_desc
	}
}

building_mineral_purification_hub = {
	base_buildtime = @b2_time
	can_build = no
	position_priority = 210		# Basic boost

	category = resource

	prerequisites = {
		tech_mineral_purification_2
	}

	show_tech_unlock_if = {
		tec_is_biohive = no
	}

	allow = {
		has_upgraded_capital = yes
		NOT = { has_modifier = resort_colony }
	}

	destroy_trigger = {
		exists = owner
		OR = {
			owner = {
				tec_is_biohive = yes
			}
			OR = {
				has_modifier = resort_colony
				has_modifier = crucible_colony
			}
			AND = {
				owner = {
					is_ai = yes
				}
				has_any_mining_district = no
			}
		}
	}

	upgrades = {
		"building_mineral_purification_complex"
	}

	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 2
		}

		inline_script = {
			script = buildings/inline_evolved_rare_resource_cost
			tier = 2
			rare = rare_crystals
		}

		inline_script = {
			script = buildings/inline_evolved_machine_prod_extra_cost
			tier = 2
		}

		inline_script = {
			script = buildings/inline_evolved_ring_production_cost
			rare = rare_crystals
		}
	}
	
	inline_script = {
		script = buildings/inline_evolved_production_extra_districts
		district = district_mining
		tier = 2
	}

	inline_script = {
		script = jobs/inline_evolved_miner
		regular_count = 2
		regular_aquatic_count = 2
		hive_count = 2
		hive_aquatic_count = 2
		machine_count = 2
		display = with_desc
		trigger = ""
	}

	triggered_planet_modifier = {
		potential = {
			tec_has_scrap_miner = no
		}
		modifier = {
			planet_miners_minerals_produces_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			tec_has_scrap_miner = yes
		}
		modifier = {
			planet_miners_minerals_produces_add = 1
			planet_miners_alloys_produces_add = 0.5
		}
	}

	triggered_planet_modifier = {
		potential = {
			has_ringworld_output_boost = yes
			tec_has_scrap_miner = no
		}
		modifier = {
			planet_miners_minerals_produces_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			has_ringworld_output_boost = yes
			tec_has_scrap_miner = yes
		}
		modifier = {
			planet_miners_minerals_produces_add = 0.5
			planet_miners_alloys_produces_add = 0.25
		}
	}

	triggered_desc = {
		trigger = { tec_has_scrap_miner = no }
		text = building_mineral_purification_hub_desc
	}

	triggered_desc = {
		trigger = { tec_has_scrap_miner = yes }
		text = building_scrap_processing_hub_desc
	}
}

building_mineral_purification_complex = {
	base_buildtime = @b3_time
	can_build = no
	position_priority = 210		# Basic boost

	category = resource

	prerequisites = {
		"tech_tec_mineral_purification_3"
	}

	show_tech_unlock_if = {
		tec_is_biohive = no
	}

	allow = {
		has_upgraded_capital = yes
		NOR = {
			has_modifier = resort_colony 
			is_planet_class = pc_shattered_ring_habitable
		}
	}

	destroy_trigger = {
		exists = owner
		OR = {
			owner = {
				tec_is_biohive = yes
			}
			OR = {
				has_modifier = resort_colony
				has_modifier = crucible_colony
			}
			AND = {
				owner = {
					is_ai = yes
				}
				has_any_mining_district = no
			}
		}
	}
	
	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 4
		}

		inline_script = {
			script = buildings/inline_evolved_rare_resource_cost
			tier = 3
			rare = rare_crystals
		}

		inline_script = {
			script = buildings/inline_evolved_machine_prod_extra_cost
			tier = 3
		}

		inline_script = {
			script = buildings/inline_evolved_ring_production_cost
			rare = rare_crystals
		}

		inline_script = {
			script = buildings/inline_evolved_exotic_resource_cost
			exotic = sr_living_metal
		}
	}

	inline_script = {
		script = buildings/inline_evolved_production_extra_districts
		district = district_mining
		tier = 3
	}

	inline_script = {
		script = jobs/inline_evolved_miner
		regular_count = 4
		regular_aquatic_count = 4
		hive_count = 4
		hive_aquatic_count = 4
		machine_count = 4
		display = with_desc
		trigger = ""
	}

	triggered_planet_modifier = {
		potential = {
			NOT = { is_planet_class = pc_shattered_ring_habitable }
		}
		modifier = {
			planet_miners_minerals_produces_add = 3
		}
	}

	triggered_planet_modifier = {
		potential = {
			is_planet_class = pc_shattered_ring_habitable
		}
		modifier = {
			planet_miners_minerals_produces_add = 2
			planet_miners_alloys_produces_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			has_ringworld_output_boost = yes
			NOT = { is_planet_class = pc_shattered_ring_habitable }
		}
		modifier = {
			planet_miners_minerals_produces_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			has_ringworld_output_boost = yes
			is_planet_class = pc_shattered_ring_habitable
		}
		modifier = {
			planet_miners_minerals_produces_add = 1
			planet_miners_alloys_produces_add = 0.5
		}
	}

	triggered_desc = {
		trigger = { tec_has_scrap_miner = no }
		text = building_mineral_purification_hub_desc
	}

	triggered_desc = {
		trigger = { tec_has_scrap_miner = yes }
		text = building_scrap_processing_hub_desc
	}
}

# ------------- FOOD -----------------
building_food_processing_facility = {
	base_buildtime = @b1_time
	base_cap_amount = 1
	position_priority = 210		# Basic boost

	category = resource

	prerequisites = {
		"tech_food_processing_1"
	}

	show_tech_unlock_if = {
		tec_is_biohive = no
	}

	upgrades = {
		building_food_processing_center
	}

	potential = {
		exists = owner
		owner = {
			tec_is_biohive = no
		}
		NOR = {
			uses_district_set = machine_world
			has_modifier = resort_colony
			has_modifier = crucible_colony
		}
	}

	destroy_trigger = {
		exists = owner
		OR = {
			owner = {
				tec_is_biohive = yes
			}
			owner = {
				is_ai = yes
				country_uses_food = no
			}
			uses_district_set = machine_world
			has_modifier = resort_colony
			has_modifier = crucible_colony
			AND = {
				owner = {
					is_ai = yes
				}
				has_any_farming_district_or_buildings = no
			}
		}
	}

	convert_to = {
		building_tec_biohive_food_processing_facility
	}

	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 1
		}

		inline_script = {
			script = buildings/inline_evolved_machine_prod_extra_cost
			tier = 1
		}
	}

	planet_modifier = {
		planet_farmers_food_produces_add = 1
	}

	# Civics
		triggered_desc = {	# Catalytic
			trigger = {
				exists = owner
				owner = {
					is_catalytic_empire = yes
				}
				planet = {
					NOR = {
						has_active_building = building_coordinated_fulfillment_center_1
						has_active_building = building_coordinated_fulfillment_center_2
					}
				}
			}
			text = tec_building_boost_catalytic_with_tech
		}
		triggered_planet_modifier = {	# Regular
			potential = {
				exists = owner
				owner = {
					is_catalytic_empire = yes
					has_technology = tech_eco_simulation
				}
				planet = {
					NOR = {
						has_active_building = building_coordinated_fulfillment_center_1
						has_active_building = building_coordinated_fulfillment_center_2
					}
				}
			}
			modifier = {
				planet_metallurgists_produces_mult = 0.05
			}
		}
		triggered_planet_modifier = {	# Regular
			potential = {
				exists = owner
				owner = {
					is_catalytic_empire = yes
					has_technology = tech_gene_crops
				}
				planet = {
					NOR = {
						has_active_building = building_coordinated_fulfillment_center_1
						has_active_building = building_coordinated_fulfillment_center_2
					}
				}
			}
			modifier = {
				planet_metallurgists_produces_mult = 0.05
			}
		}
	# /

	inline_script = {
		script = buildings/inline_evolved_production_extra_districts
		district = district_farming
		trigger = "
			is_robot_empire = yes
		"
		tier = 1
	}

	inline_script = {
		script = jobs/inline_evolved_farmer
		regular_count = 1
		regular_aquatic_count = 1
		hive_count = 1
		hive_aquatic_count = 1
		machine_count = 1
		display = with_desc
		trigger = ""
	}
}

building_food_processing_center = {
	base_buildtime = @b2_time
	can_build = no
	position_priority = 210		# Basic boost
	
	category = resource

	prerequisites = {
		"tech_food_processing_2"
	}

	show_tech_unlock_if = {
		tec_is_biohive = no
	}

	upgrades = {
		"building_food_processing_complex"
	}
	
	allow = {
		exists = owner
		has_upgraded_capital = yes
	}

	destroy_trigger = {
		exists = owner
		OR = {
			owner = {
				tec_is_biohive = yes
			}
			AND = {
				OR = {
					owner = {
						is_ai = yes
						country_uses_food = no
					}
					AND = {
						owner = {
							is_ai = yes
						}
						has_any_farming_district_or_buildings = no
					}
				}
			}
			uses_district_set = machine_world
			has_modifier = resort_colony
			has_modifier = crucible_colony
		}
	}

	convert_to = {
		building_tec_biohive_food_processing_center
	}
	
	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 2
		}

		inline_script = {
			script = buildings/inline_evolved_rare_resource_cost
			tier = 2
			rare = volatile_motes
		}

		inline_script = {
			script = buildings/inline_evolved_machine_prod_extra_cost
			tier = 2
		}

		inline_script = {
			script = buildings/inline_evolved_ring_production_cost
			rare = volatile_motes
		}
	}

	# Modifiers
		# Standard
			planet_modifier = {
				planet_farmers_food_produces_add = 2
			}

			triggered_planet_modifier = {
				potential = {
					has_ringworld_output_boost = yes
				}
				modifier = {
					planet_farmers_food_produces_add = 1
				}
			}
		# /
		# Civics
			triggered_desc = {	# Catalytic
				trigger = {
					exists = owner
					owner = {
						is_catalytic_empire = yes
					}
					planet = {
						NOR = {
							has_active_building = building_coordinated_fulfillment_center_1
							has_active_building = building_coordinated_fulfillment_center_2
						}
					}
				}
				text = tec_building_boost_catalytic_with_tech
			}
			triggered_planet_modifier = {	# Regular
				potential = {
					exists = owner
					owner = {
						is_catalytic_empire = yes
						has_technology = tech_eco_simulation
					}
				}
				modifier = {
					planet_metallurgists_produces_mult = 0.05
				}
			}
			triggered_planet_modifier = {	# Regular
				potential = {
					exists = owner
					owner = {
						is_catalytic_empire = yes
						has_technology = tech_gene_crops
					}
					planet = {
						NOR = {
							has_active_building = building_coordinated_fulfillment_center_1
							has_active_building = building_coordinated_fulfillment_center_2
						}
					}
				}
				modifier = {
					planet_metallurgists_produces_mult = 0.05
				}
			}
			triggered_planet_modifier = {	# Regular
				potential = {
					exists = owner
					owner = {
						is_catalytic_empire = yes
						has_technology = tech_nano_vitality_crops
					}
					planet = {
						NOR = {
							has_active_building = building_coordinated_fulfillment_center_1
							has_active_building = building_coordinated_fulfillment_center_2
						}
					}
				}
				modifier = {
					planet_metallurgists_produces_mult = 0.05
				}
			}
		# /
	# /

	inline_script = {
		script = buildings/inline_evolved_production_extra_districts
		district = district_farming
		trigger = "
			is_robot_empire = yes
		"
		tier = 2
	}

	inline_script = {
		script = jobs/inline_evolved_farmer
		regular_count = 2
		regular_aquatic_count = 2
		hive_count = 2
		hive_aquatic_count = 2
		machine_count = 2
		display = with_desc
		trigger = ""
	}
}

building_food_processing_complex = {
	base_buildtime = @b3_time
	can_build = no
	position_priority = 210		# Basic boost

	category = resource

	prerequisites = {
		"tech_tec_food_processing_3"
	}

	show_tech_unlock_if = {
		tec_is_biohive = no
	}

	allow = {
		exists = owner
		has_upgraded_capital = yes
	}

	destroy_trigger = {
		exists = owner
		OR = {
			owner = {
				tec_is_biohive = yes
			}
			AND = {
				OR = {
					owner = {
						is_ai = yes
						country_uses_food = no
					}
					AND = {
						owner = {
							is_ai = yes
						}
						has_any_farming_district_or_buildings = no
					}
				}
			}
			uses_district_set = machine_world
			has_modifier = resort_colony
		}
	}

	convert_to = {
		building_tec_biohive_food_processing_complex
	}
	
	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 4
		}

		inline_script = {
			script = buildings/inline_evolved_rare_resource_cost
			tier = 3
			rare = volatile_motes
		}

		inline_script = {
			script = buildings/inline_evolved_machine_prod_extra_cost
			tier = 3
		}

		inline_script = {
			script = buildings/inline_evolved_ring_production_cost
			rare = volatile_motes
		}

		inline_script = {
			script = buildings/inline_evolved_exotic_resource_cost
			exotic = sr_living_metal
		}
	}

	# Modifiers
		# Standard
			planet_modifier = {
				planet_farmers_food_produces_add = 3
			}

			triggered_planet_modifier = {
				potential = {
					has_ringworld_output_boost = yes
				}
				modifier = {
					planet_farmers_food_produces_add = 2
				}
			}
		# /
		# Civics
			triggered_desc = {	# Catalytic
				trigger = {
					exists = owner
					owner = {
						is_catalytic_empire = yes
					}
					planet = {
						NOR = {
							has_active_building = building_coordinated_fulfillment_center_1
							has_active_building = building_coordinated_fulfillment_center_2
						}
					}
				}
				text = tec_building_boost_catalytic_with_tech_max
			}
			triggered_planet_modifier = {	# 1
				potential = {
					exists = owner
					owner = {
						is_catalytic_empire = yes
						has_technology = tech_eco_simulation
					}
					planet = {
						NOR = {
							has_active_building = building_coordinated_fulfillment_center_1
							has_active_building = building_coordinated_fulfillment_center_2
						}
					}
				}
				modifier = {
					planet_metallurgists_produces_mult = 0.05
				}
			}
			triggered_planet_modifier = {	# 2
				potential = {
					exists = owner
					owner = {
						is_catalytic_empire = yes
						has_technology = tech_gene_crops
					}
					planet = {
						NOR = {
							has_active_building = building_coordinated_fulfillment_center_1
							has_active_building = building_coordinated_fulfillment_center_2
						}
					}
				}
				modifier = {
					planet_metallurgists_produces_mult = 0.05
				}
			}
			triggered_planet_modifier = {	# 3
				potential = {
					exists = owner
					owner = {
						is_catalytic_empire = yes
						has_technology = tech_nano_vitality_crops
					}
					planet = {
						NOR = {
							has_active_building = building_coordinated_fulfillment_center_1
							has_active_building = building_coordinated_fulfillment_center_2
						}
					}
				}
				modifier = {
					planet_metallurgists_produces_mult = 0.05
				}
			}
			triggered_planet_modifier = {	# 4
				potential = {
					exists = owner
					owner = {
						is_catalytic_empire = yes
						has_technology = tech_nutrient_replication
					}
					planet = {
						NOR = {
							has_active_building = building_coordinated_fulfillment_center_1
							has_active_building = building_coordinated_fulfillment_center_2
						}
					}
				}
				modifier = {
					planet_metallurgists_produces_mult = 0.05
				}
			}
		# /
	# /

	inline_script = {
		script = buildings/inline_evolved_production_extra_districts
		district = district_farming
		trigger = "
			is_robot_empire = yes
		"
		tier = 3
	}


	inline_script = {
		script = jobs/inline_evolved_farmer
		regular_count = 4
		regular_aquatic_count = 4
		hive_count = 4
		hive_aquatic_count = 4
		machine_count = 4
		display = with_desc
		trigger = ""
	}
}

building_tec_biohive_food_processing_facility = {
	base_buildtime = @b1_time
	base_cap_amount = 1
	position_priority = 210		# Basic boost

	category = resource

	prerequisites = {
		"tech_food_processing_1"
	}

	show_tech_unlock_if = {
		tec_is_biohive = yes
	}

	upgrades = {
		building_tec_biohive_food_processing_center
	}

	potential = {
		exists = owner
		owner = {
			tec_is_biohive = yes
		}
		NOR = {
			uses_district_set = machine_world
			has_modifier = resort_colony
		}
	}

	destroy_trigger = {
		exists = owner
		OR = {
			owner = {
				tec_is_biohive = no
			}
			uses_district_set = machine_world
			has_modifier = resort_colony
			AND = {
				owner = {
					is_ai = yes
				}
				has_any_farming_district_or_buildings = no
			}
		}
	}

	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 1
		}
	}

	planet_modifier = {
		planet_farmers_food_produces_add = 1
	}

	inline_script = {
		script = buildings/inline_evolved_production_extra_districts
		district = district_farming
		trigger = "
			tec_is_biohive = yes
		"
		tier = 1
	}

	inline_script = {
		script = jobs/inline_evolved_farmer
		regular_count = 1
		regular_aquatic_count = 1
		hive_count = 1
		hive_aquatic_count = 1
		machine_count = 1
		display = with_desc
		trigger = ""
	}
}

building_tec_biohive_food_processing_center = {
	base_buildtime = @b2_time
	can_build = no
	position_priority = 210		# Basic boost
	
	category = resource

	prerequisites = {
		"tech_food_processing_2"
	}

	show_tech_unlock_if = {
		tec_is_biohive = yes
	}

	upgrades = {
		"building_tec_biohive_food_processing_complex"
	}
	
	allow = {
		exists = owner
		has_upgraded_capital = yes
	}

	destroy_trigger = {
		exists = owner
		OR = {
			owner = {
				tec_is_biohive = no
			}
			uses_district_set = machine_world
			has_modifier = resort_colony
			AND = {
				owner = {
					is_ai = yes
				}
				has_any_farming_district_or_buildings = no
			}
		}
	}
	
	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 2
		}

		inline_script = {
			script = buildings/inline_evolved_rare_resource_cost
			tier = 2
			rare = volatile_motes
		}

		inline_script = {
			script = buildings/inline_evolved_ring_production_cost
			rare = volatile_motes
		}
	}

	planet_modifier = {
		planet_farmers_food_produces_add = 2
	}

	triggered_planet_modifier = {
		potential = {
			has_ringworld_output_boost = yes
		}
		modifier = {
			planet_farmers_food_produces_add = 1
		}
	}
	inline_script = {
		script = buildings/inline_evolved_production_extra_districts
		district = district_farming
		trigger = "
			tec_is_biohive = yes
		"
		tier = 2
	}
	inline_script = {
		script = jobs/inline_evolved_farmer
		regular_count = 2
		regular_aquatic_count = 2
		hive_count = 2
		hive_aquatic_count = 2
		machine_count = 2
		display = with_desc
		trigger = ""
	}
}

building_tec_biohive_food_processing_complex = {
	base_buildtime = @b3_time
	can_build = no
	position_priority = 210		# Basic boost

	category = resource

	prerequisites = {
		"tech_tec_food_processing_3"
	}

	show_tech_unlock_if = {
		tec_is_biohive = yes
	}

	allow = {
		exists = owner
		has_upgraded_capital = yes
	}

	destroy_trigger = {
		exists = owner
		OR = {
			owner = {
				tec_is_biohive = no
			}
			uses_district_set = machine_world
			has_modifier = resort_colony
			AND = {
				owner = {
					is_ai = yes
				}
				has_any_farming_district_or_buildings = no
			}
		}
	}
	
	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 4
		}

		inline_script = {
			script = buildings/inline_evolved_rare_resource_cost
			tier = 3
			rare = volatile_motes
		}

		inline_script = {
			script = buildings/inline_evolved_ring_production_cost
			rare = volatile_motes
		}

		inline_script = {
			script = buildings/inline_evolved_exotic_resource_cost
			exotic = sr_living_metal
		}
	}

	planet_modifier = {
		planet_farmers_food_produces_add = 3
	}

	triggered_planet_modifier = {
		potential = {
			has_ringworld_output_boost = yes
		}
		modifier = {
			planet_farmers_food_produces_add = 2
		}
	}

	inline_script = {
		script = buildings/inline_evolved_production_extra_districts
		district = district_farming
		trigger = "
			tec_is_biohive = yes
		"
		tier = 3
	}

	inline_script = {
		script = jobs/inline_evolved_farmer
		regular_count = 4
		regular_aquatic_count = 4
		hive_count = 4
		hive_aquatic_count = 4
		machine_count = 4
		display = with_desc
		trigger = ""
	}
}


# Basic production
# ------------- ENERGY -----------------
building_tec_energrid_1 = {
	base_buildtime = @b2_time
	position_priority = 220		# Basic Production
	base_cap_amount = 5

	category = resource
	
	prerequisites = {
		"tech_tec_energy_plant"
	}

	show_tech_unlock_if = {
		tec_is_biohive = no
	}

	upgrades = {
		building_tec_energrid_2
	}

	potential = {
		NOT = { has_modifier = resort_colony }
		exists = owner
		OR = {
			owner = {
				tec_is_biohive = no
			}
			owner = {
				is_ai = no
			}
			# Nope, unless the planet is excesively good
			AND = {
				owner = {
					is_ai = yes
				}
				OR = {
					has_planet_flag = tec_energy_planet_3
					has_planet_flag = tec_energy_planet_4
				}
			#	has_planet_flag = tec_ai_energy_colony
			}
		}
	}

	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 1
		}
	}

	inline_script = {
		script = jobs/inline_evolved_technician
		regular_count = 2
		hive_count = 2
		machine_count = 2
		machine_aquatic_count = 2
		display = with_desc
		trigger = ""
	}
}

building_tec_energrid_2 = {
	base_buildtime = @b3_time
	can_build = no
	position_priority = 220		# Basic Production

	category = resource
	
	prerequisites = {
		"tech_tec_energy_plant_2"
	}

	show_tech_unlock_if = {
		tec_is_biohive = no
	}

	upgrades = {
		building_tec_energrid_3
	}

	potential = {
		NOT = { has_modifier = resort_colony }
	}

	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 2
		}

		# New production
		produces = {
			energy = 1
			multiplier = value:tec_automated_district_production|BASE|3|ECO_CAT|planet_technician|RESOURCE|energy|REQUISITON|has_energy_requisitorium|REQUISITION_AMOUNT|@requisitorium_energy_reduction|
		}
	}

	overlord_resources = {
		category = planet_requisitioned_energy
		produces = {
			trigger = {
				planet = {
					has_planet_flag = has_energy_requisitorium
				}
			}
			energy = @requisitorium_energy_overlord
		}
	}

	triggered_desc = {
		text = tec_building_affect_production_menialbuilding
	}
	inline_script = {
		script = jobs/inline_evolved_technician
		regular_count = 3
		hive_count = 3
		machine_count = 3
		machine_aquatic_count = 3
		display = with_desc
		trigger = ""
	}
}

building_tec_energrid_3 = {
	base_buildtime = @b4_time
	can_build = no
	position_priority = 220		# Basic Production

	category = resource
	
	prerequisites = {
		"tech_tec_energy_plant_3"
	}

	show_tech_unlock_if = {
		tec_is_biohive = no
	}

	potential = {
		NOT = { has_modifier = resort_colony }
	}

	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 3
		}

		inline_script = {
			script = buildings/inline_evolved_exotic_resource_cost
			exotic = nanites
		}
		
		produces = {
			energy = 1
			multiplier = value:tec_automated_district_production|BASE|6|ECO_CAT|planet_technician|RESOURCE|energy|REQUISITON|has_energy_requisitorium|REQUISITION_AMOUNT|@requisitorium_energy_reduction|
		}
	}

	overlord_resources = {
		category = planet_requisitioned_energy
		produces = {
			trigger = {
				planet = {
					has_planet_flag = has_energy_requisitorium
				}
			}
			energy = @requisitorium_energy_overlord
		}
	}

	triggered_desc = {
		text = tec_building_affect_production_menialbuilding
	}

	inline_script = {
		script = jobs/inline_evolved_technician
		regular_count = 4
		hive_count = 4
		machine_count = 4
		machine_aquatic_count = 4
		display = with_desc
		trigger = ""
	}
}

# ------------- MINERALS -----------------
building_tec_stripmine_1 = {
	base_buildtime = @b2_time
	position_priority = 220		# Basic Production
	base_cap_amount = 5

	category = resource
	
	desc = {
		text = building_tec_stripmine_1_desc
		trigger = {
			NOR = {
				uses_habitat_capitals = yes
				habitable_structure = yes
				tec_is_arcology = yes
			}
		}
	}
	desc = {
		text = building_tec_stripmine_1_hab_desc
		trigger = {
			OR = {
				uses_habitat_capitals = yes
				habitable_structure = yes
				tec_is_arcology = yes
			}
		}
	}

	prerequisites = {
		"tech_tec_mining_array"
	}

	show_tech_unlock_if = {
		tec_is_biohive = no
	}

	upgrades = {
		building_tec_stripmine_2
	}

	potential = {
		NOT = { has_modifier = resort_colony }
		OR = {
			AND = {
				habitable_structure = no
				tec_is_arcology = no
			}
			uses_habitat_capitals = yes
		}
		exists = owner
		owner = {
			tec_is_biohive = no
		}
		OR = {
			owner = {
				is_ai = no
			}
			# Nope, unless the planet is excesively good
			AND = {
				owner = {
					is_ai = yes
				}
				or = {
					has_planet_flag = tec_mineral_planet_3
					has_planet_flag = tec_mineral_planet_4
				}
			#	#	has_planet_flag = tec_ai_mineral_colony
			}
		}
	}

	destroy_trigger = {
		exists = owner
		OR = {
			planet = { # If the planet is marked as designated ecu, this goes brr
				OR = {
					has_planet_flag = tec_designated_as_ai_ecu
					uses_district_set = city_world
				}
			}
			owner = {
				tec_is_biohive = yes
			}
		}
	}

	convert_to = {
		building_tec_biohive_mining_1
	}

	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 1
		}
	}

	inline_script = {
		script = jobs/inline_evolved_miner
		regular_count = 2
		regular_aquatic_count = 2
		hive_count = 2
		hive_aquatic_count = 2
		machine_count = 2
		display = with_desc
		trigger = ""
	}
}

building_tec_stripmine_2 = {
	base_buildtime = @b3_time
	can_build = no
	position_priority = 220		# Basic Production

	category = resource
	
	desc = {
		text = building_tec_stripmine_2_desc
		trigger = {
			NOR = {
				uses_habitat_capitals = yes
				habitable_structure = yes
				tec_is_arcology = yes
			}
		}
	}
	desc = {
		text = building_tec_stripmine_2_hab_desc
		trigger = {
			OR = {
				uses_habitat_capitals = yes
				habitable_structure = yes
				tec_is_arcology = yes
			}
		}
	}

	prerequisites = {
		"tech_tec_mining_array_2"
	}

	show_tech_unlock_if = {
		tec_is_biohive = no
	}

	upgrades = {
		building_tec_stripmine_3
	}

	potential = {
		NOT = { has_modifier = resort_colony }
		exists = owner
		owner = {
			tec_is_biohive = no
		}
		OR = {
			AND = {
				habitable_structure = no
				tec_is_arcology = no
			}
			uses_habitat_capitals = yes
		}
	}

	destroy_trigger = {
		exists = owner
		OR = {
			owner = {
				tec_is_biohive = yes
			}
			planet = { # If the planet is marked as designated ecu, this goes brr
				OR = {
					has_planet_flag = tec_designated_as_ai_ecu
					uses_district_set = city_world
				}
			}
			owner = {
				tec_is_biohive = yes
			}
		}
	}

	convert_to = {
		building_tec_biohive_mining_2
	}

	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 2
		}

		produces = {
			energy = 1
			multiplier = value:tec_automated_district_production|BASE|2|ECO_CAT|planet_miners|RESOURCE|minerals|REQUISITON|has_material_requisitorium|REQUISITION_AMOUNT|@requisitorium_minerals_reduction|
		}
	}

	overlord_resources = {
		category = planet_requisitioned_minerals
		produces = {
			trigger = {
				planet = {
					has_planet_flag = has_material_requisitorium
				}
			}
			minerals = @requisitorium_minerals_overlord
		}
	}
	

	triggered_desc = {
		text = tec_building_affect_production_menialbuilding
	}

	inline_script = {
		script = jobs/inline_evolved_miner
		regular_count = 3
		regular_aquatic_count = 3
		hive_count = 3
		hive_aquatic_count = 3
		machine_count = 3
		display = with_desc
		trigger = ""
	}
}

building_tec_stripmine_3 = {
	base_buildtime = @b4_time
	can_build = no
	position_priority = 220		# Basic Production

	category = resource
	
	desc = {
		text = building_tec_stripmine_3_desc
		trigger = {
			NOR = {
				uses_habitat_capitals = yes
				habitable_structure = yes
				tec_is_arcology = yes
			}
		}
	}
	desc = {
		text = building_tec_stripmine_3_hab_desc
		trigger = {
			OR = {
				uses_habitat_capitals = yes
				habitable_structure = yes
				tec_is_arcology = yes
			}
		}
	}
		
	prerequisites = {
		"tech_tec_mining_array_3"
	}

	show_tech_unlock_if = {
		tec_is_biohive = no
	}

	potential = {
		NOT = { has_modifier = resort_colony }
		exists = owner
		owner = {
			tec_is_biohive = no
		}
		OR = {
			AND = {
				habitable_structure = no
				tec_is_arcology = no
			}
			uses_habitat_capitals = yes
		}
	}

	destroy_trigger = {
		exists = owner
		OR = {
			owner = {
				tec_is_biohive = yes
			}
			planet = { # If the planet is marked as designated ecu, this goes brr
				OR = {
					has_planet_flag = tec_designated_as_ai_ecu
					uses_district_set = city_world
				}
			}
			owner = {
				tec_is_biohive = yes
			}
		}
	}

	convert_to = {
		building_tec_biohive_mining_3
	}

	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 3
		}

		inline_script = {
			script = buildings/inline_evolved_exotic_resource_cost
			exotic = nanites
		}
		
		produces = {
			energy = 1
			multiplier = value:tec_automated_district_production|BASE|4|ECO_CAT|planet_miners|RESOURCE|minerals|REQUISITON|has_material_requisitorium|REQUISITION_AMOUNT|@requisitorium_minerals_reduction|
		}
	}

	overlord_resources = {
		category = planet_requisitioned_minerals
		produces = {
			trigger = {
				planet = {
					has_planet_flag = has_material_requisitorium
				}
			}
			minerals = @requisitorium_minerals_overlord
		}
	}

	triggered_desc = {
		text = tec_building_affect_production_menialbuilding
	}

	inline_script = {
		script = jobs/inline_evolved_miner
		regular_count = 4
		regular_aquatic_count = 4
		hive_count = 4
		hive_aquatic_count = 4
		machine_count = 4
		display = with_desc
		trigger = ""
	}
}

building_tec_biohive_mining_1 = {
	base_buildtime = @b2_time
	position_priority = 220		# Basic Production
	base_cap_amount = 5

	category = resource
	
	desc = {
		text = building_tec_biohive_mining_1_desc
		trigger = {
			NOR = {
				uses_habitat_capitals = yes
				habitable_structure = yes
				tec_is_arcology = yes
			}
		}
	}
	desc = {
		text = building_tec_biohive_mining_1_hab_desc
		trigger = {
			OR = {
				uses_habitat_capitals = yes
				habitable_structure = yes
				tec_is_arcology = yes
			}
		}
	}

	prerequisites = {
		"tech_tec_mining_array"
	}

	show_tech_unlock_if = {
		tec_is_biohive = yes
	}

	upgrades = {
		building_tec_biohive_mining_2
	}

	potential = {
		NOT = { has_modifier = resort_colony }
		OR = {
			AND = {
				habitable_structure = no
				tec_is_arcology = no
			}
			uses_habitat_capitals = yes
		}
		exists = owner
		owner = {
			tec_is_biohive = yes
		}
	}

	destroy_trigger = {
		OR = {
			planet = { # If the planet is marked as designated ecu, this goes brr
				OR = {
					has_planet_flag = tec_designated_as_ai_ecu
					uses_district_set = city_world
				}
			}
			AND = {
				exists = owner
				owner = {
					tec_is_biohive = no
				}
			}
		}
	}

	convert_to = {
		building_tec_stripmine_1
	}

	resources = {
		category = planet_buildings
		cost = {
			food = @b1_half_minerals
			minerals = @b1_half_minerals
		}
		upkeep = {
			energy = @b1_upkeep
		}
		# Special resource civics
		cost = {
			trigger = {
				owner = { tec_is_bioarch_empire = yes }
			}
			minerals = @b1_minus_minerals
			food = @b1_half_minerals
		}

		#Energy
			produces = {
				energy = 5
			}

			produces = {
				trigger = {
					owner = {
						has_technology = tech_power_plant_2
					}
				}
				energy = 1
			}
			produces = {
				trigger = {
					owner = {
						has_technology = tech_power_plant_3
					}
				}
				energy = 1
			}
			produces = {
				trigger = {
					owner = {
						has_technology = tech_power_plant_4
					}
				}
				energy = 1
			}
		# /
		
		# Minerals
			produces = {
				minerals = 5
			}

			produces = {
				trigger = {
					owner = {
						has_technology = tech_mining_1
					}
				}
				minerals = 1
			}
			produces = {
				trigger = {
					owner = {
						has_technology = tech_mining_2
					}
				}
				minerals = 1
			}
			produces = {
				trigger = {
					owner = {
						has_technology = tech_mining_3
					}
				}
				minerals = 1
			}
		# /
	}

	triggered_planet_modifier = {	# Gestalt
		potential = {
			exists = owner
			owner = {
				is_gestalt = yes 
			}
			planet = {
				tec_has_mining_designation = no
				tec_has_energy_designation = no
			}
		}
		modifier = {
			job_mining_drone_add = 1
			job_technician_drone_add = 1
		}
	}
	triggered_planet_modifier = {	# Gestalt
		potential = {
			exists = owner
			owner = {
				is_gestalt = yes 
			}
			planet = {
				tec_has_mining_designation = yes
			}
		}
		modifier = {
			job_mining_drone_add = 2
		}
	}
	triggered_planet_modifier = {	# Gestalt
		potential = {
			exists = owner
			owner = {
				is_gestalt = yes 
			}
			planet = {
				tec_has_energy_designation = yes
			}
		}
		modifier = {
			job_technician_drone_add = 2
		}
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_gestalt = yes 
			}
			planet = {
				OR = {
					AND = {
						tec_has_mining_designation = no
						tec_has_energy_designation = no
					}
					tec_has_mining_designation = yes
				}
			}
		}
		text = job_mining_drone_effect_desc
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_gestalt = yes 
			}
			planet = {
				OR = {
					AND = {
						tec_has_mining_designation = no
						tec_has_energy_designation = no
					}
					tec_has_energy_designation = yes
				}
			}
		}
		text = job_technician_drone_effect_desc
	}
}

building_tec_biohive_mining_2 = {
	base_buildtime = @b3_time
	can_build = no
	position_priority = 220		# Basic Production

	category = resource
	
	desc = {
		text = building_tec_biohive_mining_2_desc
		trigger = {
			NOR = {
				uses_habitat_capitals = yes
				habitable_structure = yes
				tec_is_arcology = yes
			}
		}
	}
	desc = {
		text = building_tec_biohive_mining_2_hab_desc
		trigger = {
			OR = {
				uses_habitat_capitals = yes
				habitable_structure = yes
				tec_is_arcology = yes
			}
		}
	}

	prerequisites = {
		"tech_tec_mining_array_2"
	}

	show_tech_unlock_if = {
		tec_is_biohive = yes
	}

	upgrades = {
		building_tec_biohive_mining_3
	}

	potential = {
		NOT = { has_modifier = resort_colony }
		OR = {
			AND = {
				habitable_structure = no
				tec_is_arcology = no
			}
			uses_habitat_capitals = yes
		}
		exists = owner
		owner = {
			tec_is_biohive = yes
		}
	}

	destroy_trigger = {
		OR = {
			planet = { # If the planet is marked as designated ecu, this goes brr
				OR = {
					has_planet_flag = tec_designated_as_ai_ecu
					uses_district_set = city_world
				}
			}
			AND = {
				exists = owner
				owner = {
					tec_is_biohive = no
				}
			}
		}
	}

	convert_to = {
		building_tec_stripmine_2
	}

	resources = {
		category = planet_buildings
		cost = {
			food = @b2_half_minerals
			minerals = @b2_half_minerals
		}
		upkeep = {
			energy = @b2_upkeep
		}
		# Special resource civics
		cost = {
			trigger = {
				owner = { tec_is_bioarch_empire = yes }
			}
			minerals = @b2_minus_minerals
			food = @b2_half_minerals
		}

		#Energy
			produces = {
				energy = 10
			}

			produces = {
				trigger = {
					owner = {
						has_technology = tech_power_plant_2
					}
				}
				energy = 2
			}
			produces = {
				trigger = {
					owner = {
						has_technology = tech_power_plant_3
					}
				}
				energy = 2
			}
			produces = {
				trigger = {
					owner = {
						has_technology = tech_power_plant_4
					}
				}
				energy = 2
			}
		# /
		
		# Minerals
			produces = {
				minerals = 10
			}

			produces = {
				trigger = {
					owner = {
						has_technology = tech_mining_1
					}
				}
				minerals = 2
			}
			produces = {
				trigger = {
					owner = {
						has_technology = tech_mining_2
					}
				}
				minerals = 2
			}
			produces = {
				trigger = {
					owner = {
						has_technology = tech_mining_3
					}
				}
				minerals = 2
			}
		# /
	}

	triggered_desc = {
		text = tec_building_affect_production_menialbuilding
	}

	triggered_planet_modifier = {	# Gestalt
		potential = {
			exists = owner
			owner = {
				is_gestalt = yes 
			}
			planet = {
				tec_has_mining_designation = no
				tec_has_energy_designation = no
			}
		}
		modifier = {
			job_mining_drone_add = 2
			job_technician_drone_add = 2
		}
	}
	triggered_planet_modifier = {	# Gestalt
		potential = {
			exists = owner
			owner = {
				is_gestalt = yes 
			}
			planet = {
				tec_has_mining_designation = yes
			}
		}
		modifier = {
			job_mining_drone_add = 4
		}
	}
	triggered_planet_modifier = {	# Gestalt
		potential = {
			exists = owner
			owner = {
				is_gestalt = yes 
			}
			planet = {
				tec_has_energy_designation = yes
			}
		}
		modifier = {
			job_technician_drone_add = 4
		}
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_gestalt = yes 
			}
			planet = {
				OR = {
					AND = {
						tec_has_mining_designation = no
						tec_has_energy_designation = no
					}
					tec_has_mining_designation = yes
				}
			}
		}
		text = job_mining_drone_effect_desc
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_gestalt = yes 
			}
			planet = {
				OR = {
					AND = {
						tec_has_mining_designation = no
						tec_has_energy_designation = no
					}
					tec_has_energy_designation = yes
				}
			}
		}
		text = job_technician_drone_effect_desc
	}
}

building_tec_biohive_mining_3 = {
	base_buildtime = @b4_time
	can_build = no
	position_priority = 220		# Basic Production

	category = resource
	
	desc = {
		text = building_tec_biohive_mining_3_desc
		trigger = {
			NOR = {
				uses_habitat_capitals = yes
				habitable_structure = yes
				tec_is_arcology = yes
			}
		}
	}
	desc = {
		text = building_tec_biohive_mining_3_hab_desc
		trigger = {
			OR = {
				uses_habitat_capitals = yes
				habitable_structure = yes
				tec_is_arcology = yes
			}
		}
	}
		
	prerequisites = {
		"tech_tec_mining_array_3"
	}

	show_tech_unlock_if = {
		tec_is_biohive = yes
	}

	potential = {
		NOT = { has_modifier = resort_colony }
		OR = {
			AND = {
				habitable_structure = no
				tec_is_arcology = no
			}
			uses_habitat_capitals = yes
		}
		exists = owner
		owner = {
			tec_is_biohive = yes
		}
	}

	destroy_trigger = {
		OR = {
			planet = { # If the planet is marked as designated ecu, this goes brr
				OR = {
					has_planet_flag = tec_designated_as_ai_ecu
					uses_district_set = city_world
				}
			}
			AND = {
				exists = owner
				owner = {
					tec_is_biohive = no
				}
			}
		}
	}

	convert_to = {
		building_tec_stripmine_3
	}

	resources = {
		category = planet_buildings
		cost = {
			food = @b3_half_minerals
			minerals = @b3_half_minerals
			#rare_crystals = @b2_rare_cost
			nanites = 25
		}
		upkeep = {
			energy = @b3_upkeep
			#rare_crystals = @b2_rare_upkeep
			nanites = 1
		}
		# Special resource civics
		cost = {
			trigger = {
				owner = { tec_is_bioarch_empire = yes }
			}
			minerals = @b3_minus_minerals
			food = @b3_half_minerals
		}

		#Energy
			produces = {
				energy = 15
			}

			produces = {
				trigger = {
					owner = {
						has_technology = tech_power_plant_2
					}
				}
				energy = 5
			}
			produces = {
				trigger = {
					owner = {
						has_technology = tech_power_plant_3
					}
				}
				energy = 5
			}
			produces = {
				trigger = {
					owner = {
						has_technology = tech_power_plant_4
					}
				}
				energy = 5
			}
		# /
		
		# Minerals
			produces = {
				minerals = 15
			}

			produces = {
				trigger = {
					owner = {
						has_technology = tech_mining_1
					}
				}
				minerals = 5
			}
			produces = {
				trigger = {
					owner = {
						has_technology = tech_mining_2
					}
				}
				minerals = 5
			}
			produces = {
				trigger = {
					owner = {
						has_technology = tech_mining_3
					}
				}
				minerals = 5
			}
		# /
	}

	triggered_desc = {
		text = tec_building_affect_production_menialbuilding
	}

	triggered_planet_modifier = {	# Gestalt
		potential = {
			exists = owner
			owner = {
				is_gestalt = yes 
			}
			planet = {
				tec_has_mining_designation = no
				tec_has_energy_designation = no
			}
		}
		modifier = {
			job_mining_drone_add = 3
			job_technician_drone_add = 3
		}
	}
	triggered_planet_modifier = {	# Gestalt
		potential = {
			exists = owner
			owner = {
				is_gestalt = yes 
			}
			planet = {
				tec_has_mining_designation = yes
			}
		}
		modifier = {
			job_mining_drone_add = 6
		}
	}
	triggered_planet_modifier = {	# Gestalt
		potential = {
			exists = owner
			owner = {
				is_gestalt = yes 
			}
			planet = {
				tec_has_energy_designation = yes
			}
		}
		modifier = {
			job_technician_drone_add = 6
		}
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_gestalt = yes 
			}
			planet = {
				OR = {
					AND = {
						tec_has_mining_designation = no
						tec_has_energy_designation = no
					}
					tec_has_mining_designation = yes
				}
			}
		}
		text = job_mining_drone_effect_desc
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_gestalt = yes 
			}
			planet = {
				OR = {
					AND = {
						tec_has_mining_designation = no
						tec_has_energy_designation = no
					}
					tec_has_energy_designation = yes
				}
			}
		}
		text = job_technician_drone_effect_desc
	}

}

# ------------- FOOD -----------------
building_hydroponics_farm = {
	base_buildtime = @b1_time
	position_priority = 220		# Basic Production
	base_cap_amount = 5

	category = resource
	
	prerequisites = {
		"tech_hydroponics"
	}

	show_tech_unlock_if = {
		tec_is_biohive = no
	}

	upgrades = {
		building_hydroponics_farm_2
	}

	potential = {
		exists = owner
		owner = {
			tec_is_biohive = no
		}
		planet = {
			or = {
				owner = {
					country_uses_food = yes
				}
				owner = { is_ai = no }
			}
		}
		NOT = { uses_district_set = machine_world }
		NOT = { has_modifier = resort_colony }
		OR = {
			owner = {
				is_ai = no
			}
			# Lets make the ai able to make this if its disesperated
			AND = {
				owner = {
					is_ai = yes
					has_monthly_income = {
						resource = food
						value < 0
					}
				}
				planet = {
					or = {
						has_planet_flag = tec_food_habitat
						has_planet_flag = tec_food_planet_2
						has_planet_flag = tec_food_planet_3
						has_planet_flag = tec_food_planet_4
					}
				}
			}
			# Nope, unless the planet is excesively good
			AND = {
				owner = {
					is_ai = yes
				}
				planet = {
					or = {
						has_planet_flag = tec_food_planet_3
						has_planet_flag = tec_food_planet_4
					}
				}
			}
		}
	}
	
	#allow = {
	#}
	
	destroy_trigger = {
		exists = owner
		OR = {
			owner = {
				is_ai = yes
				country_uses_food = no
			}
			planet = {
				NOT = { is_planet_class = pc_habitat }
				free_building_slots = 0
				owner = {
					is_ai = yes
					has_monthly_income = {
						resource = food
						value > 100
					}
				}
			}
		}
	}

	convert_to = {
		building_tec_biomass_farm_1
	}

	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 1
		}
	}

	inline_script = {
		script = jobs/inline_evolved_farmer
		regular_count = 2
		regular_aquatic_count = 2
		hive_count = 2
		hive_aquatic_count = 2
		machine_count = 2
		display = with_desc
		trigger = ""
	}

}

building_hydroponics_farm_2 = {
	base_buildtime = @b3_time
	can_build = no
	position_priority = 220		# Basic Production

	category = resource

	prerequisites = {
		"tech_tec_hydroponics_2"
	}

	show_tech_unlock_if = {
		tec_is_biohive = no
	}
	
	upgrades = {
		building_hydroponics_farm_3
	}

	potential = {
		exists = owner
		owner = {
			tec_is_biohive = no
		}
		planet = {
			or = {
				owner = {
					country_uses_food = yes
				}
				owner = { is_ai = no }
			}
		}
		NOT = { is_planet_class = pc_machine }
		NOT = { has_modifier = resort_colony }
	}
	
	#allow = {
	#}
	
	destroy_trigger = {
		exists = owner
		OR = {
			planet = {
				NOT = { is_planet_class = pc_habitat }
				free_building_slots = 0
				owner = {
					is_ai = yes
					has_monthly_income = {
						resource = food
						value > 100
					}
				}
			}
		}
	}

	convert_to = {
		building_tec_biomass_farm_2
	}


	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 2
		}
		
		produces = {
			energy = 1
			multiplier = value:tec_automated_district_production|BASE|3|ECO_CAT|planet_farmers|RESOURCE|food|REQUISITON|has_produce_requisitorium|REQUISITION_AMOUNT|@requisitorium_food_reduction|
		}
	}

	overlord_resources = {
		category = planet_requisitioned_food
		produces = {
			trigger = {
				planet = {
					has_planet_flag = has_produce_requisitorium
				}
			}
			food = @requisitorium_food_overlord
		}
	}


	triggered_desc = {
		text = tec_building_affect_production_menialbuilding
	}
	
	inline_script = {
		script = jobs/inline_evolved_miner
		regular_count = 3
		regular_aquatic_count = 3
		hive_count = 3
		hive_aquatic_count = 3
		machine_count = 3
		display = with_desc
		trigger = ""
	}
}

building_hydroponics_farm_3 = {
	base_buildtime = @b4_time
	can_build = no
	position_priority = 220		# Basic Production

	category = resource

	prerequisites = {
		"tech_tec_hydroponics_3"
	}

	show_tech_unlock_if = {
		tec_is_biohive = no
	}
	
	potential = {
		exists = owner
		owner = {
			tec_is_biohive = no
		}
		planet = {
			or = {
				owner = {
					country_uses_food = yes
				}
				owner = { is_ai = no }
			}
		}
		NOT = { is_planet_class = pc_machine }
		NOT = { has_modifier = resort_colony }
	}
	
	#allow = {
	#}
	
	destroy_trigger = {
		exists = owner
		OR = {
			planet = {
				NOT = { is_planet_class = pc_habitat }
				free_building_slots = 0
				owner = {
					is_ai = yes
					has_monthly_income = {
						resource = food
						value > 300
					}
				}
			}
		}
	}

	convert_to = {
		building_tec_biomass_farm_3
	}

	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 3
		}

		inline_script = {
			script = buildings/inline_evolved_exotic_resource_cost
			exotic = nanites
		}
		
		produces = {
			energy = 1
			multiplier = value:tec_automated_district_production|BASE|6|ECO_CAT|planet_farmers|RESOURCE|food|REQUISITON|has_produce_requisitorium|REQUISITION_AMOUNT|@requisitorium_food_reduction|
		}
	}

	overlord_resources = {
		category = planet_requisitioned_food
		produces = {
			trigger = {
				planet = {
					has_planet_flag = has_produce_requisitorium
				}
			}
			food = @requisitorium_food_overlord
		}
	}

	triggered_desc = {
		text = tec_building_affect_production_menialbuilding
	}
	inline_script = {
		script = jobs/inline_evolved_miner
		regular_count = 4
		regular_aquatic_count = 4
		hive_count = 4
		hive_aquatic_count = 4
		machine_count = 4
		display = with_desc
		trigger = ""
	}
}

building_tec_biomass_farm_1 = {
	base_buildtime = @b1_time
	position_priority = 220		# Basic Production
	base_cap_amount = 5

	category = resource
	
	prerequisites = {
		"tech_hydroponics"
	}

	show_tech_unlock_if = {
		tec_is_biohive = yes
	}

	upgrades = {
		building_hydroponics_farm_2
	}

	potential = {
		exists = owner
		owner = {
			tec_is_biohive = yes
		}
		NOT = { uses_district_set = machine_world }
	}
	
	#allow = {
	#}
	
	destroy_trigger = {
		exists = owner
		owner = {
			tec_is_biohive = no
		}
	}

	convert_to = {
		building_tec_biomass_farm_1
	}

	resources = {
		category = planet_buildings
		cost = {
			food = @b1_half_minerals
			minerals = @b1_half_minerals
		}
		upkeep = {
			energy = @b1_upkeep 
		}
		# Special resource civics
		cost = {
			trigger = {
				owner = { tec_is_bioarch_empire = yes }
			}
			minerals = @b1_minus_minerals
			food = @b1_half_minerals
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_gestalt = yes 
			}
		}
		modifier = {
			job_tec_biomass_drone_add = @b1_jobs
		}
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_gestalt = yes 
			}
		}
		text = job_tec_biomass_drone_effect_desc
	}
}

building_tec_biomass_farm_2 = {
	base_buildtime = @b3_time
	can_build = no
	position_priority = 220		# Basic Production

	category = resource

	prerequisites = {
		"tech_tec_hydroponics_2"
	}

	show_tech_unlock_if = {
		tec_is_biohive = yes
	}
	
	upgrades = {
		building_hydroponics_farm_3
	}

	potential = {
		exists = owner
		owner = {
			tec_is_biohive = yes
		}
		NOT = { is_planet_class = pc_machine }
	}
	
	#allow = {
	#}
	
	destroy_trigger = {
		exists = owner
		owner = {
			tec_is_biohive = no
		}
	}

	convert_to = {
		building_tec_biomass_farm_2
	}


	resources = {
		category = planet_buildings
		cost = {
			food = @b2_half_minerals
			minerals = @b2_half_minerals
		}
		upkeep = {
			energy = @b2_upkeep 
		}
		# Special resource civics
		cost = {
			trigger = {
				owner = { tec_is_bioarch_empire = yes }
			}
			minerals = @b2_minus_minerals
			food = @b2_half_minerals
		}

		# New production
		produces = {
			food = 5
		}

		produces = {
			trigger = {
				planet = {
					has_active_building = building_food_processing_facility
				}
			}
			food = 1
		}
		produces = {
			trigger = {
				planet = {
					has_active_building = building_food_processing_center
				}
			}
			food = 2
		}
		produces = {
			trigger = {
				planet = {
					has_active_building = building_food_processing_complex
				}
			}
			food = 3
		}

		produces = {
			trigger = {
				owner = {
					has_technology = tech_eco_simulation
				}
			}
			food = 1
		}
		produces = {
			trigger = {
				owner = {
					has_technology = tech_gene_crops
				}
			}
			food = 1
		}
		produces = {
			trigger = {
				owner = {
					has_technology = tech_nano_vitality_crops
				}
			}
			food = 1
		}
		produces = {
			trigger = {
				owner = {
					has_technology = tech_nutrient_replication
				}
			}
			food = 1
		}
	}

	triggered_desc = {
		text = tec_building_affect_production_menialbuilding
	}
	
	triggered_planet_modifier = {	# Gestalt
		potential = {
			exists = owner
			owner = {
				is_gestalt = yes 
			}
		}
		modifier = {
			job_tec_biomass_drone_add = 3
		}
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_gestalt = yes 
			}
		}
		text = job_tec_biomass_drone_effect_desc
	}
}

building_tec_biomass_farm_3 = {
	base_buildtime = @b4_time
	can_build = no
	position_priority = 220		# Basic Production

	category = resource

	prerequisites = {
		"tech_tec_hydroponics_3"
	}

	show_tech_unlock_if = {
		tec_is_biohive = yes
	}
	
	potential = {
		exists = owner
		owner = {
			tec_is_biohive = yes
		}
		NOT = { is_planet_class = pc_machine }
	}
	
	#allow = {
	#}
	
	destroy_trigger = {
		exists = owner
		owner = {
			tec_is_biohive = no
		}
	}

	convert_to = {
		building_tec_biomass_farm_3
	}

	resources = {
		category = planet_buildings
		cost = {
			food = @b3_half_minerals
			minerals = @b3_half_minerals
			#volatile_motes = @b2_rare_cost
			nanites = 25
		}
		upkeep = {
			energy = @b3_upkeep
			#volatile_motes = @b2_rare_upkeep
			nanites = 1
		}
		# Special resource civics
		cost = {
			trigger = {
				owner = { tec_is_bioarch_empire = yes }
			}
			minerals = @b3_minus_minerals
			food = @b3_half_minerals
		}

		# New production
		produces = {
			food = 20
		}

		produces = {
			trigger = {
				planet = {
					has_active_building = building_food_processing_facility
				}
			}
			food = 1
		}
		produces = {
			trigger = {
				planet = {
					has_active_building = building_food_processing_center
				}
			}
			food = 2
		}
		produces = {
			trigger = {
				planet = {
					has_active_building = building_food_processing_complex
				}
			}
			food = 3
		}

		produces = {
			trigger = {
				owner = {
					has_technology = tech_eco_simulation
				}
			}
			food = 2
		}
		produces = {
			trigger = {
				owner = {
					has_technology = tech_gene_crops
				}
			}
			food = 2
		}
		produces = {
			trigger = {
				owner = {
					has_technology = tech_nano_vitality_crops
				}
			}
			food = 2
		}
		produces = {
			trigger = {
				owner = {
					has_technology = tech_nutrient_replication
				}
			}
			food = 1
		}
	}

	triggered_desc = {
		text = tec_building_affect_production_menialbuilding
	}
	
	triggered_planet_modifier = {	# Gestalt
		potential = {
			exists = owner
			owner = {
				is_gestalt = yes 
			}
		}
		modifier = {
			job_tec_biomass_drone_add = 4
		}
	}
	triggered_desc = {	# Gestalt
		trigger = {
			exists = owner
			owner = {
				is_gestalt = yes 
			}
		}
		text = job_tec_biomass_drone_effect_desc
	}
}

# MISC
# ------------- STORAGE -----------------
building_resource_silo = {
	base_buildtime = @b1_time
	position_priority = 400		# Other/Misc

	category = resource

	prerequisites = {
		"tech_basic_industry"
	}

	potential = {
		NOR = {
			has_modifier = resort_colony
			has_modifier = slave_colony
			has_modifier = crucible_colony
		}
	}

	allow = {
		exists = owner
		OR = {
			owner = { is_ai = no }
			AND = {
				NOR = {
					has_active_building = building_resource_silo
					has_active_building = building_tec_resource_silo_2
					has_active_building = building_tec_resource_silo_3
				}
				OR = {
					owner = {
						is_machine_empire = yes
						has_active_tradition = tr_domination_modular_depot
					}
					is_active_resolution = "resolution_greatergood_balance_in_the_middle"
					is_active_resolution = "resolution_greatergood_universal_prosperity_mandate"
					owner = {
						has_ascension_perk = ap_arcology_project
						NOT = { has_technology = tech_mega_engineering }
					}
				}
			}
		}
	}

	upgrades = {
		building_tec_resource_silo_2
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			energy = 1
		}
		# Special resource civics
		cost = {
			trigger = {
				owner = { tec_is_bioarch_empire = yes }
			}
			minerals = @b1_minus_minerals
			food = @b1_half_minerals
		}
		cost = {
			trigger = {
				owner = { has_valid_civic = civic_tec_machine_digitalization }
			}
			minerals = @b1_minus_minerals
			energy = @b1_half_minerals
		}
	}

	country_modifier = {
		country_resource_max_add = 5000
	}

	triggered_country_modifier = {
		potential = {
			exists = owner
			owner = {
				has_technology = tech_construction_templates
			}
		}
		country_resource_max_add = 5000
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		modifier = {
			job_clerk_add = 1
		}
	}
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		modifier = {
			job_maintenance_drone_add = 1
		}
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		text = job_maintenance_drone_effect_desc
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_gestalt = no }
		}
		text = job_clerk_effect_desc
	}
}

building_tec_resource_silo_2 = {
	base_buildtime = @b2_time
	can_build = no
	position_priority = 400		# Other/Misc

	category = resource

	prerequisites = {
		"tech_housing_1"
	}

	potential = {
		NOR = {
			has_modifier = resort_colony
			has_modifier = slave_colony
		}
	}

	allow = {
		exists = owner
		OR = {
			owner = { is_ai = no }
			AND = {
				NOR = {
					has_active_building = building_resource_silo
					has_active_building = building_tec_resource_silo_2
					has_active_building = building_tec_resource_silo_3
				}
				OR = {
					owner = {
						is_machine_empire = yes
						has_active_tradition = tr_domination_modular_depot
					}
					is_active_resolution = "resolution_greatergood_balance_in_the_middle"
					is_active_resolution = "resolution_greatergood_universal_prosperity_mandate"
					owner = {
						has_ascension_perk = ap_arcology_project
						NOT = { has_technology = tech_mega_engineering }
					}
				}
			}
		}
	}

	upgrades = {
		building_tec_resource_silo_3
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b2_minerals
		}
		upkeep = {
			energy = @b1_upkeep
		}
		# Special resource civics
		cost = {
			trigger = {
				owner = { tec_is_bioarch_empire = yes }
			}
			minerals = @b2_minus_minerals
			food = @b2_half_minerals
		}
		upkeep = {
			trigger = {
				owner = { tec_is_bioarch_empire = yes }
			}
			energy = @b1_minus_upkeep
			food = @b1_half_upkeep
		}
		cost = {
			trigger = {
				owner = { has_valid_civic = civic_tec_machine_digitalization }
			}
			minerals = @b2_minus_minerals
			energy = @b2_half_minerals
		}
	}

	country_modifier = {
		country_resource_max_add = 10000
	}

	triggered_country_modifier = {
		potential = {
			exists = owner
			owner = {
				has_technology = tech_construction_templates
			}
		}
		country_resource_max_add = 5000
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		modifier = {
			job_clerk_add = 2
		}
	}
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		modifier = {
			job_maintenance_drone_add = 2
		}
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		text = job_maintenance_drone_effect_desc
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_gestalt = no }
		}
		text = job_clerk_effect_desc
	}
}

building_tec_resource_silo_3 = {
	base_buildtime = @b3_time
	can_build = no
	position_priority = 400		# Other/Misc

	category = resource

	prerequisites = {
		"tech_housing_2"
	}

	potential = {
		NOR = {
			has_modifier = resort_colony
			has_modifier = slave_colony
		}
	}

	allow = {
		exists = owner
		OR = {
			owner = { is_ai = no }
			AND = {
				NOR = {
					has_active_building = building_resource_silo
					has_active_building = building_tec_resource_silo_2
					has_active_building = building_tec_resource_silo_3
				}
				OR = {
					owner = {
						is_machine_empire = yes
						has_active_tradition = tr_domination_modular_depot
					}
					is_active_resolution = "resolution_greatergood_balance_in_the_middle"
					is_active_resolution = "resolution_greatergood_universal_prosperity_mandate"
					owner = {
						has_ascension_perk = ap_arcology_project
						NOT = { has_technology = tech_mega_engineering }
					}
				}
			}
		}
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b3_minerals
		}
		upkeep = {
			energy = 10
		}
		# Special resource civics
		cost = {
			trigger = {
				owner = { tec_is_bioarch_empire = yes }
			}
			minerals = @b3_minus_minerals
			food = @b3_half_minerals
		}
		upkeep = {
			trigger = {
				owner = { tec_is_bioarch_empire = yes }
			}
			energy = @b3_minus_upkeep
			food = @b3_half_upkeep
		}
		cost = {
			trigger = {
				owner = { has_valid_civic = civic_tec_machine_digitalization }
			}
			minerals = @b3_minus_minerals
			energy = @b3_half_minerals
		}
	}

	country_modifier = {
		country_resource_max_add = 15000
	}

	triggered_country_modifier = {
		potential = {
			exists = owner
			owner = {
				has_technology = tech_global_production_strategy
			}
		}
		country_resource_max_add = 5000
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		modifier = {
			job_clerk_add = 4
		}
	}
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		modifier = {
			job_maintenance_drone_add = 4
		}
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		text = job_maintenance_drone_effect_desc
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_gestalt = no }
		}
		text = job_clerk_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_gestalt = no }
		}
		text = job_merchant_effect_desc
	}
}

# ------------- BIOREACTOR -----------------
# - wip for the future - will be improved



# ------------- DESICCATOR -----------------
building_tec_machine_anglers_extractor = {
	base_buildtime = @b2_time
	base_cap_amount = 5
	position_priority = 220		# Basic Production

	category = resource

	potential = {
		exists = owner
		owner = {
			is_machine_empire = yes
			tec_is_aquatic_empire = yes
		}
		NOR = {
			has_modifier = resort_colony 
			has_modifier = pm_tec_desiccation_1
			has_modifier = pm_tec_desiccation_2
			has_modifier = pm_tec_desiccation_3
		}
		OR = {
			# This makes it only possible on basic planet types
			is_wet = yes
			is_dry = yes
			is_cold = yes
			# Made it this way so modded oversighted planets are handled better
			# So no, not extracting a barren colony or whatever
		}
		habitable_structure = no
	}

	destroy_trigger = {
		exists = owner
		owner = {
			NOR = {
				is_machine_empire = yes
				tec_is_aquatic_empire = yes
			}
		}
		OR = {
			has_modifier = pm_tec_desiccation_1
			has_modifier = pm_tec_desiccation_2
			has_modifier = pm_tec_desiccation_3
		}
	}

	convert_to = {
		building_tec_energrid_1
		building_tec_machine_anglers_extractor_on
	}

	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 1
		}

		inline_script = {
			script = buildings/inline_evolved_machine_prod_extra_cost
			tier = 1
		}

		produces = {
			energy = 1
			multiplier = value:tec_automated_district_production|BASE|3|ECO_CAT|planet_technician|RESOURCE|energy|REQUISITON|has_energy_requisitorium|REQUISITION_AMOUNT|@requisitorium_energy_reduction|
		}
	}

	overlord_resources = {
		category = planet_requisitioned_energy
		produces = {
			trigger = {
				planet = {
					has_planet_flag = has_energy_requisitorium
				}
			}
			energy = @requisitorium_energy_overlord
		}
	}

	triggered_desc = {
		text = tec_building_affect_production_menialbuilding
	}

	inline_script = {
		script = jobs/inline_evolved_technician
		regular_count = 1
		hive_count = 1
		machine_count = 1
		machine_aquatic_count = 1
		display = with_desc
		trigger = ""
	}

	inline_script = {
		script = jobs/inline_evolved_technician_swap
		machine_count = 1
		display = with_desc
		trigger = ""
	}
}

building_tec_machine_anglers_extractor_on = {
	base_buildtime = @b2_time
	base_cap_amount = 5
	position_priority = 220		# Basic Production

	category = resource

	potential = {
		exists = owner
		owner = {
			is_machine_empire = yes
			tec_is_aquatic_empire = yes
		}
		OR = {
			has_modifier = pm_tec_desiccation_1
			has_modifier = pm_tec_desiccation_2
			has_modifier = pm_tec_desiccation_3
		}
		NOR = {
			has_modifier = resort_colony
		}
		OR = {
			# This makes it only possible on basic planet types
			is_wet = yes
			is_dry = yes
			is_cold = yes
			# Made it this way so modded oversighted planets are handled better
			# So no, not extracting a barren colony or whatever
		}
		habitable_structure = no
	}

	destroy_trigger = {
		exists = owner
		owner = {
			NOR = {
				is_machine_empire = yes
				tec_is_aquatic_empire = yes
			}
		}
		NOR = {
			has_modifier = pm_tec_desiccation_1
			has_modifier = pm_tec_desiccation_2
			has_modifier = pm_tec_desiccation_3
		}
	}

	convert_to = {
		building_tec_energrid_1
		building_tec_machine_anglers_extractor
	}

	triggered_desc = {
		text = tec_building_affect_production_menialbuilding
	}

	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 1
		}

		inline_script = {
			script = buildings/inline_evolved_machine_prod_extra_cost
			tier = 1
		}

		produces = {
			energy = 1
			multiplier = value:tec_automated_district_production|BASE|3|BASE_VALUE|tec_machine_angler_extractor_base_production|ECO_CAT|planet_technician|RESOURCE|energy|REQUISITON|has_energy_requisitorium|REQUISITION_AMOUNT|@requisitorium_energy_reduction|
		}
	}

	overlord_resources = {
		category = planet_requisitioned_energy
		produces = {
			trigger = {
				planet = {
					has_planet_flag = has_energy_requisitorium
				}
			}
			energy = @requisitorium_energy_overlord
		}
	}
	
	inline_script = {
		script = jobs/inline_evolved_technician
		regular_count = 1
		hive_count = 1
		machine_count = 1
		machine_aquatic_count = 1
		display = with_desc
		trigger = ""
	}

	inline_script = {
		script = jobs/inline_evolved_technician_swap
		machine_count = 1
		display = with_desc
		trigger = ""
	}
}

building_tec_machine_anglers_nexus_A = {
	base_buildtime = @b4_time
	empire_limit = {
		base = 1
	}
	position_priority = 30		# Unique

	category = resource

	potential = {
		exists = owner
		owner = {
			is_machine_empire = yes
			tec_is_aquatic_empire = yes
		}
		NOR = {
			has_modifier = resort_colony 
			has_modifier = pm_tec_desiccation_1
			has_modifier = pm_tec_desiccation_2
			has_modifier = pm_tec_desiccation_3
		}
	}

	destroy_trigger = {
		exists = owner
		owner = {
			NOR = {
				is_machine_empire = yes
				tec_is_aquatic_empire = yes
			}
		}
		OR = {
			has_modifier = pm_tec_desiccation_1
			has_modifier = pm_tec_desiccation_2
			has_modifier = pm_tec_desiccation_3
		}
	}

	triggered_desc = {
		text = tec_building_affect_production_menialbuilding
	}

	resources = {
		category = planet_buildings
		inline_script = {
			script = buildings/inline_evolved_resource_cost
			tier = 4
		}

		inline_script = {
			script = buildings/inline_evolved_machine_prod_extra_cost
			tier = 3
		}

		produces = {
			energy = 1
			multiplier = value:tec_automated_district_production|BASE|12|BASE_VALUE|tec_machine_angler_nexus_base_production|ECO_CAT|planet_technician|RESOURCE|energy|REQUISITON|has_energy_requisitorium|REQUISITION_AMOUNT|@requisitorium_energy_reduction|
		}
	}

	overlord_resources = {
		category = planet_requisitioned_energy
		produces = {
			trigger = {
				planet = {
					has_planet_flag = has_energy_requisitorium
				}
			}
			energy = @requisitorium_energy_overlord
		}
	}
	
	inline_script = {
		script = jobs/inline_evolved_technician
		regular_count = 2
		hive_count = 2
		machine_count = 2
		machine_aquatic_count = 2
		display = with_desc
		trigger = ""
	}

	inline_script = {
		script = jobs/inline_evolved_technician_swap
		machine_count = 1
		display = with_desc
		trigger = ""
	}
}