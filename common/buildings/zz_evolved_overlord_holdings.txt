# -----------------------------------------
# OVERLORD HOLDINGS
# -----------------------------------------

# SHARED HOLDINGS
# -----------------------------------------
holding_garrison = {					# Defense & anticrime
	base_buildtime = @b1_time
	owner_type = subject_holding
	icon = holding_overlord_garrison
	base_cap_amount = 1

	category = army

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
	}

	planet_modifier = {
		planet_crime_add = -10
		monthly_loyalty = 0.5
	}

	triggered_planet_modifier = {
		potential = {
			overlord_has_num_armies_on_planet = { NUM = 1 }
		}
		modifier = {
			planet_crime_add = -10
			pop_happiness = -0.05
			monthly_loyalty = 0.5
		}
	}

	triggered_planet_modifier = {
		potential = {
			overlord_has_num_armies_on_planet = { NUM = 2 }
		}
		modifier = {
			planet_crime_add = -20
			pop_happiness = -0.1
			monthly_loyalty = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			overlord_has_more_than_num_armies_on_planet = { NUM = 2 }
		}
		modifier = {
			planet_crime_add = -30
			pop_happiness = -0.15
			monthly_loyalty = 1.5
		}
	}

	triggered_desc = {
		text = holding_garrison_armies_desc
	}
}

holding_orbital_assembly_complex = {	# Build Speed
	base_buildtime = @b1_time
	owner_type = subject_holding
	icon = holding_orbital_assembly_complex
	base_cap_amount = 1

	category = manufacturing

	potential = {
		has_overlord_dlc = yes
		is_artificial = no
	}

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
		upkeep = {
			alloys = 5
		}
		# Saving this for future use
		#produces = {
		#	trigger = {
		#		overlord_has_num_constructors_in_orbit = { NUM = 1 }
		#	}
		#	alloys = 3
		#}
		#produces = {
		#	trigger = {
		#		overlord_has_num_constructors_in_orbit = { NUM = 2 }
		#	}
		#	alloys = 6
		#}
		#produces = {
		#	trigger = {
		#		overlord_has_more_than_num_constructors_in_orbit = { NUM = 2 }
		#	}
		#	alloys = 9
		#}
	}

	planet_modifier = {
		planet_building_build_speed_mult = 0.10
	}

	#triggered_planet_modifier = {
	#	potential = {
	#		overlord_has_num_constructors_in_orbit = { NUM = 1 }
	#	}
	#	modifier = {
	#		planet_building_build_speed_mult = 0.10
	#	}
	#}
	#
	#triggered_planet_modifier = {
	#	potential = {
	#		overlord_has_num_constructors_in_orbit = { NUM = 2 }
	#	}
	#	modifier = {
	#		planet_building_build_speed_mult = 0.20
	#	}
	#}
	#
	#triggered_planet_modifier = {
	#	potential = {
	#		overlord_has_more_than_num_constructors_in_orbit = { NUM = 2 }
	#	}
	#	modifier = {
	#		planet_building_build_speed_mult = 0.30
	#	}
	#}

	triggered_desc = {
		text = holding_orbital_assembly_complex_effect
	}
}

holding_propaganda_office = {			# Influence
	base_buildtime = @b2_time
	owner_type = subject_holding
	icon = holding_propaganda_office
	base_cap_amount = 1

	category = government

	potential = {
		has_overlord_dlc = yes
	}

	allow = {
		exists = planet
		planet = { is_capital = yes }
	}
	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
	}


	inline_script = {
		script = jobs/tec_job_overlord
		job = overlord_propagandist
		count = 2
		mult = 1
		trigger = ""
		default_job = overlord_propagandist
	}
}

holding_satellite_campus = {			# Research
	base_buildtime = @b2_time
	owner_type = subject_holding
	icon = holding_satellite_campus
	base_cap_amount = 1

	category = research

	potential = {
		has_overlord_dlc = yes
	}

	resources = {
		category = planet_holdings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			energy = @b1_upkeep
		}
	}

	inline_script = {
		script = jobs/tec_job_overlord
		job = overlord_academic
		count = 2
		mult = 1
		trigger = ""
		default_job = overlord_academic
	}
}

holding_emporium = {					# Energy
	base_buildtime = @b2_time
	owner_type = subject_holding
	icon = holding_emporium
	base_cap_amount = 1

	category = amenity

	potential = {
		owner.overlord = {
			tec_uses_trade_value = yes
		}
	}

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
		upkeep = {
			consumer_goods = 5
		}
	}

	inline_script = {
		script = jobs/tec_job_overlord
		job = overlord_trader
		count = 2
		mult = 1
		trigger = ""
		default_job = overlord_trader
	}
}

holding_aid_agency = {					# Amenities
	base_buildtime = @b2_time
	owner_type = subject_holding
	icon = holding_aid_agency
	base_cap_amount = 1

	category = amenity

	allow = {
		custom_tooltip = {
			fail_text = overlord_is_homicidal
			exists = owner.overlord
			owner.overlord = {
				is_homicidal = no
			}
		}
		custom_tooltip = {
			fail_text = overlord_is_xenophobe
			exists = owner.overlord
			owner.overlord = {
				is_xenophobe = no
			}
		}
		custom_tooltip = {
			fail_text = tec_overlord_is_apathic
			exists = owner.overlord
			owner.overlord = {
				NOT = { has_ethic = ethic_gestalt_apathy }
			}
		}
	}
	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
		upkeep = {
			trigger = {
				exists = planet.owner
				planet.owner = { is_lithoid = yes }
			}
			minerals = 10
		}
		upkeep = {
			trigger = {
				exists = planet.owner
				planet.owner = {
					OR = {
						is_machine_empire = yes
						is_mechanical_empire = yes
					}
				}
			}
			energy = 10
		}
		upkeep = {
			trigger = {
				exists = planet.owner
				planet.owner = {
					is_lithoid = no
					is_machine_empire = no
					is_mechanical_empire = no
				}
			}
			food = 10
		}
	}

	planet_modifier = {
		monthly_loyalty = 1.5
	}


	inline_script = {
		script = jobs/tec_job_overlord
		job = aid_worker
		count = 2
		mult = 1
		trigger = ""
		default_job = aid_worker
	}
}

holding_energy_requisitorium = {		# Minus Energy
	base_buildtime = @b2_time
	owner_type = subject_holding
	icon = holding_energy_requisitorium
	base_cap_amount = 1

	category = resource

	potential = {
		has_overlord_dlc = yes
	}

	allow = {
		custom_tooltip = {
			fail_text = ove_requires_tech_power_hub_2
			owner.overlord = {
				has_technology = tech_power_hub_2
			}
		}
	}

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
		upkeep = {
			exotic_gases = 1
		}
	}

	planet_modifier = {
		monthly_loyalty = -0.25
	}

	on_built = {
		planet = {
			set_planet_flag = has_energy_requisitorium
		}
	}

	on_destroy = {
		planet = {
			remove_planet_flag = has_energy_requisitorium
		}
	}

	triggered_desc = {
		text = job_energy_requisitioned_effect_desc
	}
}

holding_material_requisitorium = {		# Minus Minerals
	base_buildtime = @b2_time
	owner_type = subject_holding
	icon = holding_material_requisitorium
	base_cap_amount = 1

	category = resource

	potential = {
		has_overlord_dlc = yes
	}

	allow = {
		custom_tooltip = {
			fail_text = ove_requires_tech_mineral_purification_2
			owner.overlord = {
				has_technology = tech_mineral_purification_2
			}
		}
	}

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
		upkeep = {
			volatile_motes = 1
		}
	}

	planet_modifier = {
		monthly_loyalty = -0.5
	}

	on_built = {
		planet = {
			set_planet_flag = has_material_requisitorium
		}
	}

	on_destroy = {
		planet = {
			remove_planet_flag = has_material_requisitorium
		}
	}

	triggered_desc = {
		text = job_minerals_requisitioned_effect_desc
	}

	triggered_desc = {
		text = job_alloy_requisitioned_effect_desc
	}
}

holding_produce_requisitorium = {		# Minus Food
	base_buildtime = @b2_time
	owner_type = subject_holding
	icon = holding_produce_requisitorium
	base_cap_amount = 1

	category = resource

	potential = {
		has_overlord_dlc = yes
	}

	allow = {
		custom_tooltip = {
			fail_text = ove_requires_tech_food_processing_2
			owner.overlord = {
				has_technology = tech_food_processing_2
			}
		}
	}

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
		upkeep = {
			rare_crystals = 1
		}
	}

	planet_modifier = {
		monthly_loyalty = -0.25
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner.overlord
			owner.overlord = { country_uses_consumer_goods = yes }
		}
		monthly_loyalty = -0.25
	}

	on_built = {
		planet = {
			set_planet_flag = has_produce_requisitorium
		}
	}

	on_destroy = {
		planet = {
			remove_planet_flag = has_produce_requisitorium
		}
	}

	triggered_desc = {
		text = job_food_requisitioned_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner.overlord
			owner.overlord = { country_uses_consumer_goods = yes }
		}
		text = job_consumer_goods_requisitioned_effect_desc
	}
}

# VASSAL SPECS
# -----------------------------------------
holding_offworld_foundry = {			# Prospectorium
	base_buildtime = @b2_time
	owner_type = subject_holding
	icon = holding_offworld_foundry
	base_cap_amount = 1

	category = manufacturing

	potential = {
		has_overlord_dlc = yes
	}

	allow = {
		custom_tooltip = {
			fail_text = subject_is_prospectorium
			exists = planet.owner
			planet.owner = {
				is_specialist_subject_type = { TYPE = prospectorium }
			}
		}
	}

	destroy_trigger = {
		exists = planet.owner
		planet.owner = {
			NOT = {
				is_specialist_subject_type = { TYPE = prospectorium }
			}
		}
	}

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
	}

	planet_modifier = {
		monthly_loyalty = -1.5
	}

	inline_script = {
		script = jobs/tec_job_overlord_foundry
		count = 2
		mult = 1
		trigger = ""
		default_job = overlord_metallurgist
	}
}

holding_overlord_vigil_command = {		# bulwark
	base_buildtime = @b2_time
	owner_type = subject_holding
	icon = holding_overlord_vigil_command
	base_cap_amount = 1
	empire_limit = 1

	category = army

	potential = {
		has_overlord_dlc = yes
	}

	allow = {
		custom_tooltip = {
			fail_text = is_capital
			exists = planet
			planet = {
				is_capital = yes
			}
		}
		custom_tooltip = {
			fail_text = subject_is_bulwark
			exists = planet.owner
			planet.owner = {
				is_specialist_subject_type = { TYPE = bulwark }
			}
		}
	}

	destroy_trigger = {
		exists = planet.owner
		planet.owner = {
			NOT = {
				is_specialist_subject_type = { TYPE = bulwark }
			}
		}
	}

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
	}

	inline_script = {
		script = jobs/tec_job_overlord
		job = overlord_beholder
		count = 2
		mult = 1
		trigger = ""
		default_job = overlord_beholder
	}

	triggered_country_modifier = {
		potential = {
			planet.owner = {
				is_specialist_subject_tier = {
					TYPE = bulwark
					TIER = 1
				}
			}
		}
		starbase_defense_platform_capacity_add = 1
	}

	triggered_country_modifier = {
		potential = {
			planet.owner = {
				is_specialist_subject_tier = {
					TYPE = bulwark
					TIER = 2
				}
			}
		}
		starbase_defense_platform_capacity_add = 2
	}

	triggered_country_modifier = {
		potential = {
			planet.owner = {
				is_specialist_subject_tier = {
					TYPE = bulwark
					TIER = 3
				}
			}
		}
		starbase_defense_platform_capacity_add = 4
	}

}

holding_parasitic_algorithms = {		# Scholarium
	base_buildtime = @b2_time
	owner_type = subject_holding
	icon = holding_parasitic_algorithms
	base_cap_amount = 1
	empire_limit = 1

	category = research

	potential = {
		has_overlord_dlc = yes
	}

	allow = {
		custom_tooltip = {
			fail_text = is_capital
			exists = planet
			planet = {
				is_capital = yes
			}
		}
		custom_tooltip = {
			fail_text = subject_is_scholarium
			exists = planet.owner
			planet.owner = {
				is_specialist_subject_type = { TYPE = scholarium }
			}
		}
	}

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
	}

	country_modifier = {
		all_technology_research_speed = 0.03
		# 3.11 - No.
		#planet_researchers_upkeep_mult = 0.03
	}

	planet_modifier = {
		monthly_loyalty = -1
	}

	on_built = {
		planet = {
			set_planet_flag = has_science_ministry
		}
	}

	on_destroy = {
		planet = {
			remove_planet_flag = has_science_ministry
		}
	}
		#triggered_planet_modifier = {
		#	potential = {
		#		overlord_has_num_science_ships_in_orbit = { NUM = 1 }
		#	}
		#	modifier = {
		#		monthly_loyalty = -0.5
		#	}
		#}
		#
		#triggered_planet_modifier = {
		#	potential = {
		#		overlord_has_num_science_ships_in_orbit = { NUM = 2 }
		#	}
		#	modifier = {
		#		monthly_loyalty = -1
		#	}
		#}
		#
		#triggered_planet_modifier = {
		#	potential = {
		#		overlord_has_more_than_num_science_ships_in_orbit = { NUM = 2 }
		#	}
		#	modifier = {
		#		monthly_loyalty = -1.5
		#	}
		#}
		#
		#triggered_country_modifier = {
		#	potential = {
		#		overlord_has_num_science_ships_in_orbit = { NUM = 1 }
		#	}
		#	all_technology_research_speed = 0.03
		#}
		#
		#triggered_country_modifier = {
		#	potential = {
		#		overlord_has_num_science_ships_in_orbit = { NUM = 2 }
		#	}
		#	all_technology_research_speed = 0.06
		#}
		#
		#triggered_country_modifier = {
		#	potential = {
		#		overlord_has_more_than_num_science_ships_in_orbit = { NUM = 2 }
		#	}
		#	all_technology_research_speed = 0.09
		#}

	destroy_trigger = {
		exists = planet.owner
		planet.owner = {
			NOT = {
				is_specialist_subject_type = { TYPE = scholarium }
			}
		}
	}

	triggered_desc = {
		text = holding_parasitic_algorithms_effect_desc
	}
}

#holding_tec_ilustration_center			# Ilustratorium

#holding_tec_development_center			# Assistorium

# ORIGIN HOLDINGS
# -----------------------------------------
holding_tree_of_life_sapling = {		# Tree of life
	base_buildtime = @b1_time
	owner_type = subject_holding
	icon = holding_tree_of_life_sapling
	base_cap_amount = 1

	category = resource

	resources = {
		category = planet_holdings
		cost = {
			food = 1000
		}
	}

	potential = {
		owner.overlord = { has_origin = origin_tree_of_life }
		NOR = {
			owner = {
				has_origin = origin_tree_of_life
				country_uses_food = no
			}
		}
		tec_is_city_world = no
		tec_is_machine_world = no
		tec_is_relic_world = no
		is_artificial = no
	}
	destroy_trigger = {
		tec_is_city_world = no
		tec_is_machine_world = no
		tec_is_relic_world = no
	}

	planet_modifier = {
		monthly_loyalty = 1
		pop_environment_tolerance = 0.1
		planet_farmers_food_produces_add = 1
	}

	inline_script = {
		script = jobs/tec_job_overlord
		job = overlord_arborist
		count = 2
		mult = 1
		trigger = ""
		default_job = overlord_arborist
	}
}

holding_experimental_crater = {			# Calamitous birth
	base_buildtime = @b2_time
	owner_type = subject_holding
	icon = holding_experimental_crater
	base_cap_amount = 1

	category = research

	resources = {
		category = planet_holdings
		produces = {
			engineering_research = 8
			physics_research = 4
		}
	}

	potential = {
		owner.overlord = { has_origin = origin_lithoid }
	}

	planet_modifier = {
		monthly_loyalty = -1
	}

	on_built = {
		planet = {
			planet_event = { id = subject.5005 days = 360 }
		}
	}

	inline_script = {
		script = jobs/tec_miner
		count = 3
		mult = 1
		display = with_desc
		trigger = ""
		default_job = miner
	}

	triggered_desc = {
		text = holding_experimental_crater_effect
	}
}

holding_offspring_nest = {				# Progenitor Hive
	base_buildtime = @b2_time
	owner_type = subject_holding
	icon = building_offspring_nest
	base_cap_amount = 1

	category = government

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
	}

	potential = {
		owner.overlord = {
			is_hive_empire = yes
			has_origin = origin_progenitor_hive
		}
		has_overlord_dlc = yes
	}

	allow = {
		owner = {
			NOT = { has_origin = origin_progenitor_hive }
		}
	}

	inline_script = {
		script = jobs/tec_job_overlord
		job = overlord_offspring_drone_feeder
		count = 2
		mult = 1
		trigger = ""
		default_job = overlord_offspring_drone_feeder
	}
}

holding_knight_commandery = {			# Knights of the Toxic God
	base_buildtime = @b1_time
	owner_type = subject_holding
	icon = building_order_holding
	base_cap_amount = 1

	category = government

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
	}

	potential = {
		owner.overlord = {
			has_origin = origin_toxic_knights
			NOT = { has_country_flag = quest_abandoned }
		}
	}

	allow = {
		exists = planet
		planet = {
			is_capital = yes
			num_pops >= 50
		}
	}

	destroy_trigger = {
		OR = {
			NOT = { exists = owner.overlord }
			owner.overlord = { NOT = { has_origin = origin_toxic_knights } }
		}
	}

	planet_modifier = {
		monthly_loyalty = -0.5
	}


	inline_script = {
		script = jobs/tec_job_overlord
		job = overlord_knight
		count = 1
		mult = 1
		trigger = ""
		default_job = overlord_knight
	}

	triggered_country_modifier = {	# Navalcap rework
		potential = {
			always = yes
		}
		country_naval_cap_add = 4
		#mult = value:tec_scripted_modifier_mult_versatile|MODIFIER|knights_independent_category_produces_mult|MODIFIER_2|pop_job_naval_mult|
		mult = value:scripted_modifier_mult|MODIFIER|pop_job_naval_mult|
	}
}

holding_transcendental_retreat = {
	base_buildtime = @b1_time
	owner_type = subject_holding
	icon = building_transcendental_retreat
	base_cap_amount = 1

	category = amenity

	potential = {
		owner.overlord = {
			is_natural_design_empire = yes
		}
	}

	destroy_trigger = {
		owner.overlord = {
			is_natural_design_empire = no
		}
	}

	resources = {
		category = planet_holdings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			minerals = @b2_upkeep
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = { 
				has_ascension_path = yes
			}
		}
		monthly_loyalty = -0.5
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = { 
				has_ascension_path = no
			}
		}
		monthly_loyalty = 0.5
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_natural_design_empire = yes
			}
		}
		planet_jobs_produces_mult = 0.1
	}

	inline_script = {
		script = jobs/tec_healthcare
		count = 1
		mult = 1
		display = with_desc
		trigger = ""
		default_job = healthcare
	}

	inline_script = {
		script = jobs/tec_spawning_drone
		count = 1
		mult = 1
		display = with_desc
		trigger = ""
	}

	inline_script = {
		script = jobs/tec_replicator
		count = 1
		mult = 1
		display = with_desc
		trigger = ""
	}
}

# CIVIC HOLDINGS
# -----------------------------------------
holding_noble_vacation_homes = {		# Aristocratic Elite
	base_buildtime = @b2_time
	owner_type = subject_holding
	icon = building_palace
	base_cap_amount = 1

	category = amenity

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
	}

	potential = {
		owner.overlord = { has_valid_civic = civic_aristocratic_elite }
	}

	planet_modifier = {
		monthly_loyalty = -1
	}

	inline_script = {
		script = modifiers/tec_amenities
		count = 15
		mult = 1
		trigger = ""
	}

	on_built = {
		planet = {
			owner.overlord.capital_scope = {
				append_noble_vacation_home = yes
				refresh_noble_vacation_home_modifier = yes
			}
		}
	}

	on_destroy = {
		owner.overlord.capital_scope = {
			remove_noble_vacation_home = yes
			refresh_noble_vacation_home_modifier = yes
		}
	}
	triggered_desc = {
		text = holding_noble_vacation_homes_effect
	}
}

holding_dread_outpost = {				# Dread Armies
	base_buildtime = @b2_time
	owner_type = subject_holding
	icon = building_dread_encampment
	base_cap_amount = 1

	category = army

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
	}

	potential = {
		owner.overlord = {
			has_valid_civic = civic_reanimated_armies
		}
	}

	allow = {
		owner = {
			NOR = {
				has_valid_civic = civic_reanimated_armies
				is_machine_empire = yes
			}
		}
	}

	inline_script = {
		script = jobs/tec_job_overlord
		job = overlord_necromancer
		count = 2
		mult = 1
		trigger = ""
		default_job = overlord_necromancer
	}

	on_built = {
		planet = {
			set_planet_flag = active_dread_outpost
		}
	}

	on_destroy = {
		planet = {
			remove_planet_flag = active_dread_outpost
		}
	}
}

holding_sacrificial_shrine = {			# Death cults
	base_buildtime = @b1_time
	owner_type = subject_holding
	icon = building_sacrificial_temple_2
	base_cap_amount = 1

	category = unity

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
	}

	potential = {
		owner.overlord = { is_death_cult_empire = yes }
		owner = { is_machine_empire = no }
	}

	destroy_trigger = {
		owner = { is_machine_empire = yes }
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = { is_spiritualist = no }
		}
		monthly_loyalty = -0.5
	}

	inline_script = {
		script = jobs/tec_job_overlord
		job = overlord_mortal_initiate
		count = 2
		mult = 1
		trigger = ""
		default_job = overlord_mortal_initiate
	}
}

holding_franchise_headquarters = {		# Franchising megacorps
	base_buildtime = @b2_time
	owner_type = subject_holding
	icon = holding_franchise_headquarters
	base_cap_amount = 1

	category = government

	destroy_trigger = {
		NOT = {
			planet = {
				has_branch_office = owner.overlord
			}
		}
	}

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
	}

	potential = {
		owner.overlord = { has_civic = civic_franchising }
	}

	allow = {
		custom_tooltip = {
			fail_text = no_branch_office
			planet = {
				has_branch_office = owner.overlord
			}
		}
	}

	planet_modifier = {
		monthly_loyalty = -0.5
	}

	triggered_planet_modifier = {
		potential = {
			OR = {
				is_scope_valid = no
				AND = {
					exists = owner
					owner = { is_regular_empire = yes }
				}
			}
		}
		tec_job_clerk_trade_value_add = -1
	}

	inline_script = {
		script = jobs/tec_job_overlord
		job = overlord_manager
		count = 2
		mult = 1
		trigger = ""
		default_job = overlord_manager
	}

	inline_script = {
		script = iterators/tec_iterate_ethic_regular
		code = "
			triggered_planet_modifier = {
				potential = {
					exists = owner
					owner = {
						is_gestalt = no
					}
					owner.overlord = {
						has_ethic = ethic_fanatic_$ethic$
					}
				}
				pop_ethic_spiritualist_attraction_mult = 1
			}
		"
	}

	triggered_desc = {
		text = job_overlord_manager_effect_desc
	}

	triggered_desc = {
		text = holding_franchise_headquarters_effect
	}

	triggered_desc = {
		trigger = {
			OR = {
				is_scope_valid = no
				AND = {
					exists = owner.overlord
					owner.overlord = {
						is_fanatic = no
					}
				}
			}

		}
		text = holding_franchise_headquarters_ethics_effect
	}
}

holding_communal_housing_outreach = {	# Shared Burdens
	base_buildtime = @b1_time
	owner_type = subject_holding
	icon = building_residence
	base_cap_amount = 1

	category = amenity

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
	}

	potential = {
		owner.overlord = { tec_is_shared_burden_empire = yes }
		NOT = {
			owner = { tec_is_shared_burden_empire = yes }
		}
	}

	planet_modifier = {
		planet_housing_add = 10
		planet_amenities_add = 6
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = { is_authoritarian = yes }
		}
		monthly_loyalty = -0.5
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = {
				is_egalitarian = yes
			}
		}
		monthly_loyalty = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = {
				is_egalitarian = no
				is_gestalt = no
			}
		}
		pop_ethic_egalitarian_attraction_mult = 1
	}
}

holding_idyllic_bloom = {				# Idyllic Bloom
	base_buildtime = @b1_time
	owner_type = subject_holding
	icon = building_gaiaseeders_4
	base_cap_amount = 1

	category = government

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_rare_resource_cost
			trigger = ""
			tier = 3
			rare = exotic_gases
		}
		cost = {
			energy = 1500
		}
		upkeep = {
			energy = 20
			multiplier = value:overlord_gaiaseeder_upkeep
		}
	}

	potential = {
		exists = owner
		owner.overlord = {
			tec_is_default_country = yes
			tec_is_idyllic_bloom_empire = yes
		}
		tec_planet_allows_gaiaseeders = yes
	}

	allow = {
		can_build_overlord_gaiaseeder = yes
	}

	#planet_modifier = {
	#	pop_environment_tolerance = 0.2
	#}

	# Loyalty modifiers
		triggered_planet_modifier = {
			potential = {
				exists = planet.owner
				planet.owner = {
					has_ascension_perk = ap_hydrocentric
				}
			}
			monthly_loyalty = -0.5
		}
		triggered_planet_modifier = {
			potential = {
				exists = planet.owner
				planet.owner = {
					NOT = { has_ascension_perk = ap_hydrocentric }
				}
			}
			monthly_loyalty = 1
		}
	# /

	# Production modifiers
		triggered_planet_modifier = {	# Regular empires
			potential = {
				OR = {
					is_scope_valid = no
					AND = {
						exists = planet.owner
						planet.owner = {
							is_machine_empire = no
						}
					}
				}
			}
			pop_growth_speed = 0.15
			planet_pop_assembly_organic_mult = 0.15
			gaia_planet_jobs_produces_mult = 0.15
		}
		triggered_planet_modifier = {	# Synths
			potential = {
				exists = planet.owner
				planet.owner = {
					OR = {
						is_synthetic_empire = yes
						AND = {
							is_machine_empire = yes
							NOR = {
								tec_is_organic_machine_empire = yes
								tec_is_organic_coexist_machine = yes
							}
						}
					}
				}
			}
			planet_pop_assembly_mult = 0.15
			pop_job_amenities_mult = 0.15
			gaia_planet_jobs_produces_mult = 0.15
		}
		triggered_planet_modifier = {	# Mixed machines
			potential = {
				exists = planet.owner
				planet.owner = {
					OR = {
						tec_is_organic_machine_empire = yes
						tec_is_organic_coexist_machine = yes
					}
				}
			}
			planet_pop_assembly_mult = 0.15
			pop_growth_speed = 0.15
			gaia_planet_jobs_produces_mult = 0.15
		}
	# /

	triggered_desc = {
		trigger = {
			exists = planet
			planet = {
				tec_is_gaia_world = yes
			}
		}
		text = holding_tec_idyllic_bloom_gaia_effect
	}
	triggered_desc = {
		trigger = {
			planet = {
				has_planet_flag = anti_cheese_idyllic_bloom_flag
			}
		}
		text = holding_idyllic_bloom_effect_timer
	}
	triggered_desc = {
		trigger = {
			OR = {
				is_scope_valid = no
				planet = {
					NOT = {
						has_planet_flag = anti_cheese_idyllic_bloom_flag
					}
				}
			}
		}
		text = holding_idyllic_bloom_effect
	}

	on_built = {
		planet = {
			set_timed_planet_flag = {
				flag = anti_cheese_idyllic_bloom_flag
				days = 3599
			}
			set_saved_date = {
				key = idyllic_bloom_holding_timer
				days_from_present = 3600
				expires = 3600
			}
		}
		owner.overlord = {
			country_event = {
				id = plant.105
				days = 3600
			}
		}
	}
	on_destroy = {
		planet = {
			remove_planet_flag = anti_cheese_idyllic_bloom_flag
		}
	}
}

holding_tec_idyllic_bloom_gaia = {		# Idyllic Bloom
	base_buildtime = @b1_time
	owner_type = subject_holding
	icon = building_gaiaseeders_4
	base_cap_amount = 1

	category = government

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_rare_resource_cost
			trigger = ""
			tier = 3
			rare = exotic_gases
		}
		cost = {
			energy = 1500
		}
		upkeep = {
			energy = 20
			multiplier = value:overlord_gaiaseeder_upkeep
		}
	}

	potential = {
		exists = owner
		owner.overlord = {
			tec_is_default_country = yes
			tec_is_idyllic_bloom_empire = yes
		}
		tec_is_gaia_world = yes
	}

	allow = {
		tec_is_gaia_world = yes
	}

	destroy_trigger = {
		OR = {
			tec_is_gaia_world = no
			NOT = { exists = owner.overlord }
			owner.overlord = {
				tec_is_idyllic_bloom_empire = no
			}
		}
	}

	# Loyalty modifiers
		triggered_planet_modifier = {
			potential = {
				exists = planet.owner
				planet.owner = {
					has_ascension_perk = ap_hydrocentric
				}
			}
			monthly_loyalty = -0.5
		}
		triggered_planet_modifier = {
			potential = {
				exists = planet.owner
				planet.owner = {
					NOT = { has_ascension_perk = ap_hydrocentric }
				}
			}
			monthly_loyalty = 1
		}
	# /

	# Production modifiers
		triggered_planet_modifier = {	# Regular empires
			potential = {
				OR = {
					is_scope_valid = no
					AND = {
						exists = planet.owner
						planet.owner = {
							is_machine_empire = no
						}
					}
				}
			}
			pop_growth_speed = 0.15
			planet_pop_assembly_organic_mult = 0.15
			gaia_planet_jobs_produces_mult = 0.15
		}
		triggered_planet_modifier = {	# Synths
			potential = {
				exists = planet.owner
				planet.owner = {
					OR = {
						is_synthetic_empire = yes
						AND = {
							is_machine_empire = yes
							NOR = {
								tec_is_organic_machine_empire = yes
								tec_is_organic_coexist_machine = yes
							}
						}
					}
				}
			}
			planet_pop_assembly_mult = 0.15
			pop_job_amenities_mult = 0.15
			gaia_planet_jobs_produces_mult = 0.15
		}
		triggered_planet_modifier = {	# Mixed machines
			potential = {
				exists = planet.owner
				planet.owner = {
					OR = {
						tec_is_organic_machine_empire = yes
						tec_is_organic_coexist_machine = yes
					}
				}
			}
			planet_pop_assembly_mult = 0.15
			pop_growth_speed = 0.15
			gaia_planet_jobs_produces_mult = 0.15
		}
	# /

	triggered_desc = {
		text = holding_tec_idyllic_bloom_gaia_effect
	}
}


holding_reemployment_center = {			# Permanent Employment
	base_buildtime = @b1_time
	owner_type = subject_holding
	icon = building_posthumous_employment_center
	base_cap_amount = 1

	category = pop_assembly

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
	}

	potential = {
		owner.overlord = { has_valid_civic = civic_permanent_employment }
		NOT = {
			owner = { has_valid_civic = civic_permanent_employment }
		}
		owner = {
			is_machine_empire = no
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = { is_egalitarian = yes }
		}
		monthly_loyalty = -0.5
	}

	inline_script = {
		script = jobs/tec_job_overlord
		job = overlord_reassigner
		count = 2
		mult = 1
		trigger = ""
		default_job = overlord_reassigner
	}

	triggered_desc = {
		trigger = {
			has_planet_flag = reemployment_center_timer
		}
		text = holding_reemployment_center_effect
	}
}

holding_recruitment_office = {			# Citizen Service
	base_buildtime = @b1_time
	owner_type = subject_holding
	icon = holding_recruitment_office
	base_cap_amount = 1

	category = army

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
	}

	potential = {
		owner.overlord = { has_valid_civic = civic_citizen_service }
	}

	inline_script = {
		script = jobs/tec_job_overlord
		job = overlord_recruiter
		count = 2
		mult = 1
		trigger = ""
		default_job = overlord_recruiter
	}

	triggered_country_modifier = {	# TO DO NAVALCAP REWORK
		potential = {
			always = yes
		}
		country_naval_cap_add = 5
		mult = value:scripted_modifier_mult|MODIFIER|pop_job_naval_mult|
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = { is_pacifist = yes }
		}
		monthly_loyalty = -0.5
	}

	on_built = {
		planet = {
			planet_event = { id = subject.5010 days = 1800 }
		}
	}
}

holding_park_ranger_lodge = {			# Environmentalist
	base_buildtime = @b2_time
	owner_type = subject_holding
	icon = holding_park_ranger_lodge
	base_cap_amount = 1

	category = amenity

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
	}

	potential = {
		owner.overlord = { tec_is_terraformer_environmentalist_empire = yes }
		NOT = {
			owner = { tec_is_terraformer_environmentalist_empire = yes }
		}
		NOR = {
			tec_is_city_world = yes
			tec_is_relic_world = yes
			tec_is_machine_world = yes
			tec_is_hive_world = yes
		}
		is_artificial = no
	}

	allow = {
		custom_tooltip = {
			fail_text = no_free_district_for_ranger_lodge
			planet = {
				num_free_districts = {
					type = any
					value > 0
				}
			}
		}
	}

	inline_script = {
		script = jobs/tec_job_overlord
		job = overlord_ranger
		count = 1
		mult = 1
		trigger = ""
		default_job = overlord_ranger
	}


	on_built = {
		planet = {
			add_blocker = { type = d_nature_preserve_blocker }
		}
	}

	on_destroy = {
		planet = {
			if = {
				limit = { has_deposit = d_nature_preserve_blocker }
				remove_deposit = d_nature_preserve_blocker
			}
		}
	}
}

holding_toxic_bath = {					# Toxic bath - regular
	base_buildtime = @b1_time
	owner_type = subject_holding
	icon = building_toxic_bath
	base_cap_amount = 1

	category = amenity

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
		upkeep = {
			consumer_goods = @b1_upkeep
		}
	}

	potential = {
		owner.overlord = { has_toxic_baths = yes }
		owner = { is_gestalt = no }
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = { tec_is_terraformer_environmentalist_empire = yes }
		}
		monthly_loyalty = -0.5
	}

	inline_script = {
		script = jobs/tec_job
		job = overlord_bath_attendant
		count = 1
		mult = 1
		display = no_desc
		trigger = "
			exists = planet.owner
			planet.owner = { is_gestalt = no }
		"
		default_job = overlord_bath_attendant
	}


	triggered_desc = {
		text = job_overlord_toxic_baths_effect_desc
	}
}

holding_toxic_bath_hive = {				# Toxic bath - hive
	base_buildtime = @b1_time
	owner_type = subject_holding
	icon = building_toxic_bath_hive
	base_cap_amount = 1

	category = amenity

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
		upkeep = {
			food = @b2_upkeep
		}
	}

	potential = {
		owner.overlord = { has_toxic_baths = yes }
		owner = { is_hive_empire = yes }
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = { tec_is_terraformer_environmentalist_empire = yes }
		}
		monthly_loyalty = -0.5
	}


	inline_script = {
		script = jobs/tec_job
		job = overlord_bath_attendant_hive
		count = 1
		mult = 1
		display = no_desc
		trigger = "
			exists = planet.owner
			planet.owner = { is_hive_empire = yes }
		"
		default_job = overlord_bath_attendant_hive
	}

	triggered_desc = {
		text = job_overlord_toxic_baths_effect_hive_desc
	}
}

holding_toxic_bath_machine = {			# Toxic bath - machine
	base_buildtime = @b1_time
	owner_type = subject_holding
	icon = building_toxic_bath_machine
	base_cap_amount = 1

	category = amenity

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
		upkeep = {
			minerals = @b2_upkeep
		}
	}

	potential = {
		owner.overlord = { has_toxic_baths = yes }
		owner = { is_machine_empire = yes }
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = { tec_is_terraformer_environmentalist_empire = yes }
		}
		monthly_loyalty = -0.5
	}

	inline_script = {
		script = jobs/tec_job
		job = overlord_bath_attendant_machine
		count = 1
		mult = 1
		display = no_desc
		trigger = "
			exists = planet.owner
			planet.owner = { is_machine_empire = yes }
		"
		default_job = overlord_bath_attendant_machine
	}

	triggered_desc = {
		text = job_overlord_toxic_baths_effect_machine_desc
	}
}

# ------------- Hive Mind -----------------
holding_splinter_hive = {				# 
	base_buildtime = @b2_time
	owner_type = subject_holding
	icon = holding_splinter_hive
	base_cap_amount = 1

	category = pop_assembly

	potential = {
		has_overlord_dlc = yes
		owner.overlord = { is_hive_empire = yes }
	}

	allow = {
		custom_tooltip = {
			fail_text = no_free_district_for_splinter_hive
			planet = {
				num_free_districts = {
					type = any
					value > 0
				}
			}
		}
		planet = {
			num_pops >= 25
		}
	}

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
	}

	planet_modifier = {
		monthly_loyalty = -2
	}

	inline_script = {
		script = jobs/tec_job_overlord
		job = overlord_breeder
		count = 1
		mult = 1
		trigger = ""
		default_job = overlord_breeder
	}

	on_built = {
		planet = {
			add_blocker = { type = d_spawning_complex_blocker }
			owner.overlord.capital_scope = {
				append_symbiotic_link = yes
				refresh_splinter_hive_modifier = yes
			}
		}
	}

	on_destroy = {
		planet = {
			if = {
				limit = { has_deposit = d_spawning_complex_blocker }
				remove_deposit = d_spawning_complex_blocker
			}
			owner.overlord.capital_scope = {
				remove_symbiotic_link = yes
				refresh_splinter_hive_modifier = yes
			}
		}
	}
}

#holding_tec_hive_cybernetic_datacenter

#holding_tec_hive_resonance_tower

# MACHINE HOLDINGS
# -----------------------------------------
holding_distributed_processing = {		# Non Servitor Machine
	base_buildtime = @b2_time
	owner_type = subject_holding
	icon = holding_distributed_processing
	base_cap_amount = 1

	category = research

	potential = {
		owner.overlord = {
			OR = {
				AND = {
					is_machine_empire = yes
					NOT = { has_civic = civic_machine_servitor }
				}
				has_valid_civic = civic_tec_hive_mindflayers
			}
		}
		has_overlord_dlc = yes
	}

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
	}

	planet_modifier = {
		monthly_loyalty = -2
	}

	inline_script = {
		script = jobs/tec_job_overlord
		job = mind_thrall
		count = 4
		mult = 1
		trigger = ""
		default_job = mind_thrall
	}
}

holding_organic_sanctuary = {			# Servitors
	base_buildtime = @b2_time
	owner_type = subject_holding
	icon = building_organic_sanctuary
	base_cap_amount = 1

	category = unity

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
		upkeep = {
			consumer_goods = 10
		}
	}

	potential = {
		owner.overlord = { has_valid_civic = civic_machine_servitor }
		owner = { is_machine_empire = no }
	}

	triggered_planet_modifier = {
		potential = {
			OR = {
				is_scope_valid = no
				AND = {
					exists = owner
					owner = { is_gestalt = no }
				}
			}
		}
		monthly_loyalty = 0.5
	}

	inline_script = {
		script = jobs/tec_job_overlord
		job = overlord_bio_trophy
		count = 5
		mult = 1
		trigger = ""
		default_job = overlord_bio_trophy
	}
}

#holding_tec_machine_assimilators_conversor

holding_tec_centrality_core_administration = {
	base_buildtime = @b2_time
	owner_type = subject_holding
	icon = building_temple_of_prosperity
	base_cap_amount = 1

	category = government

	resources = {
		category = planet_holdings
		inline_script = {
			script = buildings/resources/tec_holding_building_resource_cost
			tier = 1
		}
	}

	potential = {
		owner.overlord = {
			has_active_tradition = tr_tec_centrality_final_3
		}
		owner = {
			is_subject_with_preset = {
				PRESET = preset_tec_satellite
			}
		}

	}
	allow = {
		custom_tooltip = {
			fail_text = is_capital
			exists = planet
			planet = {
				is_capital = yes
			}
		}
	}

	inline_script = {
		script = jobs/tec_politician
		count = 2
		mult = 1
		trigger = ""
		display = with_desc
		default_job = politician
	}

	inline_script = {
		script = jobs/tec_synapse
		count = 4
		mult = 1
		trigger = ""
		display = with_desc
	}

	inline_script = {
		script = jobs/tec_coordinator
		count = 4
		mult = 1
		trigger = ""
		display = with_desc
	}

	triggered_planet_modifier = {
		monthly_loyalty = -0.25
	}

	triggered_country_modifier = {
		country_admin_cap_add = 2
		mult = planet.owner.trigger:num_owned_planets
	}

	triggered_desc = {
		text = holding_tec_centrality_core_administration_effect
	}

}