# common\buildings\zz_evolved_manufacturing_buildings.txt

# -----------------------------------------
#		I N D U S T R I A L	B.
# -----------------------------------------

# BOOSTERS
# -----------------------------------------
 # Industrial
	# Regular
	building_ministry_production = {
		base_buildtime = @b2_time
		base_cap_amount = 1
		position_priority = 11		# Important
		ai_estimate_without_unemployment = yes

		icon = building_production_center

		category = manufacturing

		prerequisites = {
			"tech_global_production_strategy"
		}

		show_tech_unlock_if = {
			is_gestalt = no
			tec_is_scifi_empire = no
			tec_is_cyberpunk_empire = no
			tec_is_solarpunk_empire = no
		}

		potential = {
			exists = owner
			owner = {
				is_gestalt = no
				tec_is_scifi_empire = no
				tec_is_cyberpunk_empire = no
				tec_is_solarpunk_empire = no
			}
			tec_planet_blocks_manufacturing_buildings = no
			OR = {
				tec_ai_destroy_factory_building = no
				tec_ai_destroy_foundry_building = no
			}
		}

		allow = {
			has_major_upgraded_capital = yes
			tec_ai_allow_rare_dependant_building = {
				tier = 2
				rare = volatile_motes
			}
		}

		convert_to = {
			building_ministry_production
			building_production_center
			#building_tec_scifi_industrial_booster_1
			#building_tec_solarpunk_industrial_booster_1
			#building_tec_cyberpunk_industrial_booster_1
			building_tec_biohive_industrial_booster_1
			#building_tec_lithohive_industrial_booster_1
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 2
				rare = volatile_motes
			}
		}

		planet_modifier = {
			planet_metallurgists_produces_mult = 0.15
			planet_artisans_produces_mult = 0.15
		}

		inline_script = {
			script = jobs/tec_politician
			count = 1
			mult = value:tec_centrality_final_1_mult
			display = with_desc
			trigger = ""
			default_job = politician
			default_trigger = "is_gestalt = yes"
		}

		inline_script = buildings/effects/type/tec_ministry_production

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				check_variable_arithmetic = {
					which = value:industrial_districts_value
					value >= 3
				}
			"
		}
	}
	# Gestalt
	building_production_center = {
		base_buildtime = @b2_time
		base_cap_amount = 1
		position_priority = 11		# Important
		ai_estimate_without_unemployment = yes

		category = manufacturing

		prerequisites = {
			"tech_global_production_strategy"
		}

		show_tech_unlock_if = {
			is_gestalt = yes
			tec_is_biohive = no
		}

		potential = {
			exists = owner
			owner = {
				is_gestalt = yes
				tec_is_biohive = no
			}
			tec_planet_blocks_manufacturing_buildings = no
			OR = {
				tec_ai_destroy_factory_building = no
				tec_ai_destroy_foundry_building = no
			}
		}

		allow = {
			has_major_upgraded_capital = yes
			tec_ai_allow_rare_dependant_building = {
				tier = 2
				rare = volatile_motes
			}
		}

		convert_to = {
			building_ministry_production
			building_production_center
			#building_tec_scifi_industrial_booster_1
			#building_tec_solarpunk_industrial_booster_1
			#building_tec_cyberpunk_industrial_booster_1
			building_tec_biohive_industrial_booster_1
			#building_tec_lithohive_industrial_booster_1
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 2
				rare = volatile_motes
			}
		}

		planet_modifier = {
			planet_metallurgists_produces_mult = 0.15
			planet_artisans_produces_mult = 0.15
		}

		inline_script = {
			script = jobs/tec_foundry
			count = 2
			mult = value:tec_centrality_final_1_mult
			display = with_desc
			trigger = ""
			default_job = foundry
		}

		inline_script = {
			script = jobs/tec_artisan
			count = 2
			mult = value:tec_centrality_final_1_mult
			display = with_desc
			trigger = "
				owner = {
					country_uses_consumer_goods = yes
				}
			"
		}

		inline_script = buildings/effects/type/tec_ministry_production

		ai_resource_production = {
			alloys = 6
			trigger = {
				planet_resource_compare = {
					resource = alloys
					value >= 40
					type = produces
				}
			}
		}
		ai_resource_production = {
			consumer_goods = 8
			trigger = {
				owner = { country_uses_consumer_goods = yes }
				planet_resource_compare = {
					resource = consumer_goods
					value >= 50
					type = produces
				}
			}
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				check_variable_arithmetic = {
					which = value:industrial_districts_value
					value >= 3
				}
			"
		}
	}
	# Scifi
	#building_tec_scifi_industrial_booster_1
	# Solarpunk
	#building_tec_solarpunk_industrial_booster_1
	# Cyberpunk
	#building_tec_cyberpunk_industrial_booster_1
	# Biohive
	building_tec_biohive_industrial_booster_1 = {
		base_buildtime = @b2_time
		base_cap_amount = 1
		position_priority = 11		# Important
		ai_estimate_without_unemployment = yes
		icon = building_production_center		#BIOHIVE ART PLACEHOLDER!!!!

		category = manufacturing

		prerequisites = {
			"tech_global_production_strategy"
		}

		show_tech_unlock_if = {
			is_gestalt = yes
			tec_is_biohive = yes
		}

		potential = {
			exists = owner
			owner = {
				is_gestalt = yes
				tec_is_biohive = yes
			}
			tec_planet_blocks_manufacturing_buildings = no
			OR = {
				tec_ai_destroy_factory_building = no
				tec_ai_destroy_foundry_building = no
			}
		}

		allow = {
			has_major_upgraded_capital = yes
			tec_ai_allow_rare_dependant_building = {
				tier = 2
				rare = volatile_motes
			}
		}

		convert_to = {
			building_ministry_production
			building_production_center
			#building_tec_scifi_industrial_booster_1
			#building_tec_solarpunk_industrial_booster_1
			#building_tec_cyberpunk_industrial_booster_1
			building_tec_biohive_industrial_booster_1
			#building_tec_lithohive_industrial_booster_1
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 2
				rare = volatile_motes
			}
		}

		planet_modifier = {
			planet_metallurgists_produces_mult = 0.15
			planet_artisans_produces_mult = 0.15
		}

		inline_script = {
			script = jobs/tec_foundry
			count = 2
			mult = value:tec_centrality_final_1_mult
			display = with_desc
			trigger = ""
			default_job = foundry
		}

		inline_script = {
			script = jobs/tec_artisan
			count = 2
			mult = value:tec_centrality_final_1_mult
			display = with_desc
			trigger = "
				owner = {
					country_uses_consumer_goods = yes
				}
			"
		}

		inline_script = buildings/effects/type/tec_ministry_production

		ai_resource_production = {
			alloys = 6
			trigger = {
				planet_resource_compare = {
					resource = alloys
					value >= 40
					type = produces
				}
			}
		}
		ai_resource_production = {
			consumer_goods = 8
			trigger = {
				owner = { country_uses_consumer_goods = yes }
				planet_resource_compare = {
					resource = consumer_goods
					value >= 50
					type = produces
				}
			}
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				check_variable_arithmetic = {
					which = value:industrial_districts_value
					value >= 3
				}
			"
		}
	}
	# Lithohive
	#building_tec_lithohive_industrial_booster
 # /
 # Rare resources
	# Regular
	building_tec_strategic_optimizator = {
		icon = building_tec_strategic_optimizator
		base_buildtime = @b3_time	
		base_cap_amount = 1
		position_priority = 12		# Important
		ai_estimate_without_unemployment = yes

		category = manufacturing
		
		prerequisites = {
			"tech_tec_strategic_optimization"
		}

		show_tech_unlock_if = {
			tec_is_scifi_empire = no
			tec_is_solarpunk_empire = no
			tec_is_cyberpunk_empire = no
			tec_is_biohive = no
		}

		potential = {
			always = no
			exists = owner
			owner = {
				tec_is_scifi_empire = no
				tec_is_solarpunk_empire = no
				tec_is_cyberpunk_empire = no
				tec_is_biohive = no
			}
			tec_planet_blocks_manufacturing_buildings = no
			tec_ai_destroy_refinery_boosting_building = no
		}

		allow = {
			has_major_upgraded_capital = yes
		}

		convert_to = {
			building_tec_strategic_optimizator
			#building_tec_scifi_strategic_booster_1
			#building_tec_solarpunk_strategic_booster_1
			#building_tec_cyberpunk_strategic_booster_1
			building_tec_biohive_strategic_booster_1
			#building_tec_lithohive_strategic_booster_1
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 3
			}
		}

		planet_modifier = {
			planet_refiners_upkeep_mult = -0.25
			planet_translucers_upkeep_mult = -0.25
			planet_chemists_upkeep_mult = -0.25
			planet_sr_miners_produces_mult = 0.25
		}

		inline_script = {
			script = jobs/tec_politician
			count = 1
			mult = value:tec_centrality_final_1_mult
			display = with_desc
			trigger = ""
			default_job = politician
		}

		inline_script = {
			script = jobs/tec_synapse
			count = 1
			mult = value:tec_centrality_final_1_mult
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/tec_coordinator
			count = 1
			mult = value:tec_centrality_final_1_mult
			display = with_desc
			trigger = ""
		}

		inline_script = buildings/effects/type/tec_strategic_optimizer
		
		ai_resource_production = {
			trigger = { always = yes }
			volatile_motes = 1
		}
		ai_resource_production = {
			trigger = { always = yes }
			exotic_gases = 1
		}
		ai_resource_production = {
			trigger = { always = yes }
			rare_crystals = 1
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				check_variable_arithmetic = {
					which = value:refinery_combined_value|CACHED|yes|
					value >= 3
				}
			"
		}
	}
	# Scifi
	#building_tec_scifi_industrial_booster_1
	# Solarpunk
	#building_tec_solarpunk_industrial_booster_1
	# Cyberpunk
	#building_tec_cyberpunk_industrial_booster_1
	# Biohive
	building_tec_biohive_strategic_booster_1 = {
		base_buildtime = @b3_time	
		base_cap_amount = 1
		position_priority = 12		# Important
		ai_estimate_without_unemployment = yes
		icon = building_tec_strategic_optimizator		#BIOHIVE ART PLACEHOLDER!!!!

		category = manufacturing
		
		prerequisites = {
			"tech_tec_strategic_optimization"
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}

		potential = {
			always = no
			exists = owner
			owner = {
				tec_is_biohive = yes
			}
			tec_planet_blocks_manufacturing_buildings = no
			tec_ai_destroy_refinery_boosting_building = no
		}

		allow = {
			has_major_upgraded_capital = yes
		}

		convert_to = {
			building_tec_strategic_optimizator
			#building_tec_scifi_strategic_booster_1
			#building_tec_solarpunk_strategic_booster_1
			#building_tec_cyberpunk_strategic_booster_1
			building_tec_biohive_strategic_booster_1
			#building_tec_lithohive_strategic_booster_1
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 3
			}
		}

		planet_modifier = {
			planet_refiners_upkeep_mult = -0.15
			planet_translucers_upkeep_mult = -0.15
			planet_chemists_upkeep_mult = -0.15
			planet_sr_miners_produces_mult = 0.10
		}

		inline_script = {
			script = jobs/tec_synapse
			count = 1
			mult = value:tec_centrality_final_1_mult
			display = with_desc
			trigger = ""
			default_job = synapse_drone
			default_trigger = "is_hive_empire = no"
		}

		inline_script = buildings/effects/type/tec_strategic_optimizer

		ai_resource_production = {
			trigger = { always = yes }
			volatile_motes = 1
		}
		ai_resource_production = {
			trigger = { always = yes }
			exotic_gases = 1
		}
		ai_resource_production = {
			trigger = { always = yes }
			rare_crystals = 1
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				check_variable_arithmetic = {
					which = value:refinery_combined_value|CACHED|yes|
					value >= 3
				}
			"
		}
	}
	# Lithohive
	#building_tec_lithohive_strategic_booster_1
 # /
 # Archaeo
	# Regular
	building_archaeo_refinery = {
		base_buildtime = @b3_time
		base_cap_amount = 1
		ai_estimate_without_unemployment = yes

		category = manufacturing

		prerequisites = {
			"tech_archaeo_refinery"
		}

		potential = {
			owner = { has_technology = tech_archaeo_refinery }
			tec_planet_blocks_manufacturing_buildings = no
		}

		allow = {
			OR = {
				tec_ai_allow_refinery_building = {
					resource = volatile_motes
				}
				tec_ai_allow_refinery_building = {
					resource = rare_crystals
				}
				tec_ai_allow_refinery_building = {
					resource = exotic_gases
				}
			}
			tec_ai_allow_artifacts_dependant_building = yes
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
			cost = {
				minor_artifacts = @b2_rare_cost
			}
		}
		
		planet_modifier = {
			planet_jobs_exotic_gases_produces_mult = 0.25
			planet_jobs_rare_crystals_produces_mult = 0.25
			planet_jobs_volatile_motes_produces_mult = 0.25
		}

		triggered_planet_modifier = {
			potential = {
				owner = {
					has_ascension_perk = ap_archaeoengineers
				}
			}
			planet_jobs_exotic_gases_produces_mult = 0.15
			planet_jobs_rare_crystals_produces_mult = 0.15
			planet_jobs_volatile_motes_produces_mult = 0.15
		}

		inline_script = {
			script = jobs/tec_chemist
			count = 1
			mult = 1
			display = with_desc
			trigger = ""
			default_job = chemist
		}
		inline_script = {
			script = jobs/tec_gas_refiner
			count = 1
			mult = 1
			display = with_desc
			trigger = ""
			default_job = gas_refiner
		}
		inline_script = {
			script = jobs/tec_translucer
			count = 1
			mult = 1
			display = with_desc
			trigger = ""
			default_job = translucer
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				check_variable_arithmetic = {
					which = value:refinery_combined_value|CACHED|yes|
					value >= 3
				}
			"
		}
	}
 # /
 # Unleashed Industrial
	# Regular
	building_coordinated_fulfillment_center_1 = {
		base_buildtime = @b1_time
		base_cap_amount = 1
		position_priority = 11		# Important
		ai_estimate_without_unemployment = yes

		category = manufacturing

		triggered_desc = {
			trigger = {
				NOR = {
					tec_is_nuked_world = yes
					tec_is_city_world = yes
					tec_is_space_arcology = yes
					is_ringworld = yes
					is_artificial = yes
				}
			}
			text = building_coordinated_fulfillment_center_tooltip
		}

		prerequisites = {
			tech_basic_industry
		}

		show_tech_unlock_if = {
			is_relentless_industrialist_empire = yes
		}

		upgrades = {
			building_coordinated_fulfillment_center_2
		}

		potential = {
			exists = owner
			owner = { is_relentless_industrialist_empire = yes }

			tec_planet_blocks_manufacturing_buildings = no

			OR = {
				tec_ai_destroy_factory_building = no
				tec_ai_destroy_foundry_building = no
			}
		}

		
		allow = {
			has_upgraded_capital = yes
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 1
			}
			upkeep = {
				unity = 10
				trigger = {
					owner = { has_policy_flag = relentless_industrialists_cleanup }
				}
			}
		}

		
		planet_modifier = {
			planet_metallurgists_produces_mult = 0.2
			planet_artisans_produces_mult = 0.2
		}

		triggered_planet_modifier = {
			potential = {
				owner = { has_policy_flag = relentless_industrialists_full_steam_ahead }
			}
			modifier = {
				planet_metallurgists_produces_mult = 0.1
				planet_artisans_produces_mult = 0.1
			}
		}

		triggered_planet_modifier = {
			potential = {
				owner = { is_synthetic_empire = no }
			}
			modifier = {
				pop_growth_speed_reduction = 0.15
			}
		}

		triggered_planet_modifier = {
			potential = {
				owner = {
					is_synthetic_empire = no
					NAND = {
						has_policy_flag = relentless_industrialists_study
						has_country_flag = relentless_industrialists_study_completed
					}
				}
			}
			modifier = {
				pop_growth_speed_reduction = 0.05
			}
		}

		triggered_planet_modifier = {
			potential = {
				owner = { is_synthetic_empire = yes }
			}
			modifier = {
				habitability_ceil_add = -0.075
			}
		}

		triggered_planet_modifier = {
			potential = {
				owner = {
					owner = { is_synthetic_empire = yes }
					NAND = {
						has_policy_flag = relentless_industrialists_study
						has_country_flag = relentless_industrialists_study_completed
					}
				}
			}
			modifier = {
				habitability_ceil_add = -0.025
			}
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				check_variable_arithmetic = {
					which = value:industrial_districts_value
					value >= 3
				}
			"
		}
	}
	building_coordinated_fulfillment_center_2 = {
		base_buildtime = @b2_time
		can_build = no
		position_priority = 11		# Important
		ai_estimate_without_unemployment = yes

		category = manufacturing

		prerequisites = {
			tech_global_production_strategy
		}

		show_tech_unlock_if = {
			is_relentless_industrialist_empire = yes
		}

		triggered_desc = {
			trigger = {
				NOR = {
					tec_is_nuked_world = yes
					tec_is_city_world = yes
					tec_is_space_arcology = yes
					is_ringworld = yes
					is_artificial = yes
				}
			}
			text = building_coordinated_fulfillment_center_tooltip
		}

		potential = {
			exists = owner
			owner = { is_relentless_industrialist_empire = yes }

			tec_planet_blocks_manufacturing_buildings = no
			OR = {
				tec_ai_destroy_factory_building = no
				tec_ai_destroy_foundry_building = no
			}
		}

		allow = {
			has_major_upgraded_capital = yes
			tec_ai_allow_rare_dependant_building = {
				tier = 3
				rare = volatile_motes
			}
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 3
				rare = volatile_motes
			}
			upkeep = {
				unity = 20
				trigger = {
					owner = { has_policy_flag = relentless_industrialists_cleanup }
				}
			}
		}

		planet_modifier = {
			planet_metallurgists_produces_mult = 0.4
			planet_artisans_produces_mult = 0.4
		}

		triggered_planet_modifier = {
			potential = {
				owner = { has_policy_flag = relentless_industrialists_full_steam_ahead }
			}
			modifier = {
				planet_metallurgists_produces_mult = 0.2
				planet_artisans_produces_mult = 0.2
			}
		}

		triggered_planet_modifier = {
			potential = {
				owner = { is_synthetic_empire = no }
			}
			modifier = {
				pop_growth_speed_reduction = 0.25
			}
		}

		triggered_planet_modifier = {
			potential = {
				owner = {
					is_synthetic_empire = no
					NAND = {
						has_policy_flag = relentless_industrialists_study
						has_country_flag = relentless_industrialists_study_completed
					}
				}
			}
			modifier = {
				pop_growth_speed_reduction = 0.15
			}
		}

		triggered_planet_modifier = {
			potential = {
				owner = { is_synthetic_empire = yes }
			}
			modifier = {
				habitability_ceil_add = -0.1
			}
		}

		triggered_planet_modifier = {
			potential = {
				owner = {
					owner = { is_synthetic_empire = yes }
					NAND = {
						has_policy_flag = relentless_industrialists_study
						has_country_flag = relentless_industrialists_study_completed
					}
				}
			}
			modifier = {
				habitability_ceil_add = -0.05
			}
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = ""
		}
	}
 # /
# /

# ALLOY FORGES
# -----------------------------------------
# Foundries
 # Regular
	building_foundry_1 = {
		base_buildtime = @b1_time
		base_cap_amount = 1
		position_priority = 10		# Important
		ai_estimate_without_unemployment = yes

		category = manufacturing

		prerequisites = {
			tech_basic_industry
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
			tec_is_scifi_empire = no
			tec_is_solarpunk_empire = no
			tec_is_cyberpunk_empire = no
		}

		upgrades = {
			building_foundry_2
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
				tec_is_scifi_empire = no
				tec_is_solarpunk_empire = no
				tec_is_cyberpunk_empire = no
			}

			tec_planet_blocks_manufacturing_buildings = no
			tec_ai_destroy_foundry_building = no
		}

		allow = {
			if = {
				limit = { 
					owner = {
						is_ai = yes
					}
				}
				has_factory_designation = no
			}
		}

		convert_to = {
			#building_foundry_1
			#building_tec_scifi_foundry_1
			#building_tec_solarpunk_foundry_1
			#building_tec_cyberpunk_foundry_1
			building_tec_biohive_foundry_1
			#building_tec_lithohive_foundry_1
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 1
			}
		}

		inline_script = {
			script = jobs/tec_foundry
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = ""
			default_job = foundry
		}

		inline_script = {
			script = buildings/effects/type/tec_foundry
			tier = 1
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				check_variable_arithmetic = {
					which = value:industrial_districts_value|ALLOY_ONLY|yes|
					value >= 2
				}
			"
		}
	}
	building_foundry_2 = {
		base_buildtime = @b2_time
		can_build = no
		position_priority = 10		# Important
		ai_estimate_without_unemployment = yes
		category = manufacturing

		prerequisites = {
			tech_alloys_1
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
			tec_is_scifi_empire = no
			tec_is_solarpunk_empire = no
			tec_is_cyberpunk_empire = no
		}

		upgrades = {
			building_foundry_3
		}
		
		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
				tec_is_scifi_empire = no
				tec_is_solarpunk_empire = no
				tec_is_cyberpunk_empire = no
			}

			tec_planet_blocks_manufacturing_buildings = no
			tec_ai_destroy_foundry_building = no
		}

		allow = {
			has_upgraded_capital = yes
			tec_ai_allow_rare_dependant_building = {
				tier = 3
				rare = volatile_motes
			}
		}

		convert_to = {
			#building_foundry_2
			#building_tec_scifi_foundry_2
			#building_tec_solarpunk_foundry_2
			#building_tec_cyberpunk_foundry_2
			building_tec_biohive_foundry_2
			#building_tec_lithohive_foundry_2
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 3
				rare = volatile_motes
			}
		}
		
		inline_script = {
			script = modifiers/tec_foundry_efficiency
			count = 1
			mult = 1
			trigger = ""
			key = building_tec_manufacturing_building_foundry_tag
		}

		inline_script = {
			script = jobs/tec_foundry
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = ""
			default_job = foundry
		}

		inline_script = {
			script = buildings/effects/type/tec_foundry
			tier = 2
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = ""
		}
	}
	building_foundry_3 = {
		base_buildtime = @b3_time
		can_build = no
		position_priority = 10		# Important
		ai_estimate_without_unemployment = yes

		category = manufacturing

		prerequisites = {
			tech_alloys_2
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
			tec_is_scifi_empire = no
			tec_is_solarpunk_empire = no
			tec_is_cyberpunk_empire = no
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
				tec_is_scifi_empire = no
				tec_is_solarpunk_empire = no
				tec_is_cyberpunk_empire = no
			}

			tec_planet_blocks_manufacturing_buildings = no
			tec_ai_destroy_foundry_building = no
		}

		allow = {
			has_major_upgraded_capital = yes
			tec_ai_allow_exotic_dependant_building = {
				exotic = sr_living_metal
			}
		}

		convert_to = {
			#building_foundry_3
			#building_tec_scifi_foundry_3
			#building_tec_solarpunk_foundry_3
			#building_tec_cyberpunk_foundry_3
			building_tec_biohive_foundry_3
			#building_tec_lithohive_foundry_3
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 3
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 4
				rare = volatile_motes
			}

			inline_script = {
				script = buildings/resources/tec_ring_production_cost
				rare = volatile_motes
				type = industry
			}

			inline_script = {
				script = buildings/resources/tec_exotic_resource_cost
				exotic = sr_living_metal
			}
		}
		
		inline_script = {
			script = modifiers/tec_foundry_efficiency
			count = 2
			mult = 1
			trigger = ""
		}

		inline_script = {
			script = modifiers/tec_foundry_efficiency
			count = 2
			mult = 1
			trigger = "has_ringworld_output_boost = yes"
			default = no
		}

		inline_script = {
			script = jobs/tec_foundry
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = ""
			default_job = foundry
		}

		inline_script = {
			script = buildings/effects/type/tec_foundry
			tier = 3
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = ""
		}
	}
 # /
 # Scifi
	#building_tec_scifi_foundry_1
	#building_tec_scifi_foundry_2
	#building_tec_scifi_foundry_3
 # /
 # Solarpunk
	#building_tec_solarpunk_foundry_1
	#building_tec_solarpunk_foundry_2
	#building_tec_solarpunk_foundry_3
 # /
 # Cyberpunk
	#building_tec_cyberpunk_foundry_1
	#building_tec_cyberpunk_foundry_2
	#building_tec_cyberpunk_foundry_3
 # /
 # Biohive
	building_tec_biohive_foundry_1 = {
		base_buildtime = @b1_time
		base_cap_amount = 1
		position_priority = 10		# Important
		ai_estimate_without_unemployment = yes
		icon = building_foundry_1		#BIOHIVE ART PLACEHOLDER!!!!

		category = manufacturing

		prerequisites = {
			tech_basic_industry
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}

		upgrades = {
			building_tec_biohive_foundry_2
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = yes
			}

			tec_planet_blocks_manufacturing_buildings = no
			tec_ai_destroy_foundry_building = no
		}

		allow = {
			if = {
				limit = { 
					owner = {
						is_ai = yes
					}
				}
				has_factory_designation = no
			}
		}

		convert_to = {
			building_foundry_1
			#building_tec_scifi_foundry_1
			#building_tec_solarpunk_foundry_1
			#building_tec_cyberpunk_foundry_1
			building_tec_biohive_foundry_1
			#building_tec_lithohive_foundry_1
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 1
			}
		}

		inline_script = {
			script = jobs/tec_foundry
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = ""
			default_job = alloy_drone
		}

		inline_script = {
			script = buildings/effects/type/tec_foundry
			tier = 1
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				check_variable_arithmetic = {
					which = value:industrial_districts_value|ALLOY_ONLY|yes|
					value >= 2
				}
			"
		}
	}
	building_tec_biohive_foundry_2 = {
		base_buildtime = @b2_time
		can_build = no
		position_priority = 10		# Important
		ai_estimate_without_unemployment = yes
		category = manufacturing
		icon = building_foundry_2		#BIOHIVE ART PLACEHOLDER!!!!

		prerequisites = {
			tech_alloys_1
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}

		upgrades = {
			building_tec_biohive_foundry_3
		}
		
		potential = {
			exists = owner
			owner = {
				tec_is_biohive = yes
			}

			tec_planet_blocks_manufacturing_buildings = no
			tec_ai_destroy_foundry_building = no
		}

		allow = {
			has_upgraded_capital = yes
			tec_ai_allow_rare_dependant_building = {
				tier = 3
				rare = volatile_motes
			}
		}

		convert_to = {
			building_foundry_2
			#building_tec_scifi_foundry_2
			#building_tec_solarpunk_foundry_2
			#building_tec_cyberpunk_foundry_2
			building_tec_biohive_foundry_2
			#building_tec_lithohive_foundry_2
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 3
				rare = volatile_motes
			}
		}
		
		inline_script = {
			script = modifiers/tec_foundry_efficiency
			count = 1
			mult = 1
			trigger = ""
		}

		inline_script = {
			script = jobs/tec_foundry
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = ""
			default_job = alloy_drone
		}

		inline_script = {
			script = buildings/effects/type/tec_foundry
			tier = 2
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = ""
		}
	}
	building_tec_biohive_foundry_3 = {
		base_buildtime = @b3_time
		can_build = no
		position_priority = 10		# Important
		ai_estimate_without_unemployment = yes
		icon = building_foundry_3		#BIOHIVE ART PLACEHOLDER!!!!

		category = manufacturing

		prerequisites = {
			tech_alloys_2
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = yes
			}

			tec_planet_blocks_manufacturing_buildings = no
			tec_ai_destroy_foundry_building = no
		}

		allow = {
			has_major_upgraded_capital = yes
			tec_ai_allow_exotic_dependant_building = {
				exotic = sr_living_metal
			}
		}

		convert_to = {
			building_foundry_3
			#building_tec_scifi_foundry_3
			#building_tec_solarpunk_foundry_3
			#building_tec_cyberpunk_foundry_3
			building_tec_biohive_foundry_3
			#building_tec_lithohive_foundry_3
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 3
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 4
				rare = volatile_motes
			}

			inline_script = {
				script = buildings/resources/tec_ring_production_cost
				rare = volatile_motes
				type = industry
			}

			inline_script = {
				script = buildings/resources/tec_exotic_resource_cost
				exotic = sr_living_metal
			}
		}
		
		inline_script = {
			script = modifiers/tec_foundry_efficiency
			count = 2
			mult = 1
			trigger = ""
		}

		inline_script = {
			script = modifiers/tec_foundry_efficiency
			count = 2
			mult = 1
			trigger = "has_ringworld_output_boost = yes"
			default = no
		}

		inline_script = {
			script = jobs/tec_foundry
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = ""
			default_job = alloy_drone
		}

		inline_script = {
			script = buildings/effects/type/tec_foundry
			tier = 3
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = ""
		}
	}
 # /
 # Lithohive
	#building_tec_lithohive_foundry_1
	#building_tec_lithohive_foundry_2
	#building_tec_lithohive_foundry_3
 # /
# /

# CG FACTORIES
# -----------------------------------------
# Factories
 # Regular
	building_factory_1 = {
		base_buildtime = @b1_time
		base_cap_amount = 1
		position_priority = 10		# Important
		ai_estimate_without_unemployment = yes

		category = manufacturing

		prerequisites = {
			tech_basic_industry
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
			tec_is_scifi_empire = no
			tec_is_solarpunk_empire = no
			tec_is_cyberpunk_empire = no
		}

		upgrades = {
			building_factory_2
		}

		potential = {
			exists = owner
			owner = {
				OR = {
					country_uses_consumer_goods = yes
					has_origin = origin_fear_of_the_dark
				}
				tec_is_biohive = no
				tec_is_scifi_empire = no
				tec_is_solarpunk_empire = no
				tec_is_cyberpunk_empire = no
			}

			tec_planet_blocks_manufacturing_buildings = no
			tec_ai_destroy_factory_building = no
		}

		allow = {
			if = {
				limit = { 
					owner = {
						is_ai = yes
					}
				}
				has_foundry_designation = no
			}
		}

		convert_to = {
			#building_factory_1
			#building_tec_scifi_factory_1
			#building_tec_solarpunk_factory_1
			#building_tec_cyberpunk_factory_1
			building_tec_biohive_factory_1
			#building_tec_lithohive_factory_1
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 1
			}
		}

		inline_script = {
			script = jobs/tec_artisan
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = ""
			default_job = artisan
		}

		inline_script = {
			script = buildings/effects/type/tec_factory
			tier = 1
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				check_variable_arithmetic = {
					which = value:industrial_districts_value|CG_ONLY|yes|
					value >= 4
				}
			"
		}
	}
	building_factory_2 = {
		base_buildtime = @b2_time
		can_build = no
		position_priority = 10		# Important
		ai_estimate_without_unemployment = yes

		category = manufacturing

		prerequisites = {
			tech_luxuries_1
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
			tec_is_scifi_empire = no
			tec_is_solarpunk_empire = no
			tec_is_cyberpunk_empire = no
		}

		upgrades = {
			building_factory_3
		}

		potential = {
			exists = owner
			owner = {
				OR = {
					country_uses_consumer_goods = yes
					has_origin = origin_fear_of_the_dark
				}
				tec_is_biohive = no
				tec_is_scifi_empire = no
				tec_is_solarpunk_empire = no
				tec_is_cyberpunk_empire = no
			}

			tec_planet_blocks_manufacturing_buildings = no
			tec_ai_destroy_factory_building = no
		}

		allow = {
			has_upgraded_capital = yes
			tec_ai_allow_rare_dependant_building = {
				tier = 3
				rare = rare_crystals
			}
		}

		convert_to = {
			#building_factory_2
			#building_tec_scifi_factory_2
			#building_tec_solarpunk_factory_2
			#building_tec_cyberpunk_factory_2
			building_tec_biohive_factory_2
			#building_tec_lithohive_factory_2
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 3
				rare = rare_crystals
			}
		}

		inline_script = {
			script = modifiers/tec_artisan_efficiency
			count = 1
			mult = 1
			trigger = ""
		}

		inline_script = {
			script = jobs/tec_artisan
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = ""
			default_job = artisan
		}

		inline_script = {
			script = buildings/effects/type/tec_factory
			tier = 2
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = ""
		}
	}
	building_factory_3 = {
		base_buildtime = @b3_time
		can_build = no
		position_priority = 10		# Important
		ai_estimate_without_unemployment = yes

		category = manufacturing

		prerequisites = {
			tech_luxuries_2
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
			tec_is_scifi_empire = no
			tec_is_solarpunk_empire = no
			tec_is_cyberpunk_empire = no
		}

		potential = {
			exists = owner
			owner = {
				OR = {
					country_uses_consumer_goods = yes
					has_origin = origin_fear_of_the_dark
				}
				tec_is_biohive = no
				tec_is_scifi_empire = no
				tec_is_solarpunk_empire = no
				tec_is_cyberpunk_empire = no
			}

			tec_planet_blocks_manufacturing_buildings = no
			tec_ai_destroy_factory_building = no
		}

		allow = {
			has_major_upgraded_capital = yes
			tec_ai_allow_exotic_dependant_building = {
				exotic = sr_living_metal
			}
		}

		convert_to = {
			#building_factory_3
			#building_tec_scifi_factory_3
			#building_tec_solarpunk_factory_3
			#building_tec_cyberpunk_factory_3
			building_tec_biohive_factory_3
			#building_tec_lithohive_factory_3
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 3
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 4
				rare = rare_crystals
			}

			inline_script = {
				script = buildings/resources/tec_ring_production_cost
				rare = rare_crystals
				type = industry
			}

			inline_script = {
				script = buildings/resources/tec_exotic_resource_cost
				exotic = sr_living_metal
			}
		}

		inline_script = {
			script = modifiers/tec_artisan_efficiency
			count = 2
			mult = 1
			trigger = ""
		}

		inline_script = {
			script = jobs/tec_artisan
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = ""
			default_job = artisan
		}

		inline_script = {
			script = modifiers/tec_artisan_efficiency
			count = 1
			mult = 1
			trigger = "has_ringworld_output_boost = yes"
			default = no
		}

		inline_script = {
			script = buildings/effects/type/tec_factory
			tier = 3
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = ""
		}
	}
 # /
 # Scifi
	#building_tec_scifi_factory_1
	#building_tec_scifi_factory_2
	#building_tec_scifi_factory_3
 # /
 # Solarpunk
	#building_tec_solarpunk_factory_1
	#building_tec_solarpunk_factory_2
	#building_tec_solarpunk_factory_3
 # /
 # Cyberpunk
	#building_tec_cyberpunk_factory_1
	#building_tec_cyberpunk_factory_2
	#building_tec_cyberpunk_factory_3
 # /
 # Biohive
	building_tec_biohive_factory_1 = {
		base_buildtime = @b1_time
		base_cap_amount = 1
		position_priority = 10		# Important
		ai_estimate_without_unemployment = yes
		icon = building_factory_1		#BIOHIVE ART PLACEHOLDER!!!!

		category = manufacturing

		prerequisites = {
			tech_basic_industry
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}

		upgrades = {
			building_tec_biohive_factory_2
		}

		potential = {
			exists = owner
			owner = {
				OR = {
					country_uses_consumer_goods = yes
					has_origin = origin_fear_of_the_dark
				}
				tec_is_biohive = yes
			}
			tec_planet_blocks_manufacturing_buildings = no
			tec_ai_destroy_factory_building = no
		}

		allow = {
			if = {
				limit = { 
					owner = {
						is_ai = yes
					}
				}
				has_foundry_designation = no
			}
		}

		convert_to = {
			building_factory_1
			#building_tec_scifi_factory_1
			#building_tec_solarpunk_factory_1
			#building_tec_cyberpunk_factory_1
			building_tec_biohive_factory_1
			#building_tec_lithohive_factory_1
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 1
			}
		}

		inline_script = {
			script = jobs/tec_artisan
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = ""
			default_job = artisan_drone
		}

		inline_script = {
			script = buildings/effects/type/tec_factory
			tier = 1
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				check_variable_arithmetic = {
					which = value:industrial_districts_value|CG_ONLY|yes|
					value >= 4
				}
			"
		}
	}
	building_tec_biohive_factory_2 = {
		base_buildtime = @b2_time
		can_build = no
		position_priority = 10		# Important
		ai_estimate_without_unemployment = yes
		icon = building_factory_2		#BIOHIVE ART PLACEHOLDER!!!!

		category = manufacturing

		prerequisites = {
			tech_luxuries_1
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}

		upgrades = {
			building_tec_biohive_factory_3
		}

		potential = {
			exists = owner
			owner = {
				OR = {
					country_uses_consumer_goods = yes
					has_origin = origin_fear_of_the_dark
				}
				tec_is_biohive = yes
			}
			tec_planet_blocks_manufacturing_buildings = no
			tec_ai_destroy_factory_building = no
		}

		allow = {
			has_upgraded_capital = yes
			tec_ai_allow_rare_dependant_building = {
				tier = 3
				rare = rare_crystals
			}
		}

		convert_to = {
			building_factory_2
			#building_tec_scifi_factory_2
			#building_tec_solarpunk_factory_2
			#building_tec_cyberpunk_factory_2
			building_tec_biohive_factory_2
			#building_tec_lithohive_factory_2
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 3
				rare = rare_crystals
			}
		}

		inline_script = {
			script = modifiers/tec_artisan_efficiency
			count = 1
			mult = 1
			trigger = ""
		}

		inline_script = {
			script = jobs/tec_artisan
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = ""
			default_job = artisan_drone
		}

		inline_script = {
			script = buildings/effects/type/tec_factory
			tier = 2
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = ""
		}
	}
	building_tec_biohive_factory_3 = {
		base_buildtime = @b3_time
		can_build = no
		position_priority = 10		# Important
		ai_estimate_without_unemployment = yes
		icon = building_factory_3		#BIOHIVE ART PLACEHOLDER!!!!

		category = manufacturing

		prerequisites = {
			tech_luxuries_2
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}

		potential = {
			exists = owner
			owner = {
				OR = {
					country_uses_consumer_goods = yes
					has_origin = origin_fear_of_the_dark
				}
				tec_is_biohive = yes
			}
			tec_planet_blocks_manufacturing_buildings = no
			tec_ai_destroy_factory_building = no
		}

		allow = {
			has_major_upgraded_capital = yes
			tec_ai_allow_exotic_dependant_building = {
				exotic = sr_living_metal
			}
		}

		convert_to = {
			building_factory_3
			#building_tec_scifi_factory_3
			#building_tec_solarpunk_factory_3
			#building_tec_cyberpunk_factory_3
			building_tec_biohive_factory_3
			#building_tec_lithohive_factory_3
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 3
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 4
				rare = rare_crystals
			}

			inline_script = {
				script = buildings/resources/tec_ring_production_cost
				rare = rare_crystals
				type = industry
			}

			inline_script = {
				script = buildings/resources/tec_exotic_resource_cost
				exotic = sr_living_metal
			}
		}

		inline_script = {
			script = modifiers/tec_artisan_efficiency
			count = 2
			mult = 1
			trigger = ""
		}

		inline_script = {
			script = jobs/tec_artisan
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = ""
			default_job = artisan_drone
		}

		inline_script = {
			script = modifiers/tec_artisan_efficiency
			count = 1
			mult = 1
			trigger = "has_ringworld_output_boost = yes"
			default = no
		}

		inline_script = {
			script = buildings/effects/type/tec_factory
			tier = 3
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = ""
		}
	}
 # /
 # Lithohive
	#building_tec_lithohive_factory_1
	#building_tec_lithohive_factory_2
	#building_tec_lithohive_factory_3
 # /
# /

# Empathy building
	building_tec_empathic_factory_1 = {
		base_buildtime = @b2_time
		base_cap_amount = 1
		position_priority = 10		# Important

		category = manufacturing

		prerequisites = {
			tech_tec_gestalt_friendship
		}

		#upgrades = {
		#	building_tec_empathic_factory_2
		#}

		show_tech_unlock_if = {
			always = no
		}

		potential = {
			always = no
			exists = owner
			owner = {
				has_ethic = ethic_gestalt_empathy
			}
			tec_planet_blocks_manufacturing_buildings = no
			AND = {
				owner = {
					is_ai = yes
					num_owned_planets > 1
				}
				is_capital = no
			}
		}

		destroy_trigger = {
			OR = {
				OR = {
					has_modifier = resort_colony
					has_modifier = slave_colony
				}
				AND = {
					owner = {
						is_ai = yes
						num_owned_planets > 1
					}
					is_capital = yes
				}
			}
		}

		resources = {
			category = planet_buildings
			cost = {
				minerals = @b2_minerals
			}
			upkeep = {
				energy = @b2_upkeep
			}
			cost = {
				trigger = {
					owner = { tec_is_bioarch_empire = yes }
				}
				minerals = @b2_minus_minerals
				food = @b2_half_minerals
			}
			upkeep = {
				trigger = {
					owner = { tec_is_bioarch_empire = yes }
				}
				energy = @b2_minus_upkeep
				food = @b2_half_upkeep
			}
			cost = {
				trigger = {
					owner = { has_valid_civic = civic_tec_machine_digitalization }
				}
				minerals = @b2_minus_minerals
				energy = @b2_half_minerals
			}
		}

		# Normal
			triggered_planet_modifier = {
				potential = {
					exists = owner
					owner = {
						is_hive_empire = yes
						is_catalytic_empire = no
					}
					OR = {
						uses_district_set = standard
						uses_district_set = habitat
					}
				}
				modifier = {
					job_artisan_drone_add = 1
					job_alloy_drone_add = -1
				}
				mult = value:tec_industrial_district_count
			}

			triggered_planet_modifier = {
				potential = {
					exists = owner
					owner = {
						is_machine_empire = yes
						is_catalytic_empire = no
					}
					uses_district_set = ring_world
				}
				modifier = {
					job_artisan_drone_add = 1
					job_fabricator_add = -1
				}
				mult = value:tec_industrial_district_count
			}
			triggered_planet_modifier = {
				potential = {
					exists = owner
					owner = {
						is_gestalt = yes
						is_catalytic_empire = yes
					}
					uses_district_set = ring_world
				}
				modifier = {
					job_artisan_drone_add = 1
					job_catalytic_drone_add = -1
				}
				mult = value:tec_industrial_district_count
			}
		# /

		triggered_desc = {
			trigger = {
				exists = owner
				owner = { is_gestalt = yes }
			}
			text = job_artisan_drone_effect_desc
		}
	}
# /

# STRATEGIC RESOURCES
# -----------------------------------------
# Motes
 # Regular
	building_chemical_plant = {
		base_buildtime = @b2_time
		position_priority = 200		# Deposit

		exempt_from_ai_planet_specialization = no
		category = manufacturing

		prerequisites = {
			"tech_volatile_motes"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}

		upgrades = {
			building_chemical_plant_2
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			tec_planet_blocks_manufacturing_buildings = no
		}

		allow = {
			tec_ai_allow_refinery_building = {
				resource = volatile_motes
			}
		}

		convert_to = {
			building_chemical_plant
			building_tec_biohive_chemical_plant_1
			#building_tec_lithohive_chemical_plant_1
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
		}

		inline_script = {
			script = jobs/tec_chemist
			count = 1
			mult = 1
			display = with_desc
			trigger = ""
			default_job = chemist
		}

		inline_script = {
			script = buildings/effects/type/tec_chemical_plant
			tier = 1
		}

		ai_resource_production = {
			volatile_motes = 1
			trigger = {
				always = yes
			}
		}
	}
	building_chemical_plant_2 = {
		base_buildtime = @b3_time
		can_build = no
		position_priority = 200		# Deposit

		category = manufacturing

		prerequisites = {
			"tech_volatile_motes_2"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}

		upgrades = {
			building_chemical_plant_3
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			tec_planet_blocks_manufacturing_buildings = no
		}

		convert_to = {
			building_chemical_plant_2
			building_tec_biohive_chemical_plant_2
			#building_tec_lithohive_chemical_plant_2
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 3
			}
		}

		inline_script = {
			script = jobs/tec_chemist
			count = 2
			mult = 1
			display = with_desc
			trigger = ""
			default_job = chemist
		}

		inline_script = {
			script = buildings/effects/type/tec_chemical_plant
			tier = 2
		}
		
		inline_script = {
			script = buildings/tec_aibait
			trigger = ""
		}
	}
	building_chemical_plant_3 = {
		base_buildtime = @b4_time
		can_build = no
		position_priority = 200		# Deposit

		category = manufacturing

		prerequisites = {
			"tech_volatile_motes_3"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			tec_planet_blocks_manufacturing_buildings = no
		}

		convert_to = {
			building_chemical_plant_3
			building_tec_biohive_chemical_plant_3
			#building_tec_lithohive_chemical_plant_3
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 4
			}
			inline_script = {
				script = buildings/resources/tec_exotic_resource_cost
				exotic = nanites
			}
		}

		allow = {
			tec_ai_allow_exotic_dependant_building = {
				exotic = nanites
			}
		}

		inline_script = {
			script = jobs/tec_chemist
			count = 3
			mult = 1
			display = with_desc
			trigger = ""
			default_job = chemist
		}

		inline_script = {
			script = buildings/effects/type/tec_chemical_plant
			tier = 3
		}
	}
 # /
 # Biohive
	building_tec_biohive_chemical_plant_1 = {
		base_buildtime = @b2_time
		position_priority = 200		# Deposit

		exempt_from_ai_planet_specialization = no
		category = manufacturing
		icon = building_chemical_plant		#BIOHIVE ART PLACEHOLDER!!!!

		prerequisites = {
			"tech_volatile_motes"
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}

		upgrades = {
			building_tec_biohive_chemical_plant_2
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = yes
			}
			tec_planet_blocks_manufacturing_buildings = no
		}

		allow = {
			tec_ai_allow_refinery_building = {
				resource = volatile_motes
			}
		}

		convert_to = {
			building_chemical_plant
			building_tec_biohive_chemical_plant_1
			#building_tec_lithohive_chemical_plant_1
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
		}

		inline_script = {
			script = jobs/tec_chemist
			count = 1
			mult = 1
			display = with_desc
			trigger = ""
			default_job = chemist_drone
		}

		inline_script = {
			script = buildings/effects/type/tec_chemical_plant
			tier = 1
		}

		ai_resource_production = {
			volatile_motes = 1
			trigger = {
				always = yes
			}
		}
	}
	building_tec_biohive_chemical_plant_2 = {
		base_buildtime = @b3_time
		can_build = no
		position_priority = 200		# Deposit
		icon = building_chemical_plant_2		#BIOHIVE ART PLACEHOLDER!!!!

		category = manufacturing

		prerequisites = {
			"tech_volatile_motes_2"
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}

		upgrades = {
			building_tec_biohive_chemical_plant_3
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = yes
			}
			tec_planet_blocks_manufacturing_buildings = no
		}

		convert_to = {
			building_chemical_plant_2
			building_tec_biohive_chemical_plant_2
			#building_tec_lithohive_chemical_plant_2
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 3
			}
		}

		inline_script = {
			script = jobs/tec_chemist
			count = 2
			mult = 1
			display = with_desc
			trigger = ""
			default_job = chemist_drone
		}

		inline_script = {
			script = buildings/effects/type/tec_chemical_plant
			tier = 2
		}
		
		inline_script = {
			script = buildings/tec_aibait
			trigger = ""
		}
	}
	building_tec_biohive_chemical_plant_3 = {
		base_buildtime = @b4_time
		can_build = no
		position_priority = 200		# Deposit
		icon = building_chemical_plant_3		#BIOHIVE ART PLACEHOLDER!!!!

		category = manufacturing

		prerequisites = {
			"tech_volatile_motes_3"
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = yes
			}
			tec_planet_blocks_manufacturing_buildings = no
		}

		convert_to = {
			building_chemical_plant_3
			building_tec_biohive_chemical_plant_3
			#building_tec_lithohive_chemical_plant_3
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 4
			}
			inline_script = {
				script = buildings/resources/tec_exotic_resource_cost
				exotic = nanites
			}
		}

		allow = {
			tec_ai_allow_exotic_dependant_building = {
				exotic = nanites
			}
		}

		inline_script = {
			script = jobs/tec_chemist
			count = 3
			mult = 1
			display = with_desc
			trigger = ""
			default_job = chemist_drone
		}

		inline_script = {
			script = buildings/effects/type/tec_chemical_plant
			tier = 3
		}
	}
 # /
 # Lithohive
	#building_tec_lithohive_chemical_plant_1
	#building_tec_lithohive_chemical_plant_2
	#building_tec_lithohive_chemical_plant_3
 # /
# /

# Gases
 # Regular
	building_refinery = {
		base_buildtime = @b2_time
		position_priority = 200		# Deposit

		exempt_from_ai_planet_specialization = no
		category = manufacturing
		
		upgrades = {
			building_refinery_2
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}
		
		prerequisites = {
			"tech_exotic_gases"
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			tec_planet_blocks_manufacturing_buildings = no
		}

		allow = {
			tec_ai_allow_refinery_building = {
				resource = exotic_gases
			}
		}

		convert_to = {
			building_refinery
			building_tec_biohive_refinery_1
			#building_tec_lithohive_refinery_1
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
		}

		inline_script = {
			script = jobs/tec_gas_refiner
			count = 1
			mult = 1
			display = with_desc
			trigger = ""
			default_job = gas_refiner
		}

		inline_script = {
			script = buildings/effects/type/tec_refinery
			tier = 1
		}
	}
	building_refinery_2 = {
		base_buildtime = @b3_time
		can_build = no
		position_priority = 200		# Deposit
			
		category = manufacturing
		
		
		upgrades = {
			building_refinery_3
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}
		
		prerequisites = {
			"tech_exotic_gases_2"
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			tec_planet_blocks_manufacturing_buildings = no
		}

		convert_to = {
			building_refinery_2
			building_tec_biohive_refinery_2
			#building_tec_lithohive_refinery_2
		}
		
		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 3
			}
		}

		inline_script = {
			script = jobs/tec_gas_refiner
			count = 2
			mult = 1
			display = with_desc
			trigger = ""
			default_job = gas_refiner
		}

		inline_script = {
			script = buildings/effects/type/tec_refinery
			tier = 2
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = ""
		}
	}
	building_refinery_3 = {
		base_buildtime = @b4_time
		can_build = no
		position_priority = 200		# Deposit
		
		category = manufacturing
		
		prerequisites = {
			"tech_exotic_gases_3"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			tec_planet_blocks_manufacturing_buildings = no
		}

		convert_to = {
			building_refinery_3
			building_tec_biohive_refinery_3
			#building_tec_lithohive_refinery_3
		}
		
		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 4
			}
			inline_script = {
				script = buildings/resources/tec_exotic_resource_cost
				exotic = nanites
			}
		}

		allow = {
			tec_ai_allow_exotic_dependant_building = {
				exotic = nanites
			}
		}

		inline_script = {
			script = jobs/tec_gas_refiner
			count = 3
			mult = 1
			display = with_desc
			trigger = ""
			default_job = gas_refiner
		}

		inline_script = {
			script = buildings/effects/type/tec_refinery
			tier = 3
		}
	}
 # /
 # Biohive
	building_tec_biohive_refinery_1 = {
		base_buildtime = @b2_time
		position_priority = 200		# Deposit
		icon = building_refinery		#BIOHIVE ART PLACEHOLDER!!!!

		exempt_from_ai_planet_specialization = no
		category = manufacturing
		
		upgrades = {
			building_tec_biohive_refinery_2
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}
		
		prerequisites = {
			"tech_exotic_gases"
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = yes
			}
			tec_planet_blocks_manufacturing_buildings = no
		}

		allow = {
			tec_ai_allow_refinery_building = {
				resource = exotic_gases
			}
		}

		convert_to = {
			building_refinery
			building_tec_biohive_refinery_1
			#building_tec_lithohive_refinery_1
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
		}

		inline_script = {
			script = jobs/tec_gas_refiner
			count = 1
			mult = 1
			display = with_desc
			trigger = ""
			default_job = gas_refiner_drone
		}

		inline_script = {
			script = buildings/effects/type/tec_refinery
			tier = 1
		}
	}
	building_tec_biohive_refinery_2 = {
		base_buildtime = @b3_time
		can_build = no
		position_priority = 200		# Deposit
		icon = building_refinery_2		#BIOHIVE ART PLACEHOLDER!!!!
			
		category = manufacturing
		
		
		upgrades = {
			building_tec_biohive_refinery_3
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}
		
		prerequisites = {
			"tech_exotic_gases_2"
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = yes
			}
			tec_planet_blocks_manufacturing_buildings = no
		}

		convert_to = {
			building_refinery_2
			building_tec_biohive_refinery_2
			#building_tec_lithohive_refinery_2
		}
		
		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 3
			}
		}

		inline_script = {
			script = jobs/tec_gas_refiner
			count = 2
			mult = 1
			display = with_desc
			trigger = ""
			default_job = gas_refiner_drone
		}

		inline_script = {
			script = buildings/effects/type/tec_refinery
			tier = 2
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = ""
		}
	}
	building_tec_biohive_refinery_3 = {
		base_buildtime = @b4_time
		can_build = no
		position_priority = 200		# Deposit
		icon = building_refinery_3		#BIOHIVE ART PLACEHOLDER!!!!
		
		category = manufacturing
		
		prerequisites = {
			"tech_exotic_gases_3"
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = yes
			}
			tec_planet_blocks_manufacturing_buildings = no
		}

		convert_to = {
			building_refinery_3
			building_tec_biohive_refinery_3
			#building_tec_lithohive_refinery_3
		}
		
		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 4
			}
			inline_script = {
				script = buildings/resources/tec_exotic_resource_cost
				exotic = nanites
			}
		}

		allow = {
			tec_ai_allow_exotic_dependant_building = {
				exotic = nanites
			}
		}

		inline_script = {
			script = jobs/tec_gas_refiner
			count = 3
			mult = 1
			display = with_desc
			trigger = ""
			default_job = gas_refiner_drone
		}

		inline_script = {
			script = buildings/effects/type/tec_refinery
			tier = 3
		}
	}
 # /
 # Lithohive
	#building_tec_lithohive_refinery_1
	#building_tec_lithohive_refinery_2
	#building_tec_lithohive_refinery_3
 # /
# /

# Crystals
 # Regular
	building_crystal_plant = {
		icon = building_crystal_plant_1
		base_buildtime = @b2_time
		position_priority = 200		# Deposit

		exempt_from_ai_planet_specialization = no
		category = manufacturing

		prerequisites = {
			"tech_rare_crystals"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}

		upgrades = {
			building_crystal_plant_2
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			tec_planet_blocks_manufacturing_buildings = no
		}

		convert_to = {
			building_crystal_plant
			building_tec_biohive_crystal_plant_1
			#building_tec_lithohive_crystal_plant_1
		}

		allow = {
			tec_ai_allow_refinery_building = {
				resource = rare_crystals
			}
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
		}

		inline_script = {
			script = jobs/tec_translucer
			count = 1
			mult = 1
			display = with_desc
			trigger = ""
			default_job = translucer
		}

		inline_script = {
			script = buildings/effects/type/tec_refinery
			tier = 1
		}

		ai_resource_production = {
			rare_crystals = 1
			trigger = {
				always = yes
			}
		}
	}
	building_crystal_plant_2 = {
		icon = building_crystal_plant_2
		base_buildtime = @b3_time
		can_build = no
		position_priority = 200		# Deposit

		category = manufacturing

		prerequisites = {
			"tech_rare_crystals_2"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}

		upgrades = {
			building_crystal_plant_3
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			tec_planet_blocks_manufacturing_buildings = no
		}

		convert_to = {
			building_crystal_plant_2
			building_tec_biohive_crystal_plant_2
			#building_tec_lithohive_crystal_plant_2
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 3
			}
		}

		inline_script = {
			script = jobs/tec_translucer
			count = 2
			mult = 1
			display = with_desc
			trigger = ""
			default_job = translucer
		}

		inline_script = {
			script = buildings/effects/type/tec_refinery
			tier = 2
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = ""
		}
	}
	building_crystal_plant_3 = {
		icon = building_crystal_plant_3
		base_buildtime = @b4_time
		can_build = no
		position_priority = 200		# Deposit

		category = manufacturing

		prerequisites = {
			"tech_rare_crystals_3"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
			}
			tec_planet_blocks_manufacturing_buildings = no
		}

		convert_to = {
			building_crystal_plant_3
			building_tec_biohive_crystal_plant_3
			#building_tec_lithohive_crystal_plant_3
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 4
			}
			inline_script = {
				script = buildings/resources/tec_exotic_resource_cost
				exotic = nanites
			}
		}

		allow = {
			tec_ai_allow_exotic_dependant_building = {
				exotic = nanites
			}
		}

		inline_script = {
			script = jobs/tec_translucer
			count = 3
			mult = 1
			display = with_desc
			trigger = ""
			default_job = translucer
		}

		inline_script = {
			script = buildings/effects/type/tec_refinery
			tier = 3
		}
	}
 # /
 # Biohive
	building_tec_biohive_crystal_plant_1 = {
		base_buildtime = @b2_time
		position_priority = 200		# Deposit
		icon = building_crystal_plant		#BIOHIVE ART PLACEHOLDER!!!!

		exempt_from_ai_planet_specialization = no
		category = manufacturing

		prerequisites = {
			"tech_rare_crystals"
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}

		upgrades = {
			building_tec_biohive_crystal_plant_2
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = yes
			}
			tec_planet_blocks_manufacturing_buildings = no
		}

		convert_to = {
			building_crystal_plant
			building_tec_biohive_crystal_plant_1
			#building_tec_lithohive_crystal_plant_1
		}

		allow = {
			tec_ai_allow_refinery_building = {
				resource = rare_crystals
			}
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
		}

		inline_script = {
			script = jobs/tec_translucer
			count = 1
			mult = 1
			display = with_desc
			trigger = ""
			default_job = translucer_drone
		}

		inline_script = {
			script = buildings/effects/type/tec_refinery
			tier = 1
		}

		ai_resource_production = {
			rare_crystals = 1
			trigger = {
				always = yes
			}
		}
	}
	building_tec_biohive_crystal_plant_2 = {
		base_buildtime = @b3_time
		can_build = no
		position_priority = 200		# Deposit
		icon = building_crystal_plant_2		#BIOHIVE ART PLACEHOLDER!!!!

		category = manufacturing

		prerequisites = {
			"tech_rare_crystals_2"
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}

		upgrades = {
			building_tec_biohive_crystal_plant_3
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = yes
			}
			tec_planet_blocks_manufacturing_buildings = no
		}

		convert_to = {
			building_crystal_plant_2
			building_tec_biohive_crystal_plant_2
			#building_tec_lithohive_crystal_plant_2
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 3
			}
		}

		inline_script = {
			script = jobs/tec_translucer
			count = 2
			mult = 1
			display = with_desc
			trigger = ""
			default_job = translucer_drone
		}

		inline_script = {
			script = buildings/effects/type/tec_refinery
			tier = 2
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = ""
		}
	}
	building_tec_biohive_crystal_plant_3 = {
		base_buildtime = @b4_time
		can_build = no
		position_priority = 200		# Deposit
		icon = building_crystal_plant_3		#BIOHIVE ART PLACEHOLDER!!!!

		category = manufacturing

		prerequisites = {
			"tech_rare_crystals_3"
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = yes
			}
			tec_planet_blocks_manufacturing_buildings = no
		}

		convert_to = {
			building_crystal_plant_3
			building_tec_biohive_crystal_plant_3
			#building_tec_lithohive_crystal_plant_3
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 4
			}
			inline_script = {
				script = buildings/resources/tec_exotic_resource_cost
				exotic = nanites
			}
		}

		allow = {
			tec_ai_allow_exotic_dependant_building = {
				exotic = nanites
			}
		}

		inline_script = {
			script = jobs/tec_translucer
			count = 3
			mult = 1
			display = with_desc
			trigger = ""
			default_job = translucer_drone
		}

		inline_script = {
			script = buildings/effects/type/tec_refinery
			tier = 3
		}
	}
 # /
 # Lithohive
	#building_tec_lithohive_crystal_plant_1
	#building_tec_lithohive_crystal_plant_2
	#building_tec_lithohive_crystal_plant_3
 # /
# /

# Will touch this in the future, non 
# functional atm
# ------------- NANITES -----------------
	building_nanite_transmuter = {
		base_buildtime = @b3_time
		icon = building_tec_nanite
		category = manufacturing
		base_cap_amount = 1

		potential = {
			always = no
			exists = owner
			#		NOT = {
			#			has_global_flag = resolution_prohibited_nanites
			#		}
			has_global_flag = resolution_allow_nanite_studies
			OWNER = {
				OR = {
					OR = {
						has_policy_flag = nanites_into_resources
						has_monthly_income = {
							resource = nanites
							value > 0
						}
						AND = {
							is_ai = no
							has_resource = {
								type = nanites
								amount > 0
							}
						}
					}
					OR = {
						has_policy_flag = resources_into_nanites
						has_monthly_income = {
							resource = volatile_motes
							value > 0
						}
						has_monthly_income = {
							resource = exotic_gases
							value > 0
						}
						has_monthly_income = {
							resource = rare_crystals
							value > 0
						}
						AND = {
							is_ai = no
						}
					}

				}
			}
			NOR = {
				has_modifier = resort_colony
				has_modifier = slave_colony
			}
		}

		upgrades = {
			"building_advanced_nanite_transmuter"
		}

		allow = {
			has_upgraded_capital = yes
		}

		resources = {
			category = planet_buildings
			cost = {
				minerals = @b3_minerals
			}
			produces = {
				trigger = {
					owner = {
						has_policy_flag = nanites_into_resources
						NOT = {
							has_deficit = nanites
						}
					}
				}
				rare_crystals = 1
				volatile_motes = 1
				exotic_gases = 1
				nanites = -1
			}
			produces = {
				trigger = {
					owner = {
						has_policy_flag = resources_into_nanites
						NOR = {
							has_deficit = volatile_motes
							has_deficit = rare_crystals
							has_deficit = exotic_gases
						}
					}
				}
				rare_crystals = -1
				volatile_motes = -1
				exotic_gases = -1
				nanites = 1
			}
			upkeep = {
				energy = 5
			}
		}

		triggered_planet_modifier = {
			potential = {
				exists = owner
				owner = {
					NOT = {
						has_ethic = ethic_gestalt_consciousness
					}
					has_policy_flag = nanites_usage
				}
			}
			#terraform_speed_mult = 0.15
			planet_building_build_speed_mult = 0.15
			planet_pop_assembly_mult = 0.15
			job_tec_nanite_researcher_add = 1
		}

		triggered_planet_modifier = {
			potential = {
				exists = owner
				owner = {
					has_ethic = ethic_gestalt_consciousness
					has_policy_flag = nanites_usage
				}
			}
			#terraform_speed_mult = 0.15
			planet_building_build_speed_mult = 0.15
			planet_pop_assembly_mult = 0.15
			job_tec_nanite_researcher_drone_add = 1
		}

		
		triggered_planet_modifier = {
			potential = {
				exists = owner
				owner = {
					has_policy_flag = nanites_into_resources
				}
			}
			planet_jobs_productive_upkeep_mult = -0.05
		}

		triggered_desc = {
			trigger = {
				owner = {
					NOT = {
						has_ethic = ethic_gestalt_consciousness
					}
					has_policy_flag = nanites_usage
				}
			}
			text = job_tec_nanite_researcher_effect_desc
		}

		triggered_desc = {
			trigger = {
				owner = {
					has_ethic = ethic_gestalt_consciousness
					has_policy_flag = nanites_usage
				}
			}
			text = job_tec_nanite_researcher_drone_effect_desc
		}

		prerequisites = {
			"tech_nanite_transmutation"
		}

		ai_weight = {
			weight = 0
			modifier = {
				weight = 10
				buildings_build_building = yes
				owner = {
					OR = {
						has_policy_flag = nanites_into_resources
						has_monthly_income = {
							resource = nanites
							value > 0
						}
						AND = {
							has_resource = {
								type = nanites
								amount > 5
							}
						}
					}
					OR = {
						has_policy_flag = resources_into_nanites
						has_monthly_income = {
							resource = volatile_motes
							value > 0
						}
						has_monthly_income = {
							resource = exotic_gases
							value > 0
						}
						has_monthly_income = {
							resource = rare_crystals
							value > 0
						}
					}
					
				}
			} #Nothing else uses the monthly income but new starships. As such the only important check is the number of nanites coming into the country.
		}

		ai_resource_production = {
			rare_crystals = @b3_rare_upkeep
			volatile_motes = @b3_rare_upkeep
			exotic_gases = @b3_rare_upkeep
			nanites = 1
			trigger = {
				always = yes
			}
		}
	}
	building_advanced_nanite_transmuter = {
		base_buildtime = @b3_time
		icon = building_tec_nanite_2
		category = manufacturing
		can_build = no
		base_cap_amount = 1

		potential = {
			always = no
			exists = owner
			#NOT = {
			#	has_global_flag = resolution_prohibited_nanites
			#}
			has_global_flag = resolution_allow_nanite_studies
			OWNER = {
				OR = {
					OR = {
						has_policy_flag = nanites_into_resources
						has_monthly_income = {
							resource = nanites
							value > 0
						}
						AND = {
							is_ai = no
							has_resource = {
								type = nanites
								amount > 0
							}
						}
					}
					OR = {
						has_policy_flag = resources_into_nanites
						has_monthly_income = {
							resource = volatile_motes
							value > 0
						}
						has_monthly_income = {
							resource = exotic_gases
							value > 0
						}
						has_monthly_income = {
							resource = rare_crystals
							value > 0
						}
						AND = {
							is_ai = no
						}
					}

				}
			}
			NOR = {
				has_modifier = resort_colony
				has_modifier = slave_colony
			}
		}

		allow = {
			has_upgraded_capital = yes
		}

		resources = {
			category = planet_buildings
			cost = {
				minerals = @b3_minerals
			}
			produces = {
				trigger = {
					owner = {
						has_policy_flag = nanites_into_resources
						NOT = {
							has_deficit = nanites
						}
					}
				}
				rare_crystals = 2
				volatile_motes = 2
				exotic_gases = 2
				nanites = -2
			}
			produces = {
				trigger = {
					owner = {
						has_policy_flag = resources_into_nanites
						NOR = {
							has_deficit = volatile_motes
							has_deficit = rare_crystals
							has_deficit = exotic_gases
						}
					}
				}
				rare_crystals = -2
				volatile_motes = -2
				exotic_gases = -2
				nanites = 2
			}
			upkeep = {
				energy = 10
			}
		}

		triggered_planet_modifier = {
			potential = {
				exists = owner
				owner = {
					NOT = {
						has_ethic = ethic_gestalt_consciousness
					}
					has_policy_flag = nanites_usage
				}
			}
			#terraform_speed_mult = 0.25
			planet_building_build_speed_mult = 0.25
			planet_pop_assembly_mult = 0.25
			job_tec_nanite_researcher_add = 2
		}

		triggered_planet_modifier = {
			potential = {
				exists = owner
				owner = {
					has_ethic = ethic_gestalt_consciousness
					has_policy_flag = nanites_usage
				}
			}
			#terraform_speed_mult = 0.25
			planet_building_build_speed_mult = 0.25
			planet_pop_assembly_mult = 0.25
			job_tec_nanite_researcher_drone_add = 2
		}

		
		triggered_planet_modifier = {
			potential = {
				exists = owner
				owner = {
					has_policy_flag = nanites_into_resources
				}
			}
			planet_jobs_productive_upkeep_mult = -0.1
		}

		prerequisites = {
			#"tech_nanite_uses"
		}

		on_built = {
			planet = { set_planet_flag = nanites_light }
		}

		on_destroy = {
			planet = {
				if = {
					limit = {
						NOT = {
							has_building = building_advanced_nanite_transmuter
							}
						}
					remove_planet_flag = nanites_light 
					}

				}
		}

		ai_weight = {
			weight = 0
			modifier = {
				weight = 10
				buildings_build_building = yes
				owner = {
					OR = {
						has_policy_flag = nanites_into_resources
						has_monthly_income = {
							resource = nanites
							value > 1
						}
						AND = {
							has_resource = {
								type = nanites
								amount > 5
							}
						}
					}
					OR = {
						has_policy_flag = resources_into_nanites
						has_monthly_income = {
							resource = volatile_motes
							value > 1
						}
						has_monthly_income = {
							resource = exotic_gases
							value > 1
						}
						has_monthly_income = {
							resource = rare_crystals
							value > 1
						}
					}
					
				}
			} #Nothing else uses the monthly income but new starships. As such the only important check is the number of nanites coming into the country.
		}

		ai_resource_production = {
			rare_crystals = @b3_rare_upkeep
			volatile_motes = @b3_rare_upkeep
			exotic_gases = @b3_rare_upkeep
			nanites = 1
			trigger = {
				always = yes
			}
		}
	}
	building_advanced_nanite_transmuter_2 = {
		base_buildtime = @b3_time
		icon = building_tec_nanite_3
		category = manufacturing
		can_build = no
		base_cap_amount = 1

		potential = {
			always = no
			exists = owner
			#		NOT = {
			#			has_global_flag = resolution_prohibited_nanites
			#		}
			has_global_flag = resolution_allow_nanite_studies
			OWNER = {
				OR = {
					OR = {
						has_policy_flag = nanites_into_resources
						has_monthly_income = {
							resource = nanites
							value > 0
						}
						AND = {
							is_ai = no
							has_resource = {
								type = nanites
								amount > 0
							}
						}
					}
					OR = {
						has_policy_flag = resources_into_nanites
						has_monthly_income = {
							resource = volatile_motes
							value > 0
						}
						has_monthly_income = {
							resource = exotic_gases
							value > 0
						}
						has_monthly_income = {
							resource = rare_crystals
							value > 0
						}
						AND = {
							is_ai = no
						}
					}

				}
			}
			NOR = {
				has_modifier = resort_colony
				has_modifier = slave_colony
			}
		}

		allow = {
			has_upgraded_capital = yes
		}

		resources = {
			category = planet_buildings
			cost = {
				minerals = @b3_minerals
			}
			produces = {
				trigger = {
					owner = {
						has_policy_flag = nanites_into_resources
						NOT = {
							has_deficit = nanites
						}
					}
				}
				rare_crystals = 3
				volatile_motes = 3
				exotic_gases = 3
				nanites = -3
			}
			produces = {
				trigger = {
					owner = {
						has_policy_flag = resources_into_nanites
						NOR = {
							has_deficit = volatile_motes
							has_deficit = rare_crystals
							has_deficit = exotic_gases
						}
					}
				}
				rare_crystals = -3
				volatile_motes = -3
				exotic_gases = -3
				nanites = 3
			}
			upkeep = {
				energy = 15
			}
		}

		triggered_planet_modifier = {
			potential = {
				exists = owner
				owner = {
					NOT = {
						has_ethic = ethic_gestalt_consciousness
					}
					has_policy_flag = nanites_usage
				}
			}
			#terraform_speed_mult = 0.5
			planet_building_build_speed_mult = 0.5
			planet_pop_assembly_mult = 0.5
			job_tec_nanite_researcher_add = 3
		}

		triggered_planet_modifier = {
			potential = {
				exists = owner
				owner = {
					has_ethic = ethic_gestalt_consciousness
					has_policy_flag = nanites_usage
				}
			}
			#terraform_speed_mult = 0.5
			planet_building_build_speed_mult = 0.5
			planet_pop_assembly_mult = 0.5
			job_tec_nanite_researcher_drone_add = 3
		}

		
		triggered_planet_modifier = {
			potential = {
				exists = owner
				owner = {
					has_policy_flag = nanites_into_resources
				}
			}
			planet_jobs_productive_upkeep_mult = -0.15
		}

		prerequisites = {
			#"tech_nanite_advanced_uses"
		}

		on_built = {
			planet = {
				set_planet_flag = nanites_moderate 
				if = {
					limit = {
						NOT = {
							has_building = building_advanced_nanite_transmuter
							}
						}
					remove_planet_flag = nanites_light
					}

			}
			
		}

		on_destroy = {
			planet = {
				if = {
					limit = {
						NOT = {
							has_building = building_advanced_nanite_transmuter_2
							}
						}
					remove_planet_flag = nanites_moderate 
					}
				}
		}

		ai_weight = {
			weight = 0
			modifier = {
				weight = 10
				buildings_build_building = yes
				owner = {
					OR = {
						has_policy_flag = nanites_into_resources
						has_monthly_income = {
							resource = nanites
							value > 3
						}
						AND = {
							has_resource = {
								type = nanites
								amount > 5
							}
						}
					}
					OR = {
						has_policy_flag = resources_into_nanites
						has_monthly_income = {
							resource = volatile_motes
							value > 2
						}
						has_monthly_income = {
							resource = exotic_gases
							value > 2
						}
						has_monthly_income = {
							resource = rare_crystals
							value > 2
						}
					}
					
				}
			} #Nothing else uses the monthly income but new starships. As such the only important check is the number of nanites coming into the country.
		}

		ai_resource_production = {
			rare_crystals = @b3_rare_upkeep
			volatile_motes = @b3_rare_upkeep
			exotic_gases = @b3_rare_upkeep
			nanites = 1
			trigger = {
				always = yes
			}
		}
	}
# /