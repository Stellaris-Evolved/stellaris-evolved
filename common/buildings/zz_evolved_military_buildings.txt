# -----------------------------------------
# ARMY BUILDINGS
# -----------------------------------------

# ACADEMIES
# -----------------------------------------
 # Ministry
	# Regular
	building_military_academy = {
		icon = building_military_academy_unique
		base_buildtime = @b2_time
		base_cap_amount = 1
		empire_limit = {
			base = 1
		}
		can_be_ruined = no
		position_priority = 30		# Unique
		ai_estimate_without_unemployment = yes

		category = army

		prerequisites = {
			"tech_centralized_command"
		}
		
		show_tech_unlock_if = {
			is_gestalt = no
		}

		potential = {
			exists = owner
			owner = {
				is_gestalt = no
			}
			NOT = { has_modifier = resort_colony }
		}

		allow = {
			OR = {
				has_major_upgraded_capital = yes
				AND = {
					exists = owner
					owner = {
						has_valid_civic = civic_machine_tactical_algorithms
					}
				}
			}
		}

		convert_to = {
			building_military_academy
			building_tec_gestalt_military_academy
			building_tec_biohive_military_academy
			#building_tec_lithohive_military_academy
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}

			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 2
				rare = volatile_motes
			}
		}

		country_modifier = {
			country_commander_cap_add = 1
			country_naval_cap_mult = 0.05
		}
		# ADD per Ascension
			triggered_country_modifier = {
				potential = {
					always = yes
				}
				country_commander_cap_add = 1
				mult = planet.value:tec_script_add_per_ascension|BASE|0|ASCENSION_BASE|0|ASCENSION_MULT|@tec_per_planet_ascension_mult_very_low|MULT|1|ROUND|yes|
			}
			triggered_desc = {
				trigger = {
					always = yes
				}
				text = tec_building_ascension_scaling_leader_commander
			}
		# /

		inline_script = {
			script = jobs/tec_naval_operator
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = "" 
		}
	}
	# Gestalt
	building_tec_gestalt_military_academy = {
		icon = building_military_academy_unique
		base_buildtime = @b2_time
		base_cap_amount = 1
		empire_limit = {
			base = 1
		}
		can_be_ruined = no
		position_priority = 30		# Unique
		ai_estimate_without_unemployment = yes

		category = army

		prerequisites = {
			"tech_centralized_command"
		}
		
		show_tech_unlock_if = {
			is_gestalt = yes
			tec_is_biohive = no
		}

		potential = {
			exists = owner
			owner = {
				is_gestalt = yes
				tec_is_biohive = no
			}
		}

		allow = {
			OR = {
				has_major_upgraded_capital = yes
				AND = {
					exists = owner
					owner = {
						has_valid_civic = civic_machine_tactical_algorithms
					}
				}
			}
		}

		convert_to = {
			building_military_academy
			building_tec_gestalt_military_academy
			building_tec_biohive_military_academy
			#building_tec_lithohive_military_academy
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}

			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = "
					exists = owner
					owner = {
						has_valid_civic = civic_machine_tactical_algorithms
					}
				"
				tier = 2
				rare = volatile_motes
			}
		}

		country_modifier = {
			country_commander_cap_add = 1
			country_naval_cap_mult = 0.05
		}
		# ADD per Ascension
			triggered_country_modifier = {
				potential = {
					always = yes
				}
				country_commander_cap_add = 1
				mult = planet.value:tec_script_add_per_ascension|BASE|0|ASCENSION_BASE|0|ASCENSION_MULT|@tec_per_planet_ascension_mult_very_low|MULT|1|ROUND|yes|
			}
			triggered_desc = {
				trigger = {
					always = yes
				}
				text = tec_building_ascension_scaling_leader_commander
			}
		# /

		# Machine tactical algorythms
			triggered_country_modifier = {
				potential = {
					exists = owner
					owner = {
						has_valid_civic = civic_machine_tactical_algorithms
					}
				}
				ship_evasion_mult = 0.02
				ship_tracking_mult = 0.01
				ship_shield_penetration_add = 0.05
				ship_armor_penetration_add = 0.05
				mult = owner.value:tactical_algorithms_scaling_mult
			}
			triggered_country_modifier = {
				potential = {
					exists = owner
					owner = {
						has_valid_civic = civic_machine_tactical_algorithms
					}
				}
				ship_shield_hardening_add = 0.1
				mult = owner.value:tactical_algorithms_enclave_scaling_mult
			}
		# /

		inline_script = {
			script = jobs/tec_naval_operator
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = "" 
		}
	}
	# Biohive
	building_tec_biohive_military_academy = {
		icon = building_military_academy_unique
		#BIOHIVE ART PLACEHOLDER!!!!
		base_buildtime = @b2_time
		base_cap_amount = 1
		empire_limit = {
			base = 1
		}
		can_be_ruined = no
		position_priority = 30		# Unique
		ai_estimate_without_unemployment = yes

		category = army

		prerequisites = {
			"tech_centralized_command"
		}
		
		show_tech_unlock_if = {
			tec_is_biohive = yes
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = yes
			}
		}

		allow = {
			has_major_upgraded_capital = yes
		}

		convert_to = {
			building_military_academy
			building_tec_gestalt_military_academy
			building_tec_biohive_military_academy
			#building_tec_lithohive_military_academy
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}

			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 2
				rare = volatile_motes
			}
		}

		country_modifier = {
			country_commander_cap_add = 1
			country_naval_cap_mult = 0.05
		}
		# ADD per Ascension
			triggered_country_modifier = {
				potential = {
					always = yes
				}
				country_commander_cap_add = 1
				mult = planet.value:tec_script_add_per_ascension|BASE|0|ASCENSION_BASE|0|ASCENSION_MULT|@tec_per_planet_ascension_mult_very_low|MULT|1|ROUND|yes|
			}
			triggered_desc = {
				trigger = {
					always = yes
				}
				text = tec_building_ascension_scaling_leader_commander
			}
		# /

		inline_script = {
			script = jobs/tec_naval_operator
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = "" 
		}
	}
	# Lithohive
	#building_tec_lithohive_military
 # /
 # Booster
 	# Regular
	building_tec_regular_military_booster_1 = {
		icon = building_military_academy
		base_buildtime = @b2_time
		base_cap_amount = 1
		can_be_ruined = no
		position_priority = 35		# Unique Secondary
		ai_estimate_without_unemployment = yes

		category = army

		prerequisites = {
			"tech_centralized_command"
		}
		
		show_tech_unlock_if = {
			tec_is_reanimator_empire = no
			tec_is_biohive = no
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = no
				tec_is_reanimator_empire = no
			}
			tec_ai_destroy_milacademy_building = no
			NOT = { has_modifier = resort_colony }
		}

		allow = {
			OR = {
				has_upgraded_capital = yes
				AND = {
					exists = owner
					owner = {
						has_valid_civic = civic_machine_tactical_algorithms
					}
				}
			}
		}

		convert_to = {
			building_tec_regular_military_booster_1
			building_dread_encampment
			building_tec_biohive_military_booster_1
			#building_tec_lithohive_military_booster_1
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}

			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 2
				rare = volatile_motes
			}
		}

		planet_modifier = {
			pop_job_naval_mult = 0.1
			army_starting_experience_add = 100
		}

		inline_script = {
			script = jobs/tec_soldier
			count = @vanilla2jobs
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/tec_warrior_drone
			count = @vanilla2jobs
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script =  buildings/effects/type/tec_military_booster
	}
	# Dread Armies
	building_dread_encampment = {
		base_buildtime = @b2_time
		base_cap_amount = 1
		can_be_ruined = no
		position_priority = 35		# Unique Secondary
		ai_estimate_without_unemployment = yes

		category = army

		potential = {
			exists = owner
			owner = {
				tec_is_reanimator_empire = yes
			}
		}

		allow = {
			has_upgraded_capital = yes
		}

		convert_to = {
			building_tec_regular_military_booster_1
			building_dread_encampment
			building_tec_biohive_military_booster_1
			#building_tec_lithohive_military_booster_1
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
			# No rare upkeep because zombies are cool (also advantage)
		}

		planet_modifier = {
			pop_job_naval_mult = 0.1
			army_starting_experience_add = 100
		}

		inline_script = {
			script = jobs/tec_job
			job = necromancer
			display = with_desc
			count = 1
			mult = 1
			trigger = ""
		}

		inline_script = buildings/effects/tec_mortgage_edict
		inline_script =  buildings/effects/type/tec_military_booster

		inline_script = {
			script = buildings/tec_aibait
			trigger = ""
		}
	}
	# Biohive
	building_tec_biohive_military_booster_1 = {
		icon = building_military_academy		#BIOHIVE ART PLACEHOLDER!!!!
		base_buildtime = @b2_time
		base_cap_amount = 1
		can_be_ruined = no
		position_priority = 35		# Unique Secondary
		ai_estimate_without_unemployment = yes

		category = army

		prerequisites = {
			"tech_centralized_command"
		}
		
		show_tech_unlock_if = {
			tec_is_biohive = yes
			tec_is_reanimator_empire = no
		}

		potential = {
			exists = owner
			owner = {
				tec_is_biohive = yes
				tec_is_reanimator_empire = no
			}
			tec_ai_destroy_milacademy_building = no
		}

		allow = {
			has_upgraded_capital = yes
		}

		convert_to = {
			building_tec_regular_military_booster_1
			building_dread_encampment
			building_tec_biohive_military_booster_1
			#building_tec_lithohive_military_booster_1
		}

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}

			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 2
				rare = volatile_motes
			}
		}

		planet_modifier = {
			pop_job_naval_mult = 0.1
			army_starting_experience_add = 100
		}

		inline_script = {
			script = jobs/tec_soldier
			count = @vanilla2jobs
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/tec_warrior_drone
			count = @vanilla2jobs
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script =  buildings/effects/type/tec_military_booster
	}
 # /
# /

# ARMY
# -----------------------------------------
 # Standard
	building_stronghold = {
		base_buildtime = 240
		position_priority = 150		# Army
		can_be_ruined = no

		category = army
		exempt_from_ai_planet_specialization = no

		prerequisites = {
			"tech_planetary_defenses"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
			tec_has_stronghold_buildings_swap = no
		}
		
		upgrades = {
			"building_fortress"
		}

		potential = {
			owner = {
				tec_is_biohive = no
				tec_has_stronghold_buildings_swap = no
			}
			tec_ai_destroy_fortress_building = no
			NOT = { has_modifier = resort_colony }
		}

		allow = {
			tec_ai_allow_fortress_building = yes
		}

		inline_script = buildings/convert_to/tec_stronghold_1
		
		resources = {
			category = planet_buildings_strongholds
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 1
			}
		}

		planet_modifier = {
			planet_housing_add = 2
		}

		inline_script = {
			script = jobs/tec_soldier
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/tec_warrior_drone
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/tec_fortress
			tier = 1
			type = all
		}
	}
	building_fortress = {
		base_buildtime = @b1_time
		can_build = no
		planetary_ftl_inhibitor = yes
		can_be_ruined = no
		position_priority = 150		# Army

		category = army
		
			
		prerequisites = {
			"tech_global_defense_grid"
		}

		upgrades = {
			building_tec_bastion
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
			tec_has_stronghold_buildings_swap = no
		}


		potential = {
			owner = {
				tec_is_biohive = no
				tec_has_stronghold_buildings_swap = no
			}
			tec_ai_destroy_fortress_building = no
		}

		allow = {
			has_upgraded_capital = yes
		}

		inline_script = buildings/convert_to/tec_stronghold_2

		resources = {
			category = planet_buildings_strongholds
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 2
				rare = volatile_motes
			}
		}
		
		planet_modifier = {
			planet_housing_add = @b2_jobs
		}
		
		inline_script = {
			script = jobs/tec_soldier
			count = @b2_jobs
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/tec_warrior_drone
			count = @b2_jobs
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/tec_fortress
			tier = 2
			type = all
		}

		inline_script = {
			script = buildings/tec_aibait_upgrade
			job = soldier
			trigger = "
				owner = { is_regular_empire = yes }
			"
		}

		inline_script = {
			script = buildings/tec_aibait_upgrade
			job = warrior_drone
			trigger = "
				owner = { is_gestalt = yes }
			"
		}
	}
	building_tec_bastion = {
		base_buildtime = @b2_time
		can_build = no
		planetary_ftl_inhibitor = yes
		can_be_ruined = no
		position_priority = 150		# Army

		category = army
		
		prerequisites = {
			"tech_global_defense_grid_2"
		}

		show_tech_unlock_if = {
			tec_is_biohive = no
			tec_has_stronghold_buildings_swap = no
		}

		potential = {
			owner = {
				tec_is_biohive = no
				tec_has_stronghold_buildings_swap = no
			}
			tec_ai_destroy_fortress_building = no
		}

		allow = {
			has_upgraded_capital = yes
		}

		inline_script = buildings/convert_to/tec_stronghold_3
		
		resources = {
			category = planet_buildings_strongholds
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 3
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 3
				rare = volatile_motes
			}
		}
		
		planet_modifier = {
			planet_housing_add = @b3_jobs
		}
		
		inline_script = {
			script = jobs/tec_soldier
			count = @b3_jobs
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/tec_warrior_drone
			count = @b3_jobs
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/tec_fortress
			tier = 3
			type = all
		}

		inline_script = {
			script = buildings/tec_aibait_upgrade
			job = soldier
			trigger = "
				owner = { is_regular_empire = yes }
			"
		}

		inline_script = {
			script = buildings/tec_aibait_upgrade
			job = warrior_drone
			trigger = "
				owner = { is_gestalt = yes }
			"
		}
	}
 # /
 # Dread Armies
	building_tec_dread_stronghold = {
		base_buildtime = 240
		can_be_ruined = no
		position_priority = 150		# Army

		category = army
			
		prerequisites = {
			"tech_planetary_defenses"
		}

		show_tech_unlock_if = {
			has_valid_civic = civic_reanimated_armies
		}
		
		upgrades = {
			"building_tec_dread_fortress"
		}
		
		potential = {
			owner = {
				has_valid_civic = civic_reanimated_armies
			}
			tec_ai_destroy_fortress_building = no
			NOT = { has_modifier = resort_colony }
		}

		allow = {
			tec_ai_allow_fortress_building = yes
		}

		inline_script = buildings/convert_to/tec_stronghold_1

		resources = {
			category = planet_buildings_strongholds
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 1
			}
		}

		planet_modifier = {
			planet_housing_add = @b1_jobs
		}

		inline_script = {
			script = jobs/tec_soldier
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/tec_fortress
			tier = 1
			type = regular
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				exists = owner
				owner = {
					used_naval_capacity_percent >= 1
				}
			"
		}
	}
	building_tec_dread_fortress = {
		base_buildtime = @b1_time
		can_build = no
		planetary_ftl_inhibitor = yes
		can_be_ruined = no
		position_priority = 150		# Army

		category = army

		prerequisites = {
			"tech_global_defense_grid"
		}

		show_tech_unlock_if = {
			has_valid_civic = civic_reanimated_armies
		}

		upgrades = {
			building_tec_dread_bastion
		}

		potential = {
			owner = {
				has_valid_civic = civic_reanimated_armies
			}
			tec_ai_destroy_fortress_building = no
		}
		
		allow = {
			has_upgraded_capital = yes
		}

		inline_script = buildings/convert_to/tec_stronghold_2
		
		resources = {
			category = planet_buildings_strongholds
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 2
				rare = volatile_motes
			}
		}
		
		planet_modifier = {
			planet_housing_add = @b2_jobs
		}

		inline_script = {
			script = jobs/tec_soldier
			count = @b2_jobs
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/tec_fortress
			tier = 2
			type = regular
		}

		inline_script = {
			script = buildings/tec_aibait_upgrade
			job = tec_necromonger
			trigger = ""
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				exists = owner
				owner = {
					used_naval_capacity_percent >= 1
				}
			"
		}
	}
	building_tec_dread_bastion = {
		base_buildtime = @b2_time
		can_build = no
		planetary_ftl_inhibitor = yes
		can_be_ruined = no
		position_priority = 150		# Army

		category = army

		prerequisites = {
			"tech_global_defense_grid_2"
		}

		show_tech_unlock_if = {
			has_valid_civic = civic_reanimated_armies
		}

		potential = {
			owner = {
				has_valid_civic = civic_reanimated_armies
			}
			tec_ai_destroy_fortress_building = no
		}
		
		allow = {
			has_upgraded_capital = yes
		}

		inline_script = buildings/convert_to/tec_stronghold_3

		resources = {
			category = planet_buildings_strongholds
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 3
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 3
				rare = volatile_motes
			}
		}
		
		planet_modifier = {
			planet_housing_add = @b3_jobs
		}

		inline_script = {
			script = jobs/tec_soldier
			count = @b3_jobs
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/tec_fortress
			tier = 3
			type = regular
		}

		inline_script = {
			script = buildings/tec_aibait_upgrade
			job = tec_necromonger
			trigger = ""
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				exists = owner
				owner = {
					used_naval_capacity_percent >= 1
				}
			"
		}
	}
 # /
 # Biohive
	building_tec_biohive_stronghold = {
		base_buildtime = 240
		position_priority = 150		# Army
		can_be_ruined = no
		icon = building_stronghold		#BIOHIVE ART PLACEHOLDER!!!!

		category = army
		exempt_from_ai_planet_specialization = no

		prerequisites = {
			"tech_planetary_defenses"
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
			tec_has_stronghold_buildings_swap = no
		}
		
		upgrades = {
			"building_tec_biohive_fortress"
		}

		potential = {
			owner = {
				tec_is_biohive = yes
				tec_has_stronghold_buildings_swap = no
			}
			tec_ai_destroy_fortress_building = no
		}

		allow = {
			tec_ai_allow_fortress_building = yes
		}

		inline_script = buildings/convert_to/tec_stronghold_1
		
		resources = {
			category = planet_buildings_strongholds
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 1
			}
		}

		planet_modifier = {
			planet_housing_add = 2
		}

		inline_script = {
			script = jobs/tec_soldier
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/tec_warrior_drone
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/tec_fortress
			tier = 1
			type = all
		}
	}
	building_tec_biohive_fortress = {
		base_buildtime = @b1_time
		can_build = no
		planetary_ftl_inhibitor = yes
		can_be_ruined = no
		position_priority = 150		# Army
		icon = building_fortress		#BIOHIVE ART PLACEHOLDER!!!!

		category = army
		
			
		prerequisites = {
			"tech_global_defense_grid"
		}

		upgrades = {
			building_tec_biohive_bastion
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
			tec_has_stronghold_buildings_swap = no
		}


		potential = {
			owner = {
				tec_is_biohive = yes
				tec_has_stronghold_buildings_swap = no
			}
			tec_ai_destroy_fortress_building = no
		}

		allow = {
			has_upgraded_capital = yes
		}

		inline_script = buildings/convert_to/tec_stronghold_2

		resources = {
			category = planet_buildings_strongholds
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 2
				rare = volatile_motes
			}
		}
		
		planet_modifier = {
			planet_housing_add = @b2_jobs
		}
		
		inline_script = {
			script = jobs/tec_soldier
			count = @b2_jobs
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/tec_warrior_drone
			count = @b2_jobs
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/tec_fortress
			tier = 2
			type = all
		}

		inline_script = {
			script = buildings/tec_aibait_upgrade
			job = soldier
			trigger = "
				owner = { is_regular_empire = yes }
			"
		}

		inline_script = {
			script = buildings/tec_aibait_upgrade
			job = warrior_drone
			trigger = "
				owner = { is_gestalt = yes }
			"
		}
	}
	building_tec_biohive_bastion = {
		base_buildtime = @b2_time
		can_build = no
		planetary_ftl_inhibitor = yes
		can_be_ruined = no
		position_priority = 150		# Army
		icon = building_tec_bastion		#BIOHIVE ART PLACEHOLDER!!!!

		category = army
		
		prerequisites = {
			"tech_global_defense_grid_2"
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
			tec_has_stronghold_buildings_swap = no
		}

		potential = {
			owner = {
				tec_is_biohive = yes
				tec_has_stronghold_buildings_swap = no
			}
			tec_ai_destroy_fortress_building = no
		}

		allow = {
			has_upgraded_capital = yes
		}

		inline_script = buildings/convert_to/tec_stronghold_3
		
		resources = {
			category = planet_buildings_strongholds
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 3
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 3
				rare = volatile_motes
			}
		}
		
		planet_modifier = {
			planet_housing_add = @b3_jobs
		}
		
		inline_script = {
			script = jobs/tec_soldier
			count = @b3_jobs
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = jobs/tec_warrior_drone
			count = @b3_jobs
			mult = 1
			display = with_desc
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/tec_fortress
			tier = 3
			type = all
		}

		inline_script = {
			script = buildings/tec_aibait_upgrade
			job = soldier
			trigger = "
				owner = { is_regular_empire = yes }
			"
		}

		inline_script = {
			script = buildings/tec_aibait_upgrade
			job = warrior_drone
			trigger = "
				owner = { is_gestalt = yes }
			"
		}
	}
 # /
# /
# NAVAL
# -----------------------------------------
 # Regular
	building_tec_naval_academy_1 = {
		base_buildtime = @b1_time
		position_priority = 150		# Army

		category = army
				
		prerequisites = {
			"tech_planetary_defenses"
		}

		upgrades = {
			building_tec_naval_academy_2
		}

		show_tech_unlock_if = {
			is_gestalt = no
			tec_has_naval_academy_buildings_swap = no
		}

		potential = {
			owner = {
				is_gestalt = no
				tec_has_naval_academy_buildings_swap = no
			}
		}

		allow = {
			has_upgraded_capital = yes
			tec_ai_allow_naval_academy_building = yes
		}

		inline_script = buildings/convert_to/tec_naval_academy_1

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 1
			}
		}

		inline_script = {
			script = jobs/tec_naval_operator
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = "" 
		}

		inline_script = {
			script = buildings/effects/type/tec_naval_academy
			tier = 1
			type = regular
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				exists = owner
				owner = {
					used_naval_capacity_percent >= 1
					NOT = { tec_has_soldier_swap = { cached = yes } }
				}
			"
		}
	}
	building_tec_naval_academy_2 = {
		base_buildtime = @b2_time
		can_build = no
		planetary_ftl_inhibitor = yes
		position_priority = 150		# Army

		category = army
		
		prerequisites = {
			"tech_interstellar_fleet_traditions"
		}

		upgrades = {
			building_tec_naval_academy_3
		}

		show_tech_unlock_if = {
			is_gestalt = no
			tec_has_naval_academy_buildings_swap = no
		}

		potential = {
			owner = {
				is_gestalt = no
				tec_has_naval_academy_buildings_swap = no
			}
		}

		allow = {
			has_upgraded_capital = yes
		}

		inline_script = buildings/convert_to/tec_naval_academy_2

		resources = {
			category = planet_buildings_strongholds
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 2
				rare = rare_crystals
			}
		}

		inline_script = {
			script = jobs/tec_naval_operator
			count = @b2_jobs
			mult = 1
			display = with_desc
			trigger = "" 
		}

		inline_script = {
			script = buildings/effects/type/tec_naval_academy
			tier = 2
			type = regular
		}

		inline_script = {
			script = buildings/tec_aibait_upgrade
			job = tec_naval_operator
			trigger = ""
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				exists = owner
				owner = {
					used_naval_capacity_percent >= 1
					NOT = { tec_has_soldier_swap = { cached = yes } }
				}
			"
		}
	}
	building_tec_naval_academy_3 = {
		base_buildtime = @b4_time
		can_build = no
		planetary_ftl_inhibitor = yes
		position_priority = 150		# Army

		category = army
		
		prerequisites = {
			"tech_command_matrix"
		}

		show_tech_unlock_if = {
			is_gestalt = no
			tec_has_naval_academy_buildings_swap = no
		}

		potential = {
			owner = {
				is_gestalt = no
				tec_has_naval_academy_buildings_swap = no
			}
		}

		allow = {
			has_upgraded_capital = yes
		}

		inline_script = buildings/convert_to/tec_naval_academy_3

		resources = {
			category = planet_buildings_strongholds
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 3
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 3
				rare = rare_crystals
			}
		}

		inline_script = {
			script = jobs/tec_naval_operator
			count = @b3_jobs
			mult = 1
			display = with_desc
			trigger = "" 
		}

		inline_script = {
			script = buildings/effects/type/tec_naval_academy
			tier = 3
			type = regular
		}

		inline_script = {
			script = buildings/tec_aibait_upgrade
			job = tec_naval_operator
			trigger = ""
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				exists = owner
				owner = {
					used_naval_capacity_percent >= 1
					NOT = { tec_has_soldier_swap = { cached = yes } }
				}
			"
		}
	}
 # /
 # Gestalt
	building_tec_naval_gestalt_1 = {
		base_buildtime = @b1_time
		position_priority = 150		# Army
		icon = building_tec_naval_academy_1

		category = army
				
		prerequisites = {
			"tech_planetary_defenses"
		}

		upgrades = {
			building_tec_naval_gestalt_2
		}

		show_tech_unlock_if = {
			is_gestalt = yes
			tec_is_biohive = no
			tec_has_naval_academy_buildings_swap = no
		}

		potential = {
			owner = {
				is_gestalt = yes
				tec_is_biohive = no
				tec_has_naval_academy_buildings_swap = no
			}
		}

		allow = {
			has_upgraded_capital = yes
			tec_ai_allow_naval_academy_building = yes
		}

		inline_script = buildings/convert_to/tec_naval_academy_1

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 1
			}
		}

		inline_script = {
			script = jobs/tec_naval_operator
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = "" 
		}

		inline_script = {
			script = buildings/effects/type/tec_naval_academy
			tier = 1
			type = gestalt
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				exists = owner
				owner = {
					used_naval_capacity_percent >= 1
					NOT = { tec_has_soldier_swap = { cached = yes } }
				}
			"
		}
	}
	building_tec_naval_gestalt_2 = {
		base_buildtime = @b2_time
		can_build = no
		planetary_ftl_inhibitor = yes
		position_priority = 150		# Army
		icon = building_tec_naval_academy_2

		category = army
		
		prerequisites = {
			"tech_interstellar_fleet_traditions"
		}

		upgrades = {
			building_tec_naval_gestalt_3
		}

		show_tech_unlock_if = {
			is_gestalt = yes
			tec_is_biohive = no
			tec_has_naval_academy_buildings_swap = no
		}

		potential = {
			owner = {
				is_gestalt = yes
				tec_is_biohive = no
				tec_has_naval_academy_buildings_swap = no
			}
		}

		allow = {
			has_upgraded_capital = yes
		}

		inline_script = buildings/convert_to/tec_naval_academy_2

		resources = {
			category = planet_buildings_strongholds
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 2
				rare = rare_crystals
			}
		}

		inline_script = {
			script = jobs/tec_naval_operator
			count = @b2_jobs
			mult = 1
			display = with_desc
			trigger = "" 
		}

		inline_script = {
			script = buildings/tec_aibait_upgrade
			job = tec_naval_operator_drone
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/tec_naval_academy
			tier = 2
			type = gestalt
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				exists = owner
				owner = {
					used_naval_capacity_percent >= 1
					NOT = { tec_has_soldier_swap = { cached = yes } }
				}
			"
		}
	}
	building_tec_naval_gestalt_3 = {
		base_buildtime = @b4_time
		can_build = no
		planetary_ftl_inhibitor = yes
		position_priority = 150		# Army
		icon = building_tec_naval_academy_3

		category = army
		
		prerequisites = {
			"tech_command_matrix"
		}

		show_tech_unlock_if = {
			is_gestalt = yes
			tec_is_biohive = no
			tec_has_naval_academy_buildings_swap = no
		}

		potential = {
			owner = {
				is_gestalt = yes
				tec_is_biohive = no
				tec_has_naval_academy_buildings_swap = no
			}
		}

		allow = {
			has_upgraded_capital = yes
		}

		inline_script = buildings/convert_to/tec_naval_academy_3

		resources = {
			category = planet_buildings_strongholds
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 3
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 3
				rare = rare_crystals
			}
		}

		inline_script = {
			script = jobs/tec_naval_operator
			count = @b3_jobs
			mult = 1
			display = with_desc
			trigger = "" 
		}

		inline_script = {
			script = buildings/effects/type/tec_naval_academy
			tier = 3
			type = gestalt
		}

		inline_script = {
			script = buildings/tec_aibait_upgrade
			job = tec_naval_operator_drone
			trigger = ""
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				exists = owner
				owner = {
					used_naval_capacity_percent >= 1
					NOT = { tec_has_soldier_swap = { cached = yes } }
				}
			"
		}
	}
 # /
 # Biohive
	building_tec_naval_biohive_1 = {
		base_buildtime = @b1_time
		position_priority = 150		# Army
		icon = building_tec_naval_academy_1		#BIOHIVE ART PLACEHOLDER!!!!

		category = army
				
		prerequisites = {
			"tech_planetary_defenses"
		}

		upgrades = {
			building_tec_naval_biohive_2
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
			tec_has_naval_academy_buildings_swap = no
		}

		potential = {
			owner = {
				tec_is_biohive = yes
				tec_has_naval_academy_buildings_swap = no
			}
		}

		allow = {
			has_upgraded_capital = yes
			tec_ai_allow_naval_academy_building = yes
		}

		inline_script = buildings/convert_to/tec_naval_academy_1

		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 1
			}
		}

		inline_script = {
			script = jobs/tec_naval_operator
			count = @b1_jobs
			mult = 1
			display = with_desc
			trigger = "" 
		}

		inline_script = {
			script = buildings/effects/type/tec_naval_academy
			tier = 1
			type = gestalt
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				exists = owner
				owner = {
					used_naval_capacity_percent >= 1
					NOT = { tec_has_soldier_swap = { cached = yes } }
				}
			"
		}
	}
	building_tec_naval_biohive_2 = {
		base_buildtime = @b2_time
		can_build = no
		planetary_ftl_inhibitor = yes
		position_priority = 150		# Army
		icon = building_tec_naval_academy_2		#BIOHIVE ART PLACEHOLDER!!!!

		category = army
		
		prerequisites = {
			"tech_interstellar_fleet_traditions"
		}

		upgrades = {
			building_tec_naval_biohive_3
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
			tec_has_naval_academy_buildings_swap = no
		}

		potential = {
			owner = {
				tec_is_biohive = yes
				tec_has_naval_academy_buildings_swap = no
			}
		}

		allow = {
			has_upgraded_capital = yes
		}

		inline_script = buildings/convert_to/tec_naval_academy_2

		resources = {
			category = planet_buildings_strongholds
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 2
				rare = rare_crystals
			}
		}

		inline_script = {
			script = jobs/tec_naval_operator
			count = @b2_jobs
			mult = 1
			display = with_desc
			trigger = "" 
		}

		inline_script = {
			script = buildings/tec_aibait_upgrade
			job = tec_naval_operator_drone
			trigger = ""
		}

		inline_script = {
			script = buildings/effects/type/tec_naval_academy
			tier = 2
			type = gestalt
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				exists = owner
				owner = {
					used_naval_capacity_percent >= 1
					NOT = { tec_has_soldier_swap = { cached = yes } }
				}
			"
		}
	}
	building_tec_naval_biohive_3 = {
		base_buildtime = @b4_time
		can_build = no
		planetary_ftl_inhibitor = yes
		position_priority = 150		# Army
		icon = building_tec_naval_academy_3		#BIOHIVE ART PLACEHOLDER!!!!

		category = army
		
		prerequisites = {
			"tech_command_matrix"
		}

		show_tech_unlock_if = {
			tec_is_biohive = yes
			tec_has_naval_academy_buildings_swap = no
		}

		potential = {
			owner = {
				tec_is_biohive = yes
				tec_has_naval_academy_buildings_swap = no
			}
		}

		allow = {
			has_upgraded_capital = yes
		}

		inline_script = buildings/convert_to/tec_naval_academy_3

		resources = {
			category = planet_buildings_strongholds
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 3
			}
			inline_script = {
				script = buildings/resources/tec_rare_resource_cost
				trigger = ""
				tier = 3
				rare = rare_crystals
			}
		}

		inline_script = {
			script = jobs/tec_naval_operator
			count = @b3_jobs
			mult = 1
			display = with_desc
			trigger = "" 
		}

		inline_script = {
			script = buildings/effects/type/tec_naval_academy
			tier = 3
			type = gestalt
		}


		inline_script = {
			script = buildings/tec_aibait_upgrade
			job = tec_naval_operator_drone
			trigger = ""
		}

		inline_script = {
			script = buildings/tec_aibait
			trigger = "
				exists = owner
				owner = {
					used_naval_capacity_percent >= 1
					NOT = { tec_has_soldier_swap = { cached = yes } }
				}
			"
		}
	}
 # /
# /

# OTHER
# -----------------------------------------
	building_planetary_shield_generator = {
		base_buildtime = @b3_time	
		base_cap_amount = 1
		can_be_ruined = no
		position_priority = 150		# Army
		ai_estimate_without_unemployment = yes

		category = army
		
		prerequisites = {
			"tech_planetary_shield_generator"
		}

		allow = {
			has_upgraded_capital = yes
			hidden_trigger = { owner = { is_ai = no } }
			tec_not_blocked_by_orbital_building = {
				building = ring_orbital_shield_generator
			}
		}
		
		destroy_trigger = {
			exists = owner
			owner = {
				is_ai = yes
				is_at_war = no
		is_fallen_empire = no
			}
		}
		
		resources = {
			category = planet_buildings
			inline_script = {
				script = buildings/resources/tec_resource_cost
				tier = 2
			}
		}

		planet_modifier = {
			planet_orbital_bombardment_damage = -0.5
		}

		inline_script = buildings/effects/tec_secured_domain
	}
	#building_mega_planetary_shield_generator = {
		#	base_buildtime = @b4_time
		#	can_build = no
		#	add_to_first_building_slot = yes
		#
		#	category = army
		#	
		#	allow = {
		#		has_upgraded_capital = yes
		#		owner = { is_ai = no }
		#	}
		#	
		#	destroy_trigger = {
		#		exists = owner
		#		owner = { is_ai = yes }
		#	}
		#	
		#	planet_modifier = {
		#		planet_orbital_bombardment_damage = -0.75
		#	}
		#
		#	resources = {
		#		category = planet_buildings
		#		cost = {
		#			minerals = @b2_minerals
		#			rare_crystals = @b2_rare_cost
		#		}
		#		upkeep = {
		#			energy = @b2_upkeep
		#			rare_crystals = @b2_rare_upkeep
		#		}
		#		produces = {
		#			trigger = {
		#				owner = { has_valid_civic = civic_tec_regular_secured_domain }
		#			}
		#			unity = 4
		#		}
		#	}
		#	
		#	prerequisites = {
		#		"tech_planetary_shield_generator_2"
		#	}
		#	
		#	ai_weight = {
		#		weight = 0
		#	}
	#}
# /