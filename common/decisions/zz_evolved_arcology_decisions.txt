# - - - - - - - - - - - - - - - - - - - - - 
# Arcology Decisions
# - - - - - - - - - - - - - - - - - - - - - 

#-----------------------------------------------------
# Ecumenopolis decision replace
#-----------------------------------------------------
# O V E R W R I T E : O2_special_decisions.txt

# - - - - - - - - - - - - - - - - - - - - - 
# Decisions - Urban megacorp
# - - - - - - - - - - - - - - - - - - - - - 
# Arcology Project
decision_arcology_project = {
	owned_planets_only = yes
	icon = decision_arcology_project

	enactment_time = 2700 #3600 2700
	resources = {
		category = decisions
		cost = {
			influence = 200
			minerals = 20000
		}
		cost = {
			trigger = {
				owner = {
					has_tradition = tr_tec_artifice_final_2
				}
			}
			minerals = -10000
		}
		cost = {
			trigger = {
				owner = {
					has_ethic = ethic_industrial
				}
			}
			influence = -50
		}
		cost = {
			trigger = {
				owner = {
					has_ethic = ethic_fanatic_industrial
				}
			}
			influence = -100
		}
	}

	potential = {
		tec_is_relic_world = no
		tec_invalidates_arcology_project_comp = no

		habitable_structure = no
		tec_is_arcology = no

		exists = owner
		owner = {
			has_ascension_perk = ap_arcology_project
			NOT = {
				has_ethic = ethic_fanatic_green
			}
			NOR = {
				has_civic = civic_tec_corporate_urbancorp
				has_civic = civic_agrarian_idyll
				has_civic = civic_tec_eco_keepers
			}
		}
	}

	allow = {
		if = {	# Note: I feel this extremely cheesy, but whatever
			limit = { owner = { is_ai = no } }
			custom_tooltip = {
				fail_text = decision_arcology_project_requirements
				if = {
					limit = {
						owner = {
							NOT = {
								tec_is_megacity_empire = yes
							}
						}
					}
					free_district_slots < 1
					num_districts = { type = district_farming value < 1 }
					num_districts = { type = district_mining value < 1 }
					num_districts = { type = district_generator value < 1 }
					num_districts = { type = district_tec_proto_farming value < 1 }
					num_districts = { type = district_tec_proto_mining value < 1 }
					num_districts = { type = district_tec_proto_generator value < 1 }
				}
				if = {
					limit = {
						owner = {
							tec_is_megacity_empire = yes
						}
					}
					# MEMESIS MEGACITY CHANGES
				}
			}
		}
		custom_tooltip = {
			fail_text = decision_tec_arcology_blocker_tweaks
			OR = {
				num_uncleared_blockers < 1
				owner = {
					tec_can_enact_overstrip = yes
				}
			}
		}
	}

	effect = {
		# Make city-planet
		custom_tooltip = decision_arcology_project_effects
		hidden_effect = {
			# Handles special deposits
			tec_ecu_deposits_handler_before = yes
			clear_deposits = yes
			set_industrial_focus_flags = yes
			remove_modifier = pm_tec_industrialized_planet
			change_pc = pc_city
			relic_world_conversion_effect = {
				DISTRICT = district_arcology_housing
				VARIABLE = num_housing_districts
			}
			relic_world_conversion_effect = {
				DISTRICT = district_arcology_arms_industry
				VARIABLE = num_industrial_districts
			}
			set_ecu_industrial_districts_effect = yes
			#Included Planetary diversity things
			tec_ecu_planet_entity = yes
			# Ecological resolution & factions handler
			tec_ecu_ecological_resolution = yes
			owner = {
				country_event = { id = distar.201 } # port for living planet distar.197, triggers in event
			}
			planet_event = { id = mega.200 }
			#Ecumenopolis specialization modifier
			remove_planet_flag = tec_ecumenopolis_spec_militarized
			remove_planet_flag = tec_ecumenopolis_spec_science
			remove_planet_flag = tec_ecumenopolis_spec_admin

			# Handles special deposits
			tec_ecu_deposits_handler_after = yes
		}
	}

	ai_weight = {
		weight = 100
	}
}

# Arcology Project (Relic Worlds)
decision_arcology_project_relic = {
	owned_planets_only = yes
	icon = decision_arcology_project

	enactment_time = 2700 #3600 2700
	resources = {
		category = decisions
		cost = {
			influence = 200
			minerals = 20000
		}
		cost = {
			trigger = {
				owner = {
					has_tradition = tr_tec_artifice_final_2
				}
			}
			minerals = -10000
		}
		cost = {
			trigger = {
				owner = {
					has_ethic = ethic_industrial
				}
			}
			influence = -50
		}
		cost = {
			trigger = {
				owner = {
					has_ethic = ethic_fanatic_industrial
				}
			}
			influence = -100
		}
	}

	potential = {
		is_planet_class = pc_relic
		tec_invalidates_arcology_project_comp = no

		habitable_structure = no
		tec_is_arcology = no
		exists = owner
		owner = {
		#	is_regular_empire = yes 
			NOT = {
				has_civic = civic_tec_corporate_urbancorp 
			}
		}
	}

	allow = {
		owner = {
			has_technology = tech_housing_2 
		}
		custom_tooltip = {
			fail_text = decision_tec_arcology_blocker_tweaks
			OR = {
				num_uncleared_blockers < 1
				owner = {
					tec_can_enact_overstrip = yes
				}
			}
		}
	}

	effect = {
		# Make city-planet
		custom_tooltip = decision_arcology_project_effects
		hidden_effect = {
			# Handles special deposits
			tec_ecu_deposits_handler_before = yes
			clear_deposits = yes
			set_industrial_focus_flags = yes
			remove_modifier = pm_tec_industrialized_planet
			change_pc = pc_city
			relic_world_conversion_effect = {
				DISTRICT = district_arcology_housing
				VARIABLE = num_housing_districts
			}
			relic_world_conversion_effect = {
				DISTRICT = district_arcology_arms_industry
				VARIABLE = num_industrial_districts
			}
			set_ecu_industrial_districts_effect = yes
			#Included Planetary diversity things
			tec_ecu_planet_entity = yes
			# Ecological resolution & factions handler
			tec_ecu_ecological_resolution = yes
			add_deposit = d_former_relic_world
			planet_event = {
				id = mega.201 
			}

			while = {
				count = 4
				solar_system = {
					random_system_ambient_object = {
						limit = {
							has_ambient_object_flag = relic_world_debris 
						}
						destroy_ambient_object = this
					}
				}
			}
			#Ecumenopolis specialization modifier
			remove_planet_flag = tec_ecumenopolis_spec_militarized
			remove_planet_flag = tec_ecumenopolis_spec_science
			remove_planet_flag = tec_ecumenopolis_spec_admin
			set_planet_flag = tec_ecumenopolis_was_relic_planet
			# Handles special deposits
			tec_ecu_deposits_handler_after = yes
		}
	}
	ai_weight = {
		weight = 100
	}
}

# Arcology Project for Urban Idyll megacorps
decision_arcology_project_tec_corporate_urbancorp = {
	owned_planets_only = yes
	icon = decision_arcology_project
	
	enactment_time = 2000 #3000
	resources = {
		category = decisions
		cost = {
			influence = 200
			minerals = 20000
		}
		cost = {
			trigger = {
				owner = {
					has_tradition = tr_tec_artifice_final_2
				}
			}
			minerals = -10000
		}
		cost = {
			trigger = {
				owner = {
					has_ethic = ethic_industrial
				}
			}
			influence = -50
		}
		cost = {
			trigger = {
				owner = {
					has_ethic = ethic_fanatic_industrial
				}
			}
			influence = -100
		}
	}
	
	potential = {
		tec_is_relic_world = no
		tec_invalidates_arcology_project_comp = no

		habitable_structure = no
		tec_is_arcology = no
		exists = owner
		owner = {
			AND = {
				has_civic = civic_tec_corporate_urbancorp
				has_ascension_perk = ap_arcology_project 
			}
			NOT = {
				has_ethic = ethic_fanatic_green
			}
		}
	}
	
	allow = {
		if = {	# Note: I feel this extremely cheesy, but whatever
			limit = { owner = { is_ai = no } }
			custom_tooltip = {
				fail_text = decision_arcology_project_requirements
				if = {
					limit = {
						owner = {
							NOT = {
								tec_is_megacity_empire = yes
							}
						}
					}
					free_district_slots < 1
					num_districts = { type = district_farming value < 1 }
					num_districts = { type = district_mining value < 1 }
					num_districts = { type = district_generator value < 1 }
					num_districts = { type = district_tec_proto_farming value < 1 }
					num_districts = { type = district_tec_proto_mining value < 1 }
					num_districts = { type = district_tec_proto_generator value < 1 }
				}
				if = {
					limit = {
						owner = {
							tec_is_megacity_empire = yes
						}
					}
					# MEMESIS MEGACITY CHANGES
					always = no
					#calc_true_if = {
					#	amount = 3
					#	has_building = building_tec_megacity_standard_3
					#	has_building = building_tec_megacity_standard_3
					#	has_building = building_tec_megacity_standard_3
					#	has_building = building_tec_megacity_research_3
					#	has_building = building_tec_megacity_research_3
					#	has_building = building_tec_megacity_research_3
					#	has_building = building_tec_megacity_cg_3
					#	has_building = building_tec_megacity_cg_3
					#	has_building = building_tec_megacity_cg_3
					#	has_building = building_tec_megacity_alloy_3
					#	has_building = building_tec_megacity_alloy_3
					#	has_building = building_tec_megacity_alloy_3
					#}
				}
			}
		}
		custom_tooltip = {
			fail_text = decision_tec_arcology_blocker_tweaks
			OR = {
				num_uncleared_blockers < 1
				owner = {
					tec_can_enact_overstrip = yes
				}
			}
		}
	}
	
	effect = {
		# Make city-planet
		custom_tooltip = decision_arcology_project_effects
		hidden_effect = {
			# Handles special deposits
			tec_ecu_deposits_handler_before = yes
			clear_deposits = yes
			set_industrial_focus_flags = yes
			remove_modifier = pm_tec_industrialized_planet
			change_pc = pc_city
			relic_world_conversion_effect = {
				DISTRICT = district_arcology_housing
				VARIABLE = num_housing_districts
			}
			relic_world_conversion_effect = {
				DISTRICT = district_arcology_arms_industry
				VARIABLE = num_industrial_districts
			}
			set_ecu_industrial_districts_effect = yes
			#Included Planetary diversity things
			tec_ecu_planet_entity = yes
			# Ecological resolution & factions handler
			tec_ecu_ecological_resolution = yes
			owner = {
				country_event = { id = distar.201 } # port for living planet distar.197, triggers in event
			}
			planet_event = { id = mega.200 }
			#Ecumenopolis specialization modifier
			remove_planet_flag = tec_ecumenopolis_spec_militarized
			remove_planet_flag = tec_ecumenopolis_spec_science
			remove_planet_flag = tec_ecumenopolis_spec_admin
			# Handles special deposits
			tec_ecu_deposits_handler_after = yes
		}
	
		# /
	}
	
	ai_weight = {
		weight = 100
	}
}

# Arcology Project (Relic Worlds) for urban idyll megacorps
decision_arcology_project_relic_tec_corporate_urbancorp = {
	owned_planets_only = yes
	icon = decision_arcology_project

	enactment_time = 2000 #3000
	resources = {
		category = decisions
		cost = {
			influence = 200
			minerals = 20000
		}
		cost = {
			trigger = {
				owner = {
					has_tradition = tr_tec_artifice_final_2
				}
			}
			minerals = -10000
		}
		cost = {
			trigger = {
				owner = {
					has_ethic = ethic_industrial
				}
			}
			influence = -50
		}
		cost = {
			trigger = {
				owner = {
					has_ethic = ethic_fanatic_industrial
				}
			}
			influence = -100
		}
	}
	
	potential = {
		is_planet_class = pc_relic
		tec_invalidates_arcology_project_comp = no
		
		habitable_structure = no
		tec_is_arcology = no
		exists = owner
		owner = {
			AND = {
				has_civic = civic_tec_corporate_urbancorp
				is_regular_empire = yes 
			}
		}
	}
	
	allow = {
		owner = {
			has_technology = tech_housing_2 
		}
		custom_tooltip = {
			fail_text = decision_tec_arcology_blocker_tweaks
			OR = {
				num_uncleared_blockers < 1
				owner = {
					tec_can_enact_overstrip = yes
				}
			}
		}
	}
	
	effect = {
		# Make city-planet
		custom_tooltip = decision_arcology_project_effects
		hidden_effect = {
			# Handles special deposits
			tec_ecu_deposits_handler_before = yes
			clear_deposits = yes
			set_industrial_focus_flags = yes
			remove_modifier = pm_tec_industrialized_planet
			change_pc = pc_city
			relic_world_conversion_effect = {
				DISTRICT = district_arcology_housing
				VARIABLE = num_housing_districts
			}
			relic_world_conversion_effect = {
				DISTRICT = district_arcology_arms_industry
				VARIABLE = num_industrial_districts
			}
			set_ecu_industrial_districts_effect = yes
			#Included Planetary diversity things
			tec_ecu_planet_entity = yes
			# Ecological resolution & factions handler
			tec_ecu_ecological_resolution = yes
			add_deposit = d_former_relic_world
			planet_event = { id = mega.201 }
			while = {
				count = 4
				solar_system = {
					random_system_ambient_object = {
						limit = { has_ambient_object_flag = relic_world_debris }
						destroy_ambient_object = this
					}
				}
			}
			#Ecumenopolis specialization modifier
			remove_planet_flag = tec_ecumenopolis_spec_militarized
			remove_planet_flag = tec_ecumenopolis_spec_science
			remove_planet_flag = tec_ecumenopolis_spec_admin
			set_planet_flag = tec_ecumenopolis_was_relic_planet
			# Handles special deposits
			tec_ecu_deposits_handler_after = yes
		}
		
	}
	
	ai_weight = {
		weight = 100
	}
}


#-----------------------------------------------------
#Ecumenopolis specializations
#-----------------------------------------------------
# 4 specializations
# Militar = city/trade + alloys + navy + leisure/faith											+ -40% orbital bombardment damage + 25% system ship assembly speed building
# Science = city/trade + research/curator + rare materials + leisure/faith						+ +1 research alternative -20% researchers upkeep
# Administration = city/trade + administration + cg industry + leisure/faith 					+ +15% sector planets output (works like resort or crime colony)
# Precursor = city+leisure + free alloys district + free research district + special district	+ still to decide

# Militar ecumenopolis
decision_tec_military_ecu = {
	icon = decision_tec_military_ecu

	enactment_time = 900

	resources = {
		category = decisions
		cost = {
			alloys = 2000
		}
	}
	
	potential = {
		OR = {
			is_planet_class = pc_city
		}
		exists = space_owner
		owner = {
			has_ascension_perk = ap_arcology_project
		}
		NOR = {
			has_planet_flag = tec_ecumenopolis_spec_militarized
			has_planet_flag = tec_ecumenopolis_spec_science
			has_planet_flag = tec_ecumenopolis_spec_admin
			has_planet_flag = tec_ecumenopolis_spec_precursor
			#	has_planet_flag = tec_ecumenopolis_was_relic_planet
		}
	}

	effect = {
		custom_tooltip = decision_tec_military_ecu_effects
		hidden_effect = {
			
			set_planet_flag = tec_ecumenopolis_spec_militarized
			set_planet_flag = tec_ecumenopolis_militarized_army

			#anticheese
			remove_planet_flag = tec_ecumenopolis_spec_science
			remove_planet_flag = tec_ecumenopolis_refinery_nospec
			remove_planet_flag = tec_ecumenopolis_spec_admin
			remove_planet_flag = tec_ecumenopolis_spec_precursor
			remove_planet_flag = tec_ecumenopolis_militarized_navy
		}
	}
	ai_weight = {
		weight = 0
	}
}

# Science ecumenopolis
decision_tec_science_ecu = {
	icon = decision_tec_science_ecu

	enactment_time = 900

	resources = {
		category = decisions
		cost = {
			alloys = 2000
		}
	}
	
	potential = {
		OR = {
			is_planet_class = pc_city
		}
		exists = space_owner
		owner = {
			has_ascension_perk = ap_arcology_project
		}
		NOR = {
			has_planet_flag = tec_ecumenopolis_spec_militarized
			has_planet_flag = tec_ecumenopolis_spec_science
			has_planet_flag = tec_ecumenopolis_spec_admin
			has_planet_flag = tec_ecumenopolis_spec_precursor
			#	has_planet_flag = tec_ecumenopolis_was_relic_planet
		}
	}


	effect = {
		custom_tooltip = decision_tec_science_ecu_effects
		hidden_effect = {
			set_planet_flag = tec_ecumenopolis_spec_science
			set_planet_flag = tec_ecumenopolis_refinery_nospec

			#anticheese
			remove_planet_flag = tec_ecumenopolis_spec_militarized
			remove_planet_flag = tec_ecumenopolis_militarized_army
			remove_planet_flag = tec_ecumenopolis_spec_admin
			remove_planet_flag = tec_ecumenopolis_spec_precursor
			remove_planet_flag = tec_ecumenopolis_militarized_navy
		}
		
	}
	ai_weight = {
		weight = 0
	}
}

# Administration Ecumenopolis
decision_tec_administration_ecu = {
	icon = decision_tec_administration_ecu

	enactment_time = 900

	resources = {
		category = decisions
		cost = {
			alloys = 2000
		}
	}
	
	potential = {
		OR = {
			is_planet_class = pc_city
		}
		exists = space_owner
		owner = {
			has_ascension_perk = ap_arcology_project
		}
		NOR = {
			has_planet_flag = tec_ecumenopolis_spec_militarized
			has_planet_flag = tec_ecumenopolis_spec_science
			has_planet_flag = tec_ecumenopolis_spec_admin
			has_planet_flag = tec_ecumenopolis_spec_precursor
		#	has_planet_flag = tec_ecumenopolis_was_relic_planet
		}
	}


	effect = {
		custom_tooltip = decision_tec_administration_ecu_effects
		hidden_effect = {
			set_planet_flag = tec_ecumenopolis_spec_admin

			#anticheese
			remove_planet_flag = tec_ecumenopolis_spec_science
			remove_planet_flag = tec_ecumenopolis_refinery_nospec

			remove_planet_flag = tec_ecumenopolis_spec_militarized
			remove_planet_flag = tec_ecumenopolis_militarized_army

			remove_planet_flag = tec_ecumenopolis_spec_precursor
		}
	}
	ai_weight = {
		weight = 0
	}
}

# Precursor ecumenopolis
decision_tec_precursor_ecu = {
	icon = decision_tec_precursor_ecu

	enactment_time = 1800

	resources = {
		category = decisions
		cost = {
			alloys = 5000
			minor_artifacts = 100
		}
	}
	
	potential = {

		always = no			#for future patches
		OR = {
			is_planet_class = pc_city
		}
		exists = space_owner
		owner = {
			has_ascension_perk = ap_arcology_project
		}
		has_planet_flag = tec_ecumenopolis_refinery_nospec
		NOR = {
			has_planet_flag = tec_ecumenopolis_refinery_motes
			has_planet_flag = tec_ecumenopolis_refinery_gases
			has_planet_flag = tec_ecumenopolis_refinery_crystals
		}
	}


	effect = {
		custom_tooltip = decision_tec_precursor_ecu_effects
		hidden_effect = {
			set_planet_flag = tec_ecumenopolis_spec_precursor

			#anticheese
			remove_planet_flag = tec_ecumenopolis_spec_militarized
			remove_planet_flag = tec_ecumenopolis_militarized_army

			remove_planet_flag = tec_ecumenopolis_spec_science
			remove_planet_flag = tec_ecumenopolis_refinery_nospec

			remove_planet_flag = tec_ecumenopolis_spec_admin
		}
	}
	ai_weight = {
		weight = 0
	}
}


# Swap districts - non permanent

# refineries
# Science ecumenopolis
decision_tec_science_ecu_refinery = {
	icon = decision_tec_science_ecu_refinery

	enactment_time = 300

	resources = {
		category = decisions
		cost = {
			alloys = 500
		}
	}
	
	potential = {
		OR = {
			is_planet_class = pc_city
		}
		exists = space_owner
		owner = {
			has_ascension_perk = ap_arcology_project
		}
		has_planet_flag = tec_ecumenopolis_spec_science
		NOT = {
			has_planet_flag = tec_ecumenopolis_refinery_nospec
		}
	}


	effect = {
		custom_tooltip = decision_tec_science_ecu_effects
		hidden_effect = {
			set_planet_flag = tec_ecumenopolis_refinery_nospec
			
			remove_planet_flag = tec_ecumenopolis_refinery_crystals
			remove_planet_flag = tec_ecumenopolis_refinery_motes
			remove_planet_flag = tec_ecumenopolis_refinery_gases
		}
	}
	ai_weight = {
		weight = 0
	}
}

decision_tec_science_ecu_motes = {
	icon = decision_tec_science_ecu_motes

	enactment_time = 300

	resources = {
		category = decisions
		cost = {
			alloys = 500
		}
	}
	
	potential = {
		OR = {
			is_planet_class = pc_city
		}
		exists = space_owner
		owner = {
			has_ascension_perk = ap_arcology_project
		}
		has_planet_flag = tec_ecumenopolis_spec_science
		NOT = {
			has_planet_flag = tec_ecumenopolis_refinery_motes
		}
	}


	effect = {
		custom_tooltip = decision_tec_science_ecu_motes_effects
		hidden_effect = {
			set_planet_flag = tec_ecumenopolis_refinery_motes

			remove_planet_flag = tec_ecumenopolis_refinery_nospec
			remove_planet_flag = tec_ecumenopolis_refinery_gases
			remove_planet_flag = tec_ecumenopolis_refinery_crystals
		}
	}
	ai_weight = {
		weight = 0
	}
}

decision_tec_science_ecu_gas = {
	icon = decision_tec_science_ecu_gas

	enactment_time = 300

	resources = {
		category = decisions
		cost = {
			alloys = 500
		}
	}
	
	potential = {
		OR = {
			is_planet_class = pc_city
		}
		exists = space_owner
		owner = {
			has_ascension_perk = ap_arcology_project
		}
		has_planet_flag = tec_ecumenopolis_spec_science
		NOT = {
			has_planet_flag = tec_ecumenopolis_refinery_gases
		}
	}


	effect = {
		custom_tooltip = decision_tec_science_ecu_gas_effects
		hidden_effect = {
			set_planet_flag = tec_ecumenopolis_refinery_gases
			
			remove_planet_flag = tec_ecumenopolis_refinery_nospec
			remove_planet_flag = tec_ecumenopolis_refinery_motes
			remove_planet_flag = tec_ecumenopolis_refinery_crystals
		}
	}
	ai_weight = {
		weight = 0
	}
}

decision_tec_science_ecu_crystals = {
	icon = decision_tec_science_ecu_crystals

	enactment_time = 300

	resources = {
		category = decisions
		cost = {
			alloys = 500
		}
	}
	
	potential = {
		OR = {
			is_planet_class = pc_city
		}
		exists = space_owner
		owner = {
			has_ascension_perk = ap_arcology_project
		}
		has_planet_flag = tec_ecumenopolis_spec_science
		NOT = {
			has_planet_flag = tec_ecumenopolis_refinery_crystals
		}
	}


	effect = {
		custom_tooltip = decision_tec_science_ecu_crystals_effects
		hidden_effect = {
			set_planet_flag = tec_ecumenopolis_refinery_crystals
			
			remove_planet_flag = tec_ecumenopolis_refinery_nospec
			remove_planet_flag = tec_ecumenopolis_refinery_motes
			remove_planet_flag = tec_ecumenopolis_refinery_gases
		}
	}
	ai_weight = {
		weight = 0
	}
}

# Military flip
decision_tec_military_naval = {
	icon = decision_tec_military_naval

	enactment_time = 300

	resources = {
		category = decisions
		cost = {
			alloys = 500
		}
	}
	
	potential = {
		OR = {
			is_planet_class = pc_city
		}
		exists = space_owner
		owner = {
			has_ascension_perk = ap_arcology_project
		}
		has_planet_flag = tec_ecumenopolis_spec_militarized
		has_planet_flag = tec_ecumenopolis_militarized_army
		NOT = {
			has_planet_flag = tec_ecumenopolis_militarized_navy
		}
	}


	effect = {
		custom_tooltip = decision_tec_military_naval_effects
		hidden_effect = {
			remove_planet_flag = tec_ecumenopolis_militarized_army
			set_planet_flag = tec_ecumenopolis_militarized_navy
		}
	}
	ai_weight = {
		weight = 0
	}
}

decision_tec_military_garrison = {
	icon = decision_tec_military_army

	enactment_time = 300

	resources = {
		category = decisions
		cost = {
			alloys = 500
		}
	}
	
	potential = {
		OR = {
			is_planet_class = pc_city
		}
		exists = space_owner
		owner = {
			has_ascension_perk = ap_arcology_project
		}
		has_planet_flag = tec_ecumenopolis_spec_militarized
		has_planet_flag = tec_ecumenopolis_militarized_navy
		NOT = {
			has_planet_flag = tec_ecumenopolis_militarized_army
		}
	}


	effect = {
		custom_tooltip = decision_tec_military_garrison_effects
		hidden_effect = {
			remove_planet_flag = tec_ecumenopolis_militarized_navy
			set_planet_flag = tec_ecumenopolis_militarized_army
		}
	}
	ai_weight = {
		weight = 0
	}
}





# ----------------------------------------
#	Eco-worlds
# ----------------------------------------
# Eco-world Project
decision_tec_ecoworld_project = {
	owned_planets_only = yes
	icon = decision_tec_ecoworld_project

	enactment_time = 2920
	resources = {
		category = decisions
		cost = {
			influence = 150
			minerals = 7500
			food = 12500
		}
		cost = {
			trigger = {
				owner = {
					has_tradition = tr_tec_artifice_final_2
				}
			}
			minerals = -3750
			food = -6250
		}
	}

	potential = {
		tec_is_arcology = no
		tec_invalidates_ecoworld_project_comp = no

		tec_is_ecoworld = no

		habitable_structure = no
		tec_is_arcology = no

		exists = owner
		owner = {
			NOR = {
				has_ethic = ethic_fanatic_industrial
				has_valid_civic = civic_hive_devouring_swarm
			}
			OR = {
				is_ecologist = yes
				has_ascension_perk = ap_mastery_of_nature
			}
		}
	}


	allow = {
		custom_tooltip = {
			fail_text = decision_tec_ecoworld_project_requirements
			#free_district_slots < 1 
			OR = {
				AND = {
					num_free_districts = { type = district_generator value = 0 }
					num_districts = {
						type = district_generator
						value >= 6
					}
				}
				AND = {
					num_free_districts = { type = district_mining	value = 0 }
					num_districts = {
						type = district_mining
						value >= 6
					}
				}
				AND = {
					num_free_districts = { type = district_farming	value = 0 }
					num_districts = {
						type = district_farming
						value >= 6
					}
				}

				# Uncapped
				AND = {
					num_districts = {
						type = district_mining_uncapped
						value >= 9
					}
				}
				AND = {
					num_districts = {
						type = district_generator_uncapped
						value >= 9
					}
				}
				AND = {
					num_districts = {
						type = district_farming_uncapped
						value >= 9
					}
				}

				# Special 
				AND = {
					num_districts = {
						type = district_tec_aqua_mining
						value >= 9
					}
				}
				AND = {
					num_districts = {
						type = district_tec_aqua_generator
						value >= 9
					}
				}
				AND = {
					num_districts = {
						type = district_tec_aqua_farming
						value >= 9
					}
				}

				

			}
		}
		custom_tooltip = {
			fail_text = decision_tec_arcology_blocker_tweaks
			OR = {
				num_uncleared_blockers < 1
				owner = {
					tec_can_enact_overstrip = yes
				}
			}
		}
		custom_tooltip = {
			fail_text = decision_tec_arcology_blocker_tweaks
			OR = {
				num_uncleared_blockers < 1
				owner = {
					tec_can_enact_overstrip = yes
				}
			}
		}
	}

	effect = {
		# Make city-planet
		custom_tooltip = decision_tec_ecoworld_project_effects
		custom_tooltip = decision_tec_ecoworld_project_unemployment_effects
		hidden_effect = {
			# Adds variables
			owner = {
				change_variable = {
					which = tec_terraformed_worlds
					value = 1
				}
			}
			# 
			if = {
				limit = {
					exists = owner
					owner = {
						has_technology = tech_terrestrial_sculpting
						has_ascension_perk = ap_world_shaper
						OR = {
							has_valid_civic = civic_tec_eco_keepers
							has_valid_civic = civic_agrarian_idyll
						}
					}
					planet = {
						NOR = {
							tec_is_pd_perfect_planets = yes
							tec_is_pd_exotic_planets = yes
						}
					}
				}
				change_pc = pc_gaia
			}
			remove_modifier = pm_tec_industrialized_planet
			if = {
				limit = {
					exists = owner
					owner = {
						is_regular_empire = yes
					}
				}
				
				every_owned_pop = {
					limit = {
						planet = {
							is_same_value = root
						}
						OR = {
							has_job = foundry
							has_job = catalytic_technician
							has_job = artisan
							has_job = artificer

							has_job = alloy_drone
							has_job = fabricator
							has_job = catalytic_technician
							has_job = artisan_drone
						}
					}
					add_modifier = {
						modifier = tec_demote_me_senpai
						days = 45
					}
				}
			}
		}

		add_modifier = { modifier = "pm_tec_ecoworld_planet" days = -1 }
	}

	ai_weight = {
		weight = 1
	}
}

# Default Ringworld (housing, energy, minerals, food)
decision_tec_eco_alloys_on = {

	enactment_time = 360

	resources = {
		category = decisions
		cost = {
			minerals = 1000
			volatile_motes = 100
		}
	}
	
	potential = {
		has_modifier = pm_tec_ecoworld_planet
		NOT = {
			has_planet_flag = tec_eco_alloys_on
		}
	}

	effect = {
		custom_tooltip = decision_tec_eco_alloys_on_effects
		hidden_effect = {
			set_planet_flag = tec_eco_alloys_on
			if = {
				limit = {
					owner = {
						is_ai = yes
					}
				}
				owner = {
					add_resource = {
						alloys = 30
					}
				}
			}
		}
	}
	ai_weight = {
		weight = 10
	}
}
decision_tec_eco_alloys_off = {

	enactment_time = 360

	resources = {
		category = decisions
	}
	
	potential = {
		has_modifier = pm_tec_ecoworld_planet
		has_planet_flag = tec_eco_alloys_on
	}

	effect = {
		custom_tooltip = decision_tec_eco_alloys_off_effects
		hidden_effect = {
			remove_planet_flag = tec_eco_alloys_on
		}
	}
	ai_weight = {
		weight = 0
	}
}

decision_tec_eco_cg_on = {

	enactment_time = 360

	resources = {
		category = decisions
		cost = {
			minerals = 1000
			rare_crystals = 100
		}
	}
	
	potential = {
		has_modifier = pm_tec_ecoworld_planet
		NOT = {
			has_planet_flag = tec_eco_cg_on
		}
	}

	effect = {
		custom_tooltip = decision_tec_eco_cg_on_effects
		hidden_effect = {
			set_planet_flag = tec_eco_cg_on
			if = {
				limit = {
					owner = {
						is_ai = yes
					}
				}
				owner = {
					add_resource = {
						consumer_goods = 30
					}
				}
			}
		}
	}
	ai_weight = {
		weight = 10
	}
}
decision_tec_eco_cg_off = {

	enactment_time = 360

	resources = {
		category = decisions
	}
	
	potential = {
		has_modifier = pm_tec_ecoworld_planet
		has_planet_flag = tec_eco_cg_on
	}

	effect = {
		custom_tooltip = decision_tec_eco_cg_off_effects
		hidden_effect = {
			remove_planet_flag = tec_eco_cg_on
		}
	}
	ai_weight = {
		weight = 0
	}
}

decision_tec_eco_res_on = {

	enactment_time = 360

	resources = {
		category = decisions
		cost = {
			minerals = 1000
			exotic_gases = 100
		}
	}
	
	potential = {
		has_modifier = pm_tec_ecoworld_planet
		NOT = {
			has_planet_flag = tec_eco_res_on
		}
	}

	effect = {
		custom_tooltip = decision_tec_eco_res_on_effects
		hidden_effect = {
			set_planet_flag = tec_eco_res_on
			if = {
				limit = {
					owner = {
						is_ai = yes
					}
				}
				owner = {
					add_resource = {
						physics_research = 10
						society_research = 10
						engineering_research = 10
					}
				}
			}
		}
	}
	ai_weight = {
		weight = 10
	}
}
decision_tec_eco_res_off = {

	enactment_time = 360

	resources = {
		category = decisions
	}
	
	potential = {
		has_modifier = pm_tec_ecoworld_planet
		has_planet_flag = tec_eco_res_on
	}

	effect = {
		custom_tooltip = decision_tec_eco_res_off_effects
		hidden_effect = {
			remove_planet_flag = tec_eco_res_on
		}
	}
	ai_weight = {
		weight = 0
	}
}
