## Possible Deposit Variables ##
# resources, resource and amount
# potential trigger (planet scope)
# blocked_modifier - applied to planet
# constant_modifier - applied to planet always
# station = station class in orbit to gather
# blocker_swap_types = {}
# all_blocker_swap_types = yes/no
# use_weights_for_blocker_swap_types = yes/no
# terraforming_swap_types = { }
# should_swap_deposit_on_terraforming = yes/no
# all_terraforming_swap_types = yes/no
# use_weights_for_terraforming_swap_types = yes/no

# - - - - - - - - - - - - - - - - - - - - - #
# -----------------------------------------------
# Void dwellers
d_tec_arcane_replicator = {
	is_for_colonizable = yes
	icon = "d_station_reactor"
	category = deposit_cat_rare

	potential = { always = no }

	resources = {
		category = planet_deposits
		produces = {
			trigger = {
				owner = {
					NOR = {
						is_hive_empire = yes
						is_machine_empire = yes
					}
				}
			}
			energy = 5
			alloys = 12
			consumer_goods = 15
			
		}
		produces = {
			trigger = {
				owner = {
					is_machine_empire = yes
					has_valid_civic = civic_machine_servitor
				}
			}
			energy = 10
		}
		produces = {
			trigger = {
				owner = {
					OR = {
						is_hive_empire = yes
						is_machine_empire = yes
					}
				}
			}
			energy = 15
			alloys = 12
			
		}
		produces = {
			trigger = {
				owner = {
					tec_is_cyberhive = yes
				}
			}
			energy = 5
		}
		produces = {
			trigger = {
				owner = {
					has_valid_civic = civic_tec_hive_eusocial
				}
			}
			food = 10
		}
		produces = {
			trigger = {
				owner = {
					has_country_flag = tec_organic_trait_machines
				}
			}
			food = 15
		}

		produces = {
			trigger = {
				owner = {
					tec_has_ruler_civic_machine = { cached = yes }
				}
			}
			energy = 5
		}

		produces = {
			trigger = {
				owner = {
					any_owned_pop = {
						has_trait = trait_exotic_metabolism
					}
				}
			}
			exotic_gases = 4
		}

		produces = {
			trigger = {
				owner = {
					is_catalytic_empire = yes
					tec_is_bioarch_empire = yes
				}
			}
			food = 10
		}
		produces = {
			trigger = {
				owner = {
					is_catalytic_empire = yes
					is_machine_empire = yes
				}
			}
			food = 10
		}
		produces = {
			trigger = {
				owner = {
					OR = {
						tec_is_quantum_alloys_empire = yes
						tec_is_cyberarch_empire = yes
					}
				}
			}
			energy = 15
		}
	}

}

d_tec_minor_arcane_replicator = {
	is_for_colonizable = yes
	icon = d_mining_tunnels
	category = deposit_cat_rare

	potential = { always = no }

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				NOR = {
					is_hive_empire = yes
					is_machine_empire = yes
				}
			}
		}
		planet_amenities_add = 10
	}
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				OR = {
					is_hive_empire = yes
					is_machine_empire = yes
				}
			}
		}
		planet_amenities_no_happiness_add = 5
	}

}

# -----------------------------------------------
# Ringworld
d_arcane_generator = {
	is_for_colonizable = yes
	icon = "d_station_reactor"
	category = deposit_cat_rare

	potential = { always = no }

	planet_modifier = {
		planet_amenities_add = 5
	}

	resources = {
		category = planet_deposits
		produces = {
			trigger = {
				planet = {
					owner = {
						has_valid_civic = civic_machine_servitor
					}
				}
			}
			energy = 15
		}
		produces = {
			volatile_motes = @tec_district_rw_sr_upkeep
			energy = @tec_district_rw_upkeep
			multiplier = value:tec_districts_value|TYPE|district_rw_farming|MAX|2|
		}
		produces = {
			trigger = {
				tec_is_unspecced_ringworld = yes
			}
			volatile_motes = @[tec_district_rw_sr_upkeep / 2]
			energy = @[tec_district_rw_upkeep / 2]
			multiplier = value:tec_districts_value|TYPE|district_tec_rw_forge|MAX|2|
		}
		produces = {
			trigger = {
				tec_is_unspecced_ringworld = no
			}
			volatile_motes = @tec_district_rw_sr_upkeep
			energy = @tec_district_rw_upkeep
			multiplier = value:tec_districts_value|TYPE|district_tec_rw_forge|MAX|1|
		}
		inline_script = {
		    script = mod_support/tec_giga_present
		    code = "
		        produces = {
        			volatile_motes = @tec_district_rw_sr_upkeep
        			energy = @tec_district_rw_upkeep
        			multiplier = value:tec_districts_value|TYPE|district_interstellar_alloys|MAX|1|
        		}

		    "
		}

		# rare
		produces = {
			rare_crystals = @tec_district_rw_sr_upkeep
			energy = @tec_district_rw_upkeep
			multiplier = value:tec_districts_value|TYPE|district_tec_rw_replicator|MAX|2|
		}
		produces = {
			trigger = {
				tec_is_unspecced_ringworld = yes
			}
			rare_crystals = @[tec_district_rw_sr_upkeep / 2]
			energy = @[tec_district_rw_upkeep / 2]
			multiplier = value:tec_districts_value|TYPE|district_tec_rw_industry|MAX|2|
		}
		produces = {
			trigger = {
				tec_is_unspecced_ringworld = no
			}
			rare_crystals = @tec_district_rw_sr_upkeep
			energy = @tec_district_rw_upkeep
			multiplier = value:tec_districts_value|TYPE|district_tec_rw_industry|MAX|1|
		}
		produces = {
			rare_crystals = @tec_district_rw_sr_upkeep
			energy = @tec_district_rw_upkeep
			multiplier = value:tec_districts_value|TYPE|district_tec_rw_naval|MAX|1|
		}
		produces = {
			rare_crystals = @tec_district_rw_sr_upkeep
			energy = @tec_district_rw_upkeep
			multiplier = value:tec_districts_value|TYPE|district_tec_rw_trade|MAX|1|
		}
		produces = {
			rare_crystals = @tec_district_rw_sr_upkeep
			energy = @tec_district_rw_upkeep
			multiplier = value:tec_districts_value|TYPE|district_tec_rw_administrative|MAX|1|
		}
		produces = {
			rare_crystals = @tec_district_rw_sr_upkeep
			energy = @tec_district_rw_upkeep
			multiplier = value:tec_districts_value|TYPE|district_tec_rw_administrative_gestalt|MAX|1|
		}
		# gases
		produces = {
			exotic_gases = @tec_district_rw_sr_upkeep
			energy = @tec_district_rw_upkeep
			multiplier = value:tec_districts_value|TYPE|district_rw_generator|MAX|2|
		}
		produces = {
			exotic_gases = @tec_district_rw_sr_upkeep
			energy = @tec_district_rw_upkeep
			multiplier = value:tec_districts_value|TYPE|district_rw_science|MAX|1|
		}
		produces = {
			exotic_gases = @tec_district_rw_sr_upkeep
			energy = @tec_district_rw_upkeep
			multiplier = value:tec_districts_value|TYPE|district_tec_rw_research|MAX|1|
		}
		produces = {
			exotic_gases = @tec_district_rw_sr_upkeep
			energy = @tec_district_rw_upkeep
			multiplier = value:tec_districts_value|TYPE|district_tec_rw_leisure|MAX|1|
		}
		produces = {
			exotic_gases = @tec_district_rw_sr_upkeep
			energy = @tec_district_rw_upkeep
			multiplier = value:tec_districts_value|TYPE|district_tec_rw_maintenance|MAX|1|
		}


		# extra compat gas
		inline_script = {
		    script = mod_support/tec_giga_present
		    code = "
		        produces = {
        			exotic_gases = @tec_district_rw_sr_upkeep
        			energy = @tec_district_rw_upkeep
        			multiplier = value:tec_districts_value|TYPE|district_interstellar_science|MAX|1|
        		}
        		produces = {
        			exotic_gases = @tec_district_rw_sr_upkeep
        			energy = @tec_district_rw_upkeep
        			multiplier = value:tec_districts_value|TYPE|district_penrose_science|MAX|1|
        		}
		    "
		}

		# mix
		produces = {
			rare_crystals = @tec_district_rw_sr_upkeep
			energy = @tec_district_rw_upkeep
			multiplier = value:tec_districts_value|TYPE|district_rw_industrial|MAX|2|
		}
		inline_script = {
		    script = mod_support/tec_giga_present
		    code = "
		        produces = {
        			volatile_motes = @giga_rw_maintenance_sr
        			exotic_gases = @giga_rw_maintenance_sr
        			energy = @giga_rw_maintenance
        			multiplier = value:tec_districts_value|TYPE|district_rw_quberine|MAX|1|
        		}
		    "
		}
		# city
		produces = {
			energy = @tec_district_rw_upkeep
			multiplier = value:tec_districts_value|TYPE|district_rw_city|MAX|1|
		}
		produces = {
			energy = @tec_district_rw_upkeep
			multiplier = value:tec_districts_value|TYPE|district_rw_hive|MAX|1|
		}
		produces = {
			energy = @tec_district_rw_upkeep
			multiplier = value:tec_districts_value|TYPE|district_rw_nexus|MAX|1|
		}
		produces = {
			energy = @tec_district_rw_upkeep
			multiplier = value:tec_districts_value|TYPE|district_tec_rw_refinery|MAX|1|
		}
	}
}

d_tec_rw_minor_structural_damage = {
	is_for_colonizable = yes
	category = deposit_cat_rare_blocker

	potential = { always = no }
	time = 900

	planet_modifier = {
		planet_max_buildings_add = -3
	}

	can_be_cleared = {
		custom_tooltip = {
			fail_text = tec_rw_requires_clearing_minor_tech
			exists = owner
			owner = {
				has_technology = tech_housing_2
			}
		}
	}

	on_cleared = {
		if = {
			limit = {
				owner = {
					has_origin = origin_shattered_ring
				}
			}
			hidden_effect = {
				planet_event = {
					id = tec_rebalance.10111
				}
			}
		}
	}

	drop_weight = {
		weight = 0
	}

	resources = {
		category = planet_deposits
		cost = {
			alloys = 2000
		}
	}
}

d_tec_rw_major_structural_damage = {
	is_for_colonizable = yes
	category = deposit_cat_rare_blocker

	potential = { always = no }
	time = 1200

	can_be_cleared = {
		custom_tooltip = {
			fail_text = tec_rw_requires_clearing_minor_damage
			this = {
				NOT = {
					has_deposit = d_tec_rw_minor_structural_damage
				}
			}
		}
		custom_tooltip = {
			fail_text = tec_rw_requires_clearing_major_tech
			exists = owner
			owner = {
				has_technology = tech_mega_engineering
			}
		}
	}

	planet_modifier = {
		planet_max_buildings_add = -22
	}

	on_cleared = {
		if = {
			limit = {
				owner = {
					has_origin = origin_shattered_ring
				}
			}
			hidden_effect = {
				planet_event = {
					id = tec_rebalance.10112
				}
			}
		}
	}

	drop_weight = {
		weight = 0
	}

	resources = {
		category = planet_deposits
		cost = {
			alloys = 3000
		}
	}
}

d_segment_rubble_1 = {
	is_for_colonizable = yes
	icon = "d_organic_landfill"
	category = deposit_cat_blockers
	time = 360

	potential = { always = no }

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_gestalt = yes
			}
		}
		planet_housing_add = -1
		job_agri_drone_add = -1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_gestalt = no
			}
		}
		planet_housing_add = -1
		job_farmer_add = -1
	}

	resources = {
		category = deposit_blockers
		cost = {
			food = 200
		}
	}
}

d_segment_rubble_2 = {
	is_for_colonizable = yes
	icon = "d_metal_boneyard"
	category = deposit_cat_blockers
	time = 360

	potential = { always = no }

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_gestalt = yes
			}
		}
		planet_housing_add = -1
		job_technician_drone_add = -1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_gestalt = no
			}
		}
		planet_housing_add = -1
		job_technician_add = -1
	}

	resources = {
		category = deposit_blockers
		cost = {
			energy = 200
		}
	}
}

d_segment_rubble_3 = {
	is_for_colonizable = yes
	icon = "d_ruins_medium"
	category = deposit_cat_blockers
	time = 360

	potential = { always = no }

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_gestalt = yes
			}
		}
		planet_housing_add = -1
		job_tec_matterminer_drone_add = -1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_gestalt = no
			}
		}
		planet_housing_add = -1
		job_tec_matterminer_add = -1
	}

	resources = {
		category = deposit_blockers
		cost = {
			minerals = 200
		}
	}
}

# -----------------------------------------------
# Lithoids
d_lithoid_crater = {
	is_for_colonizable = yes
	category = deposit_cat_rare

	icon = d_crater

	potential = {
		exists = owner
		owner = {
			has_origin = origin_lithoid
		}
	}

	planet_modifier = {
		planet_max_districts_add = 6
		district_mining_max = 6
		district_farming_max = -6
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_origin = origin_lithoid 
				owner_main_species = {
					NOT = {
						has_trait = trait_tec_lithoid_sedimentary
					}
				}
			}
		}
		pop_growth_speed = 0.25
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_origin = origin_lithoid 
				owner_main_species = {
					has_trait = trait_tec_lithoid_sedimentary
				}
			}
		}
		planet_pop_assembly_organic_mult = 0.15
	}

	drop_weight = {
		weight = 0
	}
}

d_system_resources = {
	is_for_colonizable = yes
	icon = "d_station_cargo"
	category = deposit_cat_rare

	potential = { always = no }

	# Evolved Sub-habitats give additional District Slots and building slots

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_max_districts_add = 1
		planet_max_buildings_add = 0.5
		mult = solar_system.value:tec_num_subhabitats
	}

	# Major Orbitals give additional District Slots

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_max_districts_add = 0.5
		mult = solar_system.value:num_major_orbitals
	}

	# Non-Resource Orbitals give additional Building Slots

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_max_buildings_add = 0.50
		mult = solar_system.value:num_major_and_minor_orbitals_class|CLASS|generic|
	}

	# Advanced Habitat Capitals get additional District Slots and Building Slots
	# Subhabitats
	triggered_planet_modifier = {
		potential = {
			tec_is_upgraded_habitat = yes
		}
		planet_max_districts_add = 1
		planet_max_buildings_add = 0.5
		mult = solar_system.value:tec_num_subhabitats
	}
	triggered_planet_modifier = {
		potential = {
			tec_is_fully_upgraded_habitat = yes
		}
		planet_max_districts_add = 1
		planet_max_buildings_add = 0.5
		mult = solar_system.value:tec_num_subhabitats
	}

	# Major Orbitals
	triggered_planet_modifier = {
		potential = {
			tec_is_upgraded_habitat = yes
		}
		planet_max_districts_add = 0.25
		mult = solar_system.value:num_major_orbitals
	}

	triggered_planet_modifier = {
		potential = {
			tec_is_fully_upgraded_habitat = yes
		}
		planet_max_districts_add = 0.25
		mult = solar_system.value:num_major_orbitals
	}

	# Minor Orbitals
	triggered_planet_modifier = {
		potential = {
			tec_is_upgraded_habitat = yes
		}
		planet_max_buildings_add = 0.25
		mult = solar_system.value:num_major_and_minor_orbitals_class|CLASS|generic|
	}

	triggered_planet_modifier = {
		potential = {
			tec_is_fully_upgraded_habitat = yes
		}
		planet_max_buildings_add = 0.25
		mult = solar_system.value:num_major_and_minor_orbitals_class|CLASS|generic|
	}

	# Extra Jobs from Order's Outposts
	triggered_planet_modifier = {
		potential = {
			uses_district_set = habitat
			solar_system = {
				any_fleet_in_system = {
					is_ship_size = major_orbital_knights
				}
			}
			exists = owner
			owner = {
				has_origin = origin_toxic_knights
			}
		}
		job_knight_add = 1
		mult = solar_system.value:num_major_orbitals_class|CLASS|knights|
	}

	# Food!
	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_tec_hab_food_max = 1
		tec_subhabitat_food_add = 1
		mult = value:tec_subhabitat_district_value|food|yes|
	}

	custom_tooltip = system_resources_tooltip
}

# The district cap for provided by support habitats is
# 3 Ã— NUM_ORBITALS_TYPE
d_orbital_research = {
	is_for_colonizable = yes
	icon = "d_engineering_research"
	category = deposit_cat_rare

	potential = { always = no }
	# Research Districts
	custom_tooltip = d_orbital_research_tt
	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_hab_science_max = 1
		tec_subhabitat_research_add = 1
		mult = value:habitat_district_value|TYPE|science|
	}
	# No need of the research subhabitat, redundant
}

d_orbital_energy = {
	is_for_colonizable = yes
	icon = "d_satellite_in_orbit"
	category = deposit_cat_rare

	potential = { always = no }
	# Energy Districts
	custom_tooltip = d_orbital_energy_tt
	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_hab_energy_max = 1
		tec_subhabitat_energy_add = 1
		mult = value:habitat_district_value|TYPE|energy|
	}
	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_hab_energy_max = 1
		mult = value:tec_subhabitat_district_value|energy|yes|
	}
}

d_orbital_mining = {
	is_for_colonizable = yes
	icon = "d_mining_station"
	category = deposit_cat_rare

	potential = { always = no }
	custom_tooltip = d_orbital_mining_tt
	# Mining Districts
	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_hab_mining_max = 1
		tec_subhabitat_minerals_add = 1
		mult = value:habitat_district_value|TYPE|mining|
	}
	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_hab_mining_max = 1
		mult = value:tec_subhabitat_district_value|minerals|yes|
	}
}


d_ruined_major_orbital = {
	time = 360
	is_for_colonizable = no
	category = deposit_cat_blockers
	icon = d_ruined_system

	potential = {
		always = no
	}

	planet_modifier = {
		habitability_ceil_add = -0.05
		planet_max_districts_add = -0.5
	}

	triggered_planet_modifier = {
		potential = {
			tec_is_upgraded_habitat = yes
		}
		planet_max_districts_add = -0.25
	}

	triggered_planet_modifier = {
		potential = {
			tec_is_fully_upgraded_habitat = yes
		}
		planet_max_districts_add = -0.25
	}

	resources = {
		category = deposit_blockers
		cost = {
			alloys = 250
		}
	}
}
