# common\deposits\zzzzzzzzz_evolved_special_deposits.txt

# 
# ------------------------------------------------------------
 # --------------- Decay traits
	d_tec_decomposition_robotic = {	# TODO TRAIT
		is_for_colonizable = yes
		category = deposit_cat_rare
		
		icon = d_monument

		potential = {
			always = yes
		}

		resources = {
			category = deposit_blockers
		}
		
		triggered_planet_modifier = {
			potential = {
				exists = owner
				owner = {
					is_gestalt = no
				}
			}
			planet_amenities_mult = 0.025
			mult = planet.tec_decomposed_robots
		}
		
		triggered_planet_modifier = {
			potential = {
				exists = owner
				owner = {
					is_gestalt = yes
				}
			}
			planet_amenities_no_happiness_mult = 0.01
			mult = planet.tec_decomposed_robots
		}

		drop_weight = {
			weight = 0
		}
	}
	d_tec_decomposition_lithoid = {	# TODO TRAIT
		is_for_colonizable = yes
		category = deposit_cat_rare
		
		icon = d_monument

		potential = {
			always = yes
		}

		resources = {
			category = deposit_blockers
		}
		
		triggered_planet_modifier = {
			potential = {
				always = yes
			}
			planet_jobs_minerals_produces_mult = 0.025
			mult = planet.tec_decomposed_lithoids
		}

		drop_weight = {
			weight = 0
		}
	}
	d_tec_decomposition_organic = {	# TODO TRAIT
		is_for_colonizable = yes
		category = deposit_cat_rare
		
		icon = d_monument

		potential = {
			always = yes
		}

		resources = {
			category = deposit_blockers
		}
		
		triggered_planet_modifier = {
			potential = {
				always = yes
			}
			planet_jobs_food_produces_mult = 0.025
			mult = planet.tec_decomposed_organics
		}

		drop_weight = {
			weight = 0
		}
	}
 # /
 # --------------- Panspermia traits
	d_tec_celestial_organic = {	# TODO TRAIT
		is_for_colonizable = yes
		category = deposit_cat_blockers

		icon = d_tempestous_mountain

		potential = { always = no }

		resources = {
			category = deposit_blockers
			cost = {
				energy = 100
			}
		}

		can_be_cleared = {
			always = yes
		}

		on_cleared = {
			if = {	# Smash that xeno thing
				limit = {
					hidden_trigger = {
						exists = owner
						owner = {
							is_homicidal = yes
							NOR = {
								# devouring organics smash it
								AND = {
									has_valid_civic = civic_hive_devouring_swarm
									owner_main_species = {
										is_lithoid = no
									}
								}
								# It could be one of us
								AND = {
									has_trait = trait_tec_celestial_panspermia
									owner_main_species = {
										is_lithoid = no
									}
								}
							}
						}
					}
				}
				custom_tooltip = d_tec_celestial_organic_on_cleared_homicidal_effect
				owner = {
					add_resource = {
						unity = 250
					}
				}
			}
			else_if = {	# Devour it
				limit = {
					hidden_trigger = {
						exists = owner
						owner = {
							has_valid_civic = civic_hive_devouring_swarm
							owner_main_species = {
								is_lithoid = no
							}
							NAND = {
								# It could be one of us
								has_trait = trait_tec_celestial_panspermia
								owner_main_species = {
									is_lithoid = no
								}
							}
						}
					}
				}
				custom_tooltip = d_tec_celestial_organic_on_cleared_devourer_effect
				owner = {
					add_resource = {
						unity = 500
					}
				}
			}
			else = {
				custom_tooltip = d_tec_celestial_organic_on_cleared_effect
				hidden_effect = {
					closest_system = {
						limit = {
							any_system_planet = {
								any_owned_species = {
									has_trait = trait_tec_celestial_panspermia
									is_lithoid = no
								}
							}
						}
						random_system_planet = {
							random_owned_species = {
								limit = {
									has_trait = trait_tec_celestial_panspermia
									is_lithoid = no
								}
								save_event_target_as = tec_clone_this
							}
						}
					}
					if = {
						limit = {
							exists = event_target:tec_clone_this
						}
						create_pop = {
							species = event_target:tec_clone_this
						}
					}
					else = { # Safeguard in case things go wrong
						if = {
							limit = {
								owner_main_species = {
									is_robotic = no
								}
							}
							create_pop = {
								species = planet.owner_main_species
							}
						}
					}
				}
			}
		}
		
		drop_weight = {
			weight = 0
		}
	}
	d_tec_celestial_lithoid = {	# TODO TRAIT
		is_for_colonizable = yes
		category = deposit_cat_blockers

		icon = d_tempestous_mountain

		potential = { always = no }

		resources = {
			category = deposit_blockers
			cost = {
				energy = 100
			}
		}

		can_be_cleared = {
			always = yes
		}

		on_cleared = {
			if = {	# Smash that xeno thing
				limit = {
					hidden_trigger = {
						exists = owner
						owner = {
							is_homicidal = yes
							NOR = {
								# devouring organics smash it
								AND = {
									has_valid_civic = civic_hive_devouring_swarm
									owner_main_species = {
										is_lithoid = yes
									}
								}
								# It could be one of us
								AND = {
									has_trait = trait_tec_celestial_panspermia
									owner_main_species = {
										is_lithoid = yes
									}
								}
							}
						}
					}
				}
				custom_tooltip = d_tec_celestial_lithoid_on_cleared_homicidal_effect
				owner = {
					add_resource = {
						unity = 250
					}
				}
			}
			else_if = {	# Devour it
				limit = {
					hidden_trigger = {
						exists = owner
						owner = {
							has_valid_civic = civic_hive_devouring_swarm
							owner_main_species = {
								is_lithoid = yes
							}
							NAND = {
								# It could be one of us
								has_trait = trait_tec_celestial_panspermia
								owner_main_species = {
									is_lithoid = yes
								}
							}
						}
					}
				}
				custom_tooltip = d_tec_celestial_lithoid_on_cleared_devourer_effect
				owner = {
					add_resource = {
						minerals = 500
					}
				}
			}
			else = {
				custom_tooltip = d_tec_celestial_lithoid_on_cleared_effect
				hidden_effect = {
					closest_system = {
						limit = {
							any_system_planet = {
								any_owned_species = {
									has_trait = trait_tec_celestial_panspermia
									is_lithoid = yes
								}
							}
						}
						random_system_planet = {
							random_owned_species = {
								limit = {
									has_trait = trait_tec_celestial_panspermia
									is_lithoid = yes
								}
								save_event_target_as = tec_clone_this
							}
						}
					}
					if = {
						limit = {
							exists = event_target:tec_clone_this
						}
						create_pop = {
							species = event_target:tec_clone_this
						}
					}
					else = { # Safeguard in case things go wrong
						if = {
							limit = {
								owner_main_species = {
									is_robotic = no
								}
							}
							create_pop = {
								species = planet.owner_main_species
							}
						}
					}
				}
			}
		}
		
		drop_weight = {
			weight = 0
		}
	}
	d_tec_celestial_biomechanical = {	# TODO TRAIT
		is_for_colonizable = yes
		category = deposit_cat_blockers

		icon = d_tempestous_mountain

		potential = { always = no }

		resources = {
			category = deposit_blockers
			cost = {
				energy = 100
			}
		}

		can_be_cleared = {
			always = yes
		}

		on_cleared = {
			if = {	# Smash that xeno thing
				limit = {
					hidden_trigger = {
						exists = owner
						owner = {
							is_homicidal = yes
							NOR = {
								# devouring lithoids smash it
								AND = {
									has_valid_civic = civic_hive_devouring_swarm
									is_lithoid = no
								}
								# It could be one of us
								AND = {
									owner_main_species = {
										tec_is_replicant_species = yes
									}
									has_trait = trait_tec_celestial_panspermia
								}
							}
						}
					}
				}
				custom_tooltip = d_tec_celestial_biomechanical_on_cleared_homicidal_effect
				owner = {
					add_resource = {
						unity = 250
					}
				}
			}
			else_if = {	# Devour it
				limit = {
					hidden_trigger = {
						exists = owner
						owner = {
							has_valid_civic = civic_hive_devouring_swarm
							is_lithoid = no
							NAND = {
								owner_main_species = {
									tec_is_replicant_species = yes
								}
								has_trait = trait_tec_celestial_panspermia
							}
						}
					}
				}
				custom_tooltip = d_tec_celestial_biomechanical_on_cleared_devourer_effect
				owner = {
					add_resource = {
						food = 500
					}
				}
			}
			else = {	# Just open it
				custom_tooltip = d_tec_celestial_biomechanical_on_cleared_effect
				hidden_effect = {
					closest_system = {
						limit = {
							any_system_planet = {
								any_owned_species = {
									has_trait = trait_tec_celestial_panspermia
									tec_is_replicant_species = yes
								}
							}
						}
						random_system_planet = {
							random_owned_species = {
								limit = {
									has_trait = trait_tec_celestial_panspermia
									tec_is_replicant_species = yes
								}
								save_event_target_as = tec_clone_this
							}
						}
					}
					if = {
						limit = {
							exists = event_target:tec_clone_this
						}
						create_pop = {
							species = event_target:tec_clone_this
						}
					}
					else = { # Safeguard in case things go wrong
						# Yes, even robots
						create_pop = {
							species = planet.owner_main_species
						}
					}
				}
			}
		}
		
		drop_weight = {
			weight = 0
		}
	}
 # /
# /
# PENDING ORGANIZATION
# - - - - - - - - - - - - - - - - - - - - - #
	d_tec_previous_ruins = {
		is_for_colonizable = yes
		icon = "d_station_reactor"
		category = deposit_cat_rare

		potential = { always = no }
	}

	d_tec_underground_biocomplex = {
		is_for_colonizable = yes
		icon = "d_station_reactor"
		category = deposit_cat_rare

		potential = { always = no }
	}

	# spicy special hidden ones
	d_tec_forbidden_energy = {
		is_for_colonizable = yes
		icon = "d_station_reactor"
		category = deposit_cat_rare

		potential = { always = no }
	}

	d_tec_forbidden_minerals = {
		is_for_colonizable = yes
		icon = "d_station_reactor"
		category = deposit_cat_rare

		potential = { always = no }
	}

	d_tec_forbidden_food = {
		is_for_colonizable = yes
		icon = "d_station_reactor"
		category = deposit_cat_rare

		potential = { always = no }
	}

	# Trait deposits
	d_tec_biomass_deposit = {
		icon = d_tec_underground_hydroponics
		is_for_colonizable = yes
		category = deposit_cat_rare

		potential = { always = no }

		resources = {
			category = planet_deposits
			produces = {
				food = 20
			}
		}
	}

	# Tradition deposits
	d_tec_energy_reserves = {
		icon = "d_station_reactor"
		is_for_colonizable = yes
		category = deposit_cat_rare

		potential = { always = no }

		resources = {
			category = planet_deposits
			produces = {
				energy = 4
			}
		}
	}
# /
# Fixes
# Machine origin X 5 effect add_deposit = d_tec_machine_rubble
	d_tec_machine_rubble = {
		icon = "d_metal_boneyard"
		is_for_colonizable = yes
		category = deposit_cat_rare_blocker
		time = 180

		potential = { always = no }

		planet_modifier = {
			planet_max_buildings_add = -1
		}
		resources = {
			category = deposit_blockers
			cost = {
				minerals = 200
			}
		}
	}

	# Only one
	d_tec_machine_rubble_big = {
		icon = "d_organic_landfill"
		is_for_colonizable = yes
		category = deposit_cat_rare_blocker
		time = 720

		potential = { always = no }

		planet_modifier = {
			planet_max_buildings_add = -25
		}
		resources = {
			category = deposit_blockers
			cost = {
				minerals = 1500
			}
		}

		can_be_cleared = {
			custom_tooltip = {
				fail_text = tec_consol_remove_minor_blockers
				this = {
					NOT = {
						has_deposit = d_tec_machine_rubble
					}
				}
			}
		}
	}
# /
# Psionic ascension deposits
	d_tec_psionic_ascension_zone_1 = {
		is_for_colonizable = yes
		icon = d_psionic_region
		category = deposit_cat_rare

		potential = {
			always = no
		}

		resources = {
			category = planet_deposits
			produces = {
				sr_zro = 0.25
				multiplier = tec_psionic_planet_ascended_pops
			}
		}

		# only provide bonuses to psionics
		triggered_planet_modifier = {
			planet_psionic_jobs_produces_mult = 0.025
			mult = tec_psionic_planet_ascended_pops
		}
	}

	d_tec_psionic_wasteland = {
		is_for_colonizable = yes
		category = deposit_cat_rare_blocker
		time = 720

		potential = { always = no }

		planet_modifier = {
			pop_happiness = -0.02
			planet_max_districts_add = -1
		}
		resources = {
			category = deposit_blockers
			cost = {
				sr_zro = 50
				energy = 100
			}
		}
	}
# /
# Lithoid Special trait
	d_tec_sedimented_lithoids = {
		icon = d_buried_lithoids
		time = 120

		is_for_colonizable = yes
		category = deposit_cat_rare_blocker

		potential = { always = no }

		on_cleared = {
			if = {
				limit = {
					NOT = {
						owner = {
							is_lithoid_empire = yes
							any_owned_species = {
								is_lithoid = yes
								has_trait = trait_tec_lithoid_sedimentary
							}
						}
					}
				}
				owner = { add_resource = { minerals = 300 } }
			}

			if = {
				limit = {
					owner = {
						is_lithoid_empire = yes
						any_owned_species = {
							is_lithoid = yes
							has_trait = trait_tec_lithoid_sedimentary
						}
					}
				}
				# Note: this is done to avoid it being exploited by normal empires
				# with a sedimentary lithoid subspecies
				owner = {
					random_owned_species = {
						limit = {
							has_trait = trait_tec_lithoid_sedimentary
							NOT = {
								has_trait = trait_zombie
							}
						}
						save_event_target_as = tec_lithoid_species
					}
				}
				create_pop = { species = event_target:tec_lithoid_species }
			}
		}

		resources = {
			category = deposit_blockers
			cost = {
				trigger = {
					NOT = { owner = { has_origin = origin_lithoid } }
				}
				energy = 200
			}
			cost = {
				trigger = {
					owner = { has_origin = origin_lithoid }
				}
				minerals = 500
			}
		}

		inline_script = deposits/ai_weight_pop_creating_blocker
	}
# /

# Wastelanders
	d_tec_ruined_science = {
		is_for_colonizable = yes
		category = deposit_cat_blockers
		
		icon = d_ruins_medium

		resources = {
			category = deposit_blockers
			cost = {
				energy = 250
			}
		}

		planet_modifier = {
			planet_max_districts_add = -1
		}

		potential = { always = no }

		can_be_cleared = {
			hidden_trigger = {
				owner = {
					is_ai = no
				}
			}
		}

		on_cleared = {
			custom_tooltip = tec_will_remove_ruins
			planet = {
				remove_building = building_tec_ruined_science
			}
			owner = {
				add_resource = {
					minerals = 500
					alloys = 200
				}
			}
		}
		
		drop_weight = {
			weight = 0
		}
	}

	d_tec_ruined_industry = {
		is_for_colonizable = yes
		category = deposit_cat_blockers
		
		icon = d_station_junk

		resources = {
			category = deposit_blockers
			cost = {
				energy = 250
			}
		}

		planet_modifier = {
			planet_max_districts_add = -1
		}

		potential = { always = no }

		can_be_cleared = {
			hidden_trigger = {
				owner = {
					is_ai = no
				}
			}
		}

		on_cleared = {
			custom_tooltip = tec_will_remove_ruins
			planet = {
				remove_building = building_tec_ruined_industry
			}
			owner = {
				add_resource = {
					minerals = 500
					alloys = 200
				}
			}
		}
		
		drop_weight = {
			weight = 0
		}
	}

	d_tec_ruined_civillian = {
		is_for_colonizable = yes
		category = deposit_cat_blockers
		
		icon = d_city_ruins

		resources = {
			category = deposit_blockers
			cost = {
				energy = 250
			}
		}

		planet_modifier = {
			planet_max_districts_add = -1
		}

		potential = { always = no }


		on_cleared = {
			custom_tooltip = tec_will_remove_ruins
			planet = {
				remove_building = building_tec_ruined_civillian
			}
			owner = {
				add_resource = {
					minerals = 500
					alloys = 200
				}
			}
		}
		
		drop_weight = {
			weight = 0
		}


		ai_weight = {
			weight = 100 # this is not a good building clear ai
		}
	}
# /

# Others
	d_tec_underground_hydroponics = {
		is_for_colonizable = yes
		use_for_min_max_adjustments = yes
		
		category = deposit_cat_food
		
		use_weights_for_terraforming_swap_types = no
		should_swap_deposit_on_terraforming = no
		
		potential = {
			always = no
		}
		
		planet_modifier = {
			district_farming_max = 3
		}
		
		drop_weight = {
			weight = 0
		}
	}
# /


# Debug deposits
	d_tec_planetsize_checker = {
		is_for_colonizable = yes
		icon = d_psionic_region
		category = deposit_cat_energy

		potential = {
			always = no
		}

		# only provide bonuses to psionics
		planet_modifier = {
			planet_max_districts_add = -1
		}
	}
# /

d_tec_centrality_consolidated_infrastructure = {
	is_for_colonizable = yes
	icon = d_central_spire
	category = deposit_cat_rare

	potential = {
		always = no
	}

	triggered_planet_modifier = {
		planet_resettlement_unemployed_mult = 0.25
		planet_max_districts_add = 3
	}

	triggered_planet_modifier = { # should encourage immigration to capital
		potential = {
			exists = owner
			owner = {
				is_regular_empire = yes
				is_individual_machine = no
				tec_country_uses_assembly_instead_of_growth = no
			}
		}
		pop_growth_speed = 0.1
		pop_growth_from_immigration = 0.25
		planet_immigration_pull_add = 10
	}

	triggered_planet_modifier = { # hives cannot steal growth from other empires
		potential = {
			exists = owner
			owner = {
				is_hive_empire = yes
				tec_country_uses_assembly_instead_of_growth = no
			}
		}
		pop_growth_speed = 0.2
	}

	triggered_planet_modifier = { # give oragnic assembly to those who need it
		potential = {
			exists = owner
			owner = {
				tec_country_uses_assembly_instead_of_growth = yes
			}
		}
		planet_pop_assembly_organic_mult = 0.1
	}

	triggered_planet_modifier = { # machines smh
		potential = {
			exists = owner
			owner = {
				OR = {
					is_machine_empire = yes
					is_individual_machine = yes
				}
			}
		}
		planet_pop_assembly_mult = 0.1
	}

	inline_script = {
		script = modifiers/tec_district_upkeep_modifiers
		count = 0.1
		mult = 1
		trigger = ""
	}

	triggered_planet_modifier = {
		potential = {
			tec_is_habitat = yes
		}
		planet_max_districts_add = -1
	}

	triggered_planet_modifier = {
		potential = {
			OR = {
				tec_is_modded_space_arcology = yes
				tec_is_elysium = yes
				tec_is_ringworld = yes
			}
		}
		planet_max_districts_add = -2
	}

	inline_script = {
		script = jobs/tec_politician
		count = 2
		mult = 1
		trigger = ""
		display = no_desc
	}

	inline_script = {
		script = jobs/tec_synapse
		count = 4
		mult = 1
		trigger = ""
		display = no_desc
	}

	inline_script = {
		script = jobs/tec_coordinator
		count = 4
		mult = 1
		trigger = ""
		display = no_desc
	}
}