# cui/cult/tec_cult_option_button_effect.txt

inline_script = {
    script = tec_type_hint
    tec_cult = $name$
    tec_cult_category = $category$
    country_trigger_block = "$potential$"
}

tec_cui_cult_$name$_background_effect = {
    potential = {
        exists = from
        from = {
            has_country_flag = tec_cui_cult_$category$_tab_active
            $potential$
        }
    }

    allow = {
        if = {
            limit = {
                from = {
                    tec_has_cult = {
                        cult = $name$
                    }
                }
            }
            always = yes
        } else = {
            from = {
                tec_has_cult_points_available = yes
                tec_is_cult_allowed = {
                    cult = $name$
                }
            }
        }
    }
}

tec_cui_cult_$name$_glow_effect = {
    potential = {
        exists = from
        from = {
            has_country_flag = tec_cui_cult_$category$_tab_active
            tec_has_cult = {
                cult = $name$
            }
        }
    }

    allow = {
        always = yes
    }
}
tec_cui_cult_$name$_button_effect_allowed = {
    potential = {
        from = {
            has_country_flag = tec_cui_cult_$category$_tab_active
            $potential$
        }
        from = {
            OR = {
                tec_has_cult = {
                    cult = $name$
                }
                AND = {
                    tec_has_cult_points_available = yes
                    tec_is_cult_allowed = {
                        cult = $name$
                    }
                }
            }
        }
    }

    allow = {
        tec_cui_has_pending_cult_decision = no
    }

    effect = {
        inline_script = {
            script = cui/cult/tec_cult_option_button_effect_tooltip
            name = $name$
            from = from
            skip_header = no
        }
    }
}

tec_cui_cult_$name$_button_effect_not_enough_points = {
    potential = {
        exists = from
        from = {
            has_country_flag = tec_cui_cult_$category$_tab_active
            $potential$
        }
        from = {
            NOT = {
                tec_has_cult = {
                    cult = $name$
                }
            }
            tec_has_cult_points_available = no
            tec_is_cult_allowed = {
                cult = $name$
            }
        }
    }

    allow = {
        tec_cui_has_pending_cult_decision = no
    }

    effect = {
        tooltip = {
            inline_script = {
                script = cui/cult/tec_cult_option_button_effect_tooltip
                name = $name$
                from = from
                skip_header = no
            }
        }
        custom_tooltip = tec_cui_cult_tooltip_not_enough_points
    }
}


tec_cui_cult_$name$_button_effect_disallowed = {
    potential = {
        exists = from
        from = {
            has_country_flag = tec_cui_cult_$category$_tab_active
            $potential$
        }
        from = {
            NOT = {
                tec_has_cult = {
                    cult = $name$
                }
            }
            NOT = {
                tec_is_cult_allowed = {
                    cult = $name$
                }
            }
        }
    }

    allow = {
        custom_tooltip = tec_cult_$name$_header
        custom_tooltip = tec_cult_$name$_desc
        custom_tooltip = tec_loc_desc_separator
        from = {
            tec_is_cult_allowed = {
                cult = $name$
            }
        }
    }
    effect = {
        tooltip = {
            inline_script = {
                script = cui/cult/tec_cult_option_button_effect_tooltip
                name = $name$
                from = from
                skip_header = no
            }
        }
    }
}