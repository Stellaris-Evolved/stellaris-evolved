# common\ai_budget\zze_ow_alloys_budgets.txt

alloys_expenditure_habitats = {
	resource = alloys
	type = expenditure
	category = megastructures_habitat

	potential = { ai_should_build_habitats = yes }

	weight = {
		weight = 0.2
		modifier = {
			factor = 2.5
			is_void_dweller_empire = yes
		}
		modifier = {
			factor = 2
			is_void_dweller_empire = yes
			count_owned_planet = {
				limit = { is_planet_class = pc_habitat }
				count < 4
			}
		}
		modifier = {
			factor = 2
			is_void_dweller_empire = yes
			count_owned_planet = {
				limit = { is_planet_class = pc_habitat }
				count < 6
			}
		}
		modifier = {
			factor = 5
			mid_game_years_passed > 0
			num_owned_planets < 12
		}
		modifier = {
			factor = 0.5
			has_trait = trait_aquatic
		}
		modifier = { #Build fortress habitats
			factor = 2
			used_naval_capacity_percent > 0.95
			used_starbase_capacity_percent >= 1
		}
		modifier = {
			factor = 0.5
			is_at_war = yes
		}
	}

	desired_min = {
		base = 1000
	}
	desired_max = {	# Tweaked for evolved costs
		base = 2500
	}
}

#Specific budget for starbases for either biohive or organic architecture but not both at the same time
alloys_expenditure_starbases_biohive_OR_food_building = {
	resource = alloys
	type = expenditure
	category = starbases

	potential = {
		NOT = {
			is_country_type = fallen_empire
		}
		OR = {
			tec_is_biohive = yes
			tec_uses_food_buildings = yes
		}
		NOT = {
			tec_is_biohive = yes
			tec_uses_food_buildings = yes
		}
	}

	weight = {
		weight = 0.4
	}
	desired_max = {
		base = 12000
	}
}

#Specific budget for modules when full conversion
alloys_expenditure_starbases_food_user_biohive = {
	resource = alloys
	type = expenditure
	category = starbases

	potential = {
		NOT = {
			is_country_type = fallen_empire
		}
		tec_is_biohive = yes
		tec_uses_food_buildings = yes
	}

	weight = {
		weight = 0.2
	}
	desired_max = {
		base = 1000
	}
}

#added to make sure ais with low alloy income don't get stuck trying to build stuff evolved forces them to
alloys_expenditure_planets = {
	resource = alloys
	type = expenditure
	category = planets

	potential = {
		always = yes
	}

	weight = {
		weight = 0.2
	}

	desired_min = {
		base = 500
	}

	desired_max = {
		base = 5000
	}
}

alloys_expenditure_colonies_expand = {
	resource = alloys
	type = expenditure
	category = colonies

	potential = {
		OR = {
			is_at_war = no
			mid_game_years_passed > 0
		}
		ai_colonize_plans > 0
		OR = {
			AND = {
				is_lithoid_empire = no
				has_resource = { type = food amount > 400 }
				has_monthly_income = {
					resource = food
					value > 0
				}
			}
			AND = {
				is_lithoid_empire = yes
				has_resource = { type = minerals amount > 400 }
				has_monthly_income = {
					resource = minerals
					value > 0
				}
			}
			AND = {
				is_robot_empire = yes
				has_resource = { type = energy amount > 400 }
				has_monthly_income = {
					resource = energy
					value > 0
				}
			}
		}
	}

	weight = {
		weight = 0.5
	}
	desired_min = {
		base = 0
		modifier = {
			add = @colony_cost_base
			is_guided_sapience_empire = no
			is_virtual_empire = no
		}
		modifier = {
			add = @colony_cost_low
			is_guided_sapience_empire = no
			is_virtual_empire = yes
		}
		modifier = {
			add = @colony_cost_mid
			is_guided_sapience_empire = yes
			is_virtual_empire = no
		}
		modifier = {
			add = @colony_cost_base
			is_guided_sapience_empire = yes
			is_virtual_empire = yes
		}
		modifier = {
			add = @colony_cost_very_low
			is_void_dweller_empire = yes
			NOT = { has_ascension_perk = ap_voidborn } # do not penalize voidborn
			NOT = {
				has_country_flag = tec_void_dweller_colonization_on
			}
		}
		modifier = {
			add = @colony_cost_very_low
			is_void_dweller_empire = yes
			NOT = { has_ascension_perk = ap_voidborn } # do not penalize voidborn
			NOT = {
				has_active_tradition = tr_tec_outreach_final_3_vd
			}
		}
		modifier = {
			mult = 0.5
			has_origin = origin_tree_of_life
		}
	}

	desired_max = {
		base = 0
		modifier = {
			add = @colony_cost_base_max
			is_guided_sapience_empire = no
			is_virtual_empire = no
		}
		modifier = {
			add = @colony_cost_low_max
			is_guided_sapience_empire = no
			is_virtual_empire = yes
		}
		modifier = {
			add = @colony_cost_mid_max
			is_guided_sapience_empire = yes
			is_virtual_empire = no
		}
		modifier = {
			add = @colony_cost_base_max
			is_guided_sapience_empire = yes
			is_virtual_empire = yes
		}
		modifier = {
			add = @colony_cost_very_low
			is_void_dweller_empire = yes
			NOT = { has_ascension_perk = ap_voidborn } # do not penalize voidborn
			NOT = {
				has_country_flag = tec_void_dweller_colonization_on
			}
		}
		modifier = {
			add = @colony_cost_very_low
			is_void_dweller_empire = yes
			NOT = { has_ascension_perk = ap_voidborn } # do not penalize voidborn
			NOT = {
				has_active_tradition = tr_tec_outreach_final_3_vd
			}
		}
		modifier = {
			mult = 0.5
			has_origin = origin_tree_of_life
		}
	}
}


#Stop spending on ships if we can't afford it
#There is a problem with AI that will cause it to sell a ton of stuff just in order to buy a few alloys
#Evolved exacerbates this issue due to naval cap jobs requiring alloys
alloys_expenditure_ships = {
	resource = alloys
	type = expenditure
	category = ships

	potential = {
		always = yes
	}

	weight = {
		weight = 0.6

		# spend more alloys building ships while at war
		modifier = {
			factor = 2
			OR = {
				recently_lost_war = yes
				is_at_war = yes
			}
		}

		# If we want to colonize and are at peace then prio that
		modifier = {
			factor = 0.25
			AND = {
				ai_colonize_plans > 0
				is_at_war = no
			}
		}

		# spend less alloys on ships if over capacity
		modifier = {
			factor = 0.5
			used_naval_capacity_percent >= 1.0
		}
		modifier = { # It's time to stop
			factor = 0
			used_naval_capacity_percent >= 1.5
			OR = {
				is_at_war = no
				NOT = {
					any_country = {
						is_crisis_faction = yes
					}
				}
			}
		}

		modifier = {
			factor = 5
			used_naval_capacity_percent < 0.8
			OR = {
				any_neighbor_country = {
					has_ascension_perk = ap_become_the_crisis
				}
				any_country = {
					is_crisis_faction = yes
				}
			}
		}

		#Don't allocate if poor
		#This also allows for a bit more things to be done before investing into ships, such as boosting buildings that cost alloys and starbase modules, which is better than the endless drain of ships preventing other things from happening
		#If the AI was bound to get more ships, it will get them anyways so that's why this is pretty safe
		modifier = {
			factor = 0
			OR = {
				has_resource = { type = alloys amount < 800 }
				has_monthly_income = {
					resource = alloys
					value < 14
				}
			}
		}
	}
}