# events\zz_evolved_rebuild_events.txt

namespace = unity_patrons

planet_event = {
	id = unity_patrons.1
	hide_window = yes
	is_triggered_only = yes
	location = ROOT 
	
	trigger = {
		root = {
			space_owner = {
				has_valid_civic = civic_tec_regular_universalism
			}
		}
	}

	immediate = {
		space_owner = {
			add_modifier = {
				modifier = modifier_tec_unity_patrons
				days = 3650
			}
		}
	
	}
	
}


namespace = modifier_tec_glorious_fleet

# This = owner of fleet 1 (combatant)
# From = owner of fleet 2 (destroyed)
# FromFrom = fleet 1
# FromFromFrom = fleet 2

country_event = {
	id = modifier_tec_glorious_fleet.0
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		has_valid_civic = civic_tec_regular_naval_traditions
		not = { has_country_flag = modifier_tec_glorious_fleet }
		not = { has_country_flag = unmodifier_tec_glorious_fleet }
	}

	immediate = {
		add_modifier = {
			modifier = "modifier_tec_glorious_fleet"
			days = 30
		}
		set_timed_country_flag = {
			flag = modifier_tec_glorious_fleet
			days = 30 
		}
	}
	
}


# This = owner of fleet 1 (destroyed)
# From = owner of fleet 2 (combatant)
# FromFrom = fleet 1
# FromFromFrom = fleet 2

country_event = {
	id = modifier_tec_glorious_fleet.1
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		has_valid_civic = civic_tec_regular_naval_traditions
		not = { has_country_flag = modifier_tec_glorious_fleet }
		not = { has_country_flag = unmodifier_tec_glorious_fleet }
	}

	immediate = {
		add_modifier = {
			modifier = "unmodifier_tec_glorious_fleet"
			days = 30
		}
		set_timed_country_flag = {
			flag = unmodifier_tec_glorious_fleet
			days = 30 
		}
	}
}

namespace = voice_planet

planet_event = {
	id = voice_planet.1	
	hide_window = yes
	is_triggered_only = yes
	location = ROOT 

	immediate = {
		if = {
			limit = {
				has_modifier = "dangerous_wildlife"
			}
			remove_modifier = "dangerous_wildlife"
		}
				
		if = {
			limit = {
				has_modifier = "bleak_planet"
			}
			remove_modifier = "bleak_planet"
		}
		
		if = {
			limit = {
				has_modifier = "hazardous_weather"
			}
			remove_modifier = "hazardous_weather"
		}
		if = {
			limit = {
				has_modifier = "wild_storms"
			}
			remove_modifier = "wild_storms"
		}
	}
}

planet_event = {
	id = voice_planet.2	
	hide_window = yes
	is_triggered_only = yes
	location = ROOT 

	immediate = {
		if = {
			limit = {
				has_modifier = "unstable_tectonics"
			}
			remove_modifier = "unstable_tectonics"
		}
		if = {
			limit = {
				has_modifier = "weak_magnetic_field"
			}
			remove_modifier = "weak_magnetic_field"
		}
		if = {
			limit = {
				has_modifier = "tidal_locked"
			}
			remove_modifier = "tidal_locked"
		}
		if = {
			limit = {
				has_modifier = "irradiated_planet"
			}
			remove_modifier = "irradiated_planet"
		}
		if = {
			limit = {
				has_modifier = "damaged_ecology"
			}
			remove_modifier = "damaged_ecology"
		}
		if = {
			limit = {
				has_modifier = "wasteland_radiation"
			}
			remove_modifier = "wasteland_radiation"
		}
			
		if = {
			limit = {
				has_modifier = "abandoned_terraforming"
			}
			remove_modifier = "abandoned_terraforming"
		}
	}
}

namespace = archivist

#Archivistcheck
country_event = {
	id = archivist.0
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		AND = {
			OR = {
				AND = {
					has_civic = civic_tec_regular_archivist
					NOT = {	has_valid_civic = civic_tec_regular_archivist}
				}
				NOT = {	has_civic = civic_tec_regular_archivist }
			}
			OR = {
				has_modifier = "modifier_tec_archivist_0"
				has_modifier = "modifier_tec_archivist_1"
				has_modifier = "modifier_tec_archivist_2"
				has_modifier = "modifier_tec_archivist_3"
				has_modifier = "modifier_tec_archivist_4"
				has_modifier = "modifier_tec_archivist_5"
			}
		}

	}

	immediate = {
		remove_modifier = "modifier_tec_archivist_0"
		remove_modifier = "modifier_tec_archivist_1"
		remove_modifier = "modifier_tec_archivist_2"
		remove_modifier = "modifier_tec_archivist_3"
		remove_modifier = "modifier_tec_archivist_4"
		remove_modifier = "modifier_tec_archivist_5"
	}
}

country_event = {
	id = archivist.1
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		has_valid_civic = civic_tec_regular_archivist	
	}

	immediate = {
		if = {
			limit = {
				OR = {
					count_country = {
						limit = {
							exists = this
							root.owner = { has_research_agreement = prev }
						}
						count < 1
					}
					owner = {
						has_federation = yes
						federation = {
							has_federation_type = research_federation
						}
						count_federation_ally = {
							count < 1
						}
					}
				}
				
				NOT = {
					has_modifier = "modifier_tec_archivist_0"
				}
			}
			add_modifier = {
				modifier = "modifier_tec_archivist_0"
				days = -1
			}
			remove_modifier = "modifier_tec_archivist_1"
			remove_modifier = "modifier_tec_archivist_5"
			remove_modifier = "modifier_tec_archivist_2"
			remove_modifier = "modifier_tec_archivist_3"
			remove_modifier = "modifier_tec_archivist_4"
		}
		else_if = {
			limit = {
				OR = {
					count_country = {
						limit = {
							exists = this
							root.owner = { has_research_agreement = prev }
						}
						count = 1
					}
					owner = {
						has_federation = yes
						federation = {
							has_federation_type = research_federation
						}
						count_federation_ally = {
							count = 1
						}
					}
				}
				NOT = {
					has_modifier = "modifier_tec_archivist_1"
				}
				
			}
			add_modifier = {
				modifier = "modifier_tec_archivist_1"
				days = -1
			}
			remove_modifier = "modifier_tec_archivist_0"
			remove_modifier = "modifier_tec_archivist_5"
			remove_modifier = "modifier_tec_archivist_2"
			remove_modifier = "modifier_tec_archivist_3"
			remove_modifier = "modifier_tec_archivist_4"
		}


		else_if = {
			limit = {
				OR = {
					count_country = {
						limit = {
							exists = this
							root.owner = { has_research_agreement = prev }
						}
						count = 2
					}
					owner = {
						has_federation = yes
						federation = {
							has_federation_type = research_federation
						}
						count_federation_ally = {
							count = 2
						}
					}
				}
				NOT = {
					has_modifier = "modifier_tec_archivist_2"
				}
			}
			add_modifier = {
				modifier = "modifier_tec_archivist_2"
				days = -1
			}
			remove_modifier = "modifier_tec_archivist_0"
			remove_modifier = "modifier_tec_archivist_5"
			remove_modifier = "modifier_tec_archivist_1"
			remove_modifier = "modifier_tec_archivist_3"
			remove_modifier = "modifier_tec_archivist_4"
		}
		else_if = {
			limit = {
				OR = {
					count_country = {
						limit = {
							exists = this
							root.owner = { has_research_agreement = prev }
						}
						count = 3
					}
					owner = {
						has_federation = yes
						federation = {
							has_federation_type = research_federation
						}
						count_federation_ally = {
							count = 3
						}
					}
				}
				NOT = {
					has_modifier = "modifier_tec_archivist_3"
				}
			}
			add_modifier = {
				modifier = "modifier_tec_archivist_3"
				days = -1
			}
			remove_modifier = "modifier_tec_archivist_0"
			remove_modifier = "modifier_tec_archivist_5"
			remove_modifier = "modifier_tec_archivist_2"
			remove_modifier = "modifier_tec_archivist_1"
			remove_modifier = "modifier_tec_archivist_4"
		}
		else_if = {
			limit = {
				OR = {
					count_country = {
						limit = {
							exists = this
							root.owner = { has_research_agreement = prev }
						}
						count = 4
					}
					owner = {
						has_federation = yes
						federation = {
							has_federation_type = research_federation
						}
						count_federation_ally = {
							count = 4
						}
					}
				}
				NOT = {
					has_modifier = "modifier_tec_archivist_4"
				}
			}
			add_modifier = {
				modifier = "modifier_tec_archivist_4"
				days = -1
			}
			remove_modifier = "modifier_tec_archivist_0"
			remove_modifier = "modifier_tec_archivist_5"
			remove_modifier = "modifier_tec_archivist_2"
			remove_modifier = "modifier_tec_archivist_3"
			remove_modifier = "modifier_tec_archivist_1"
		}
		else_if = {
			limit = {
				OR = {
					count_country = {
						limit = {
							exists = this
							root.owner = { has_research_agreement = prev }
						}
						count > 4
					}
					owner = {
						has_federation = yes
						federation = {
							has_federation_type = research_federation
						}
						count_federation_ally = {
							count > 4
						}
					}
				}
				NOT = {
					has_modifier = "modifier_tec_archivist_5"
				}
			}
			add_modifier = {
				modifier = "modifier_tec_archivist_5"
				days = -1
			}
			remove_modifier = "modifier_tec_archivist_0"
			remove_modifier = "modifier_tec_archivist_1"
			remove_modifier = "modifier_tec_archivist_2"
			remove_modifier = "modifier_tec_archivist_3"
			remove_modifier = "modifier_tec_archivist_4"
		}
	}
}

### EVANGELISM / PROPAGANDA
namespace = tec_evangelist

#Start Evangalizing
country_event = {
	id = tec_evangelist.1
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		OR = {
			has_policy_flag = diplo_stance_evangelist	
			has_policy_flag = diplo_stance_propaganda
		}
	
	}
	immediate = {
		every_country = {
			limit = {
				root = {
					is_improving_relations_with = root
				}
				NOT = {
					has_modifier = protected_from_evangelism
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_authoritarian
					}
				}
				add_modifier = {
					modifier = authoritarian_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_authoritarian
					}
				}
				add_modifier = {
					modifier = authoritarian_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_egalitarian
					}
				}
				add_modifier = {
					modifier = egalitarian_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_egalitarian
					}
				}
				add_modifier = {
					modifier = egalitarian_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_materialist
					}
				}
				add_modifier = {
					modifier = materialist_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_materialist
					}
				}
				add_modifier = {
					modifier = materialist_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_militarist
					}
				}
				add_modifier = {
					modifier = militarist_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_militarist
					}
				}
				add_modifier = {
					modifier = militarist_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_pacifist
					}
				}
				add_modifier = {
					modifier = pacifist_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_pacifist
					}
				}
				add_modifier = {
					modifier = pacifist_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_spiritualist
					}
				}
				add_modifier = {
					modifier = spiritualist_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_spiritualist
					}
				}
				add_modifier = {
					modifier = spiritualist_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_xenophile
					}
				}
				add_modifier = {
					modifier = xenophile_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_xenophile
					}
				}
				add_modifier = {
					modifier = xenophile_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_xenophobe
					}
				}
				add_modifier = {
					modifier = xenophobe_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_xenophobe
					}
				}
				add_modifier = {
					modifier = xenophobe_evangelist
					days = 360
				}
			}
		}
		every_country = {
			limit = {
				root = {
					is_harming_relations_with = prev					
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_authoritarian
					}
				}
				add_modifier = {
					modifier = fanatic_authoritarian_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_egalitarian
					}
				}
				add_modifier = {
					modifier = fanatic_egalitarian_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_materialist
					}
				}
				add_modifier = {
					modifier = fanatic_materialist_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_militarist
					}
				}
				add_modifier = {
					modifier = fanatic_militarist_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_pacifist
					}
				}
				add_modifier = {
					modifier = fanatic_pacifist_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_spiritualist
					}
				}
				add_modifier = {
					modifier = fanatic_spiritualist_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_xenophile
					}
				}
				add_modifier = {
					modifier = fanatic_xenophile_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_xenophobe
					}
				}
				add_modifier = {
					modifier = fanatic_xenophobe_evangelist
					days = 360
				}
			}
 #cultural overhaul ethos
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_ecologist
					}
				}
				add_modifier = {
					modifier = fanatic_ecologist_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_ecologist
					}
				}
				add_modifier = {
					modifier = ecologist_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_industrialist
					}
				}
				add_modifier = {
					modifier = fanatic_industrialist_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_industrialist
					}
				}
				add_modifier = {
					modifier = industrialist_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_cooperative
					}
				}
				add_modifier = {
					modifier = fanatic_cooperative_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_cooperative
					}
				}
				add_modifier = {
					modifier = cooperative_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_competitive
					}
				}
				add_modifier = {
					modifier = fanatic_competitive_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_competitive
					}
				}
				add_modifier = {
					modifier = competitive_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_elitist
					}
				}
				add_modifier = {
					modifier = fanatic_elitist_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_elitist
					}
				}
				add_modifier = {
					modifier = elitist_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_fanatic_pluralist
					}
				}
				add_modifier = {
					modifier = fanatic_pluralist_evangelist
					days = 360
				}
			}
			if = {
				limit = {
					root = {
						has_ethic = ethic_pluralist
					}
				}
				add_modifier = {
					modifier = pluralist_evangelist
					days = 360
				}
			}


		}
		country_event ={
			id = tec_evangelist.1
			days = 360
		}
	}
}

#Not want evangelism
country_event = {
	id = tec_evangelist.2
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		OR = {
			has_policy_flag = evangelism_rejected_policy
		}
	
	}
	immediate = {
		hidden_effect = {
			if = {
				limit = { has_policy_flag = evangelism_rejected_policy }
				add_modifier = { modifier = "protected_from_evangelism" days = -1 }
				#1
				remove_modifier = spiritualist_evangelist
				remove_modifier = fanatic_spiritualist_evangelist

				remove_modifier = materialist_evangelist
				remove_modifier = fanatic_materialist_evangelist
				#2
				remove_modifier = xenophobe_evangelist
				remove_modifier = fanatic_xenophobe_evangelist

				remove_modifier = xenophile_evangelist
				remove_modifier = fanatic_xenophile_evangelist
				#3
				remove_modifier = militarist_evangelist
				remove_modifier = fanatic_militarist_evangelist

				remove_modifier = pacifist_evangelist
				remove_modifier = fanatic_pacifist_evangelist
				#4
				remove_modifier = authoritarian_evangelist
				remove_modifier = fanatic_authoritarian_evangelist
				
				remove_modifier = egalitarian_evangelist
				remove_modifier = fanatic_egalitarian_evangelist
				#5
				remove_modifier = fanatic_ecologist_evangelist
				remove_modifier = ecologist_evangelist

				remove_modifier = industrialist_evangelist
				remove_modifier = fanatic_industrialist_evangelist
				#6
				remove_modifier = cooperative_evangelist
				remove_modifier = fanatic_cooperative_evangelist

				remove_modifier = competitive_evangelist
				remove_modifier = fanatic_competitive_evangelist
				#7
				remove_modifier = pluralist_evangelist
				remove_modifier = fanatic_pluralist_evangelist

				remove_modifier = elitist_evangelist
				remove_modifier = fanatic_elitist_evangelist
				#8
			}
			if = {
				limit = { has_policy_flag = evangelism_accepted_policy }
				remove_modifier = protected_from_evangelism }
			}
		}
}

namespace = tec_protoworld

# District built
planet_event = {
	id = tec_protoworld.1
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		uses_district_set = tec_protoworld
	}

	immediate = {
		switch = {
			trigger = last_district_changed
			district_tec_proto_city = {
				change_variable = {
					which = tec_proto_city
					value = 1
				}
			}
			district_tec_proto_generator = {
				change_variable = {
					which = tec_proto_hot
					value = 1
				}
			}
			district_tec_proto_mining = {
				change_variable = {
					which = tec_proto_cold
					value = 1
				}
			}
			district_tec_proto_farming = {
				change_variable = {
					which = tec_proto_wet
					value = 1
				}
			}
			# biohives will come here
			#default = {
			#}
		}

		# Announces/Trigger the changes
		if = {
			limit = {
				check_variable = {
					which = tec_proto_city
					value = 10
				}
			}
			set_planet_flag = tec_protoworld_changing_city
			# Announces the world is ready to become a ecumenopolis
			# > event here
		}
		else_if = {
			limit = {
				check_variable = {
					which = tec_proto_hot
					value = 3
				}
				NOT = {
					has_planet_flag = tec_protoworld_changing_hot_1
				}
			}
			planet_event = {
				id = tec_protoworld.5
				days = @tec_proto_timer_1
			}
			planet_event = {
				id = tec_protoworld.10
				days = @tec_proto_timer_1
			}
		}
		else_if = {
			limit = {
				check_variable = {
					which = tec_proto_hot
					value = 6
				}
				NOT = {
					has_planet_flag = tec_protoworld_changing_hot_2
				}
			}
			planet_event = {
				id = tec_protoworld.5
				days = @tec_proto_timer_2
			}
			planet_event = {
				id = tec_protoworld.10
				days = @tec_proto_timer_2
			}
		}
		else_if = {
			limit = {
				check_variable = {
					which = tec_proto_hot
					value = 8
				}
				NOT = {
					has_planet_flag = tec_protoworld_changing_hot_3
				}
			}
			planet_event = {
				id = tec_protoworld.5
				days = @tec_proto_timer_2
			}
			planet_event = {
				id = tec_protoworld.10
				days = @tec_proto_timer_2
			}
		}


		else_if = {
			limit = {
				check_variable = {
					which = tec_proto_wet
					value = 3
				}
				NOT = {
					has_planet_flag = tec_protoworld_changing_wet_1
				}
			}
			planet_event = {
				id = tec_protoworld.5
				days = @tec_proto_timer_1
			}
			planet_event = {
				id = tec_protoworld.10
				days = @tec_proto_timer_1
			}
		}
		else_if = {
			limit = {
				check_variable = {
					which = tec_proto_wet
					value = 6
				}
				NOT = {
					has_planet_flag = tec_protoworld_changing_wet_2
				}
			}
			planet_event = {
				id = tec_protoworld.5
				days = @tec_proto_timer_2
			}
			planet_event = {
				id = tec_protoworld.10
				days = @tec_proto_timer_2
			}
		}
		else_if = {
			limit = {
				check_variable = {
					which = tec_proto_wet
					value = 8
				}
				NOT = {
					has_planet_flag = tec_protoworld_changing_wet_3
				}
			}
			planet_event = {
				id = tec_protoworld.5
				days = @tec_proto_timer_2
			}
			planet_event = {
				id = tec_protoworld.10
				days = @tec_proto_timer_2
			}
		}


		else_if = {
			limit = {
				check_variable = {
					which = tec_proto_cold
					value = 3
				}
				NOT = {
					has_planet_flag = tec_protoworld_changing_cold_1
				}
			}
			planet_event = {
				id = tec_protoworld.5
				days = @tec_proto_timer_1
			}
			planet_event = {
				id = tec_protoworld.10
				days = @tec_proto_timer_1
			}
		}
		else_if = {
			limit = {
				check_variable = {
					which = tec_proto_cold
					value = 6
				}
				NOT = {
					has_planet_flag = tec_protoworld_changing_cold_2
				}
			}
			planet_event = {
				id = tec_protoworld.5
				days = @tec_proto_timer_2
			}
			planet_event = {
				id = tec_protoworld.10
				days = @tec_proto_timer_2
			}
		}
		else_if = {
			limit = {
				check_variable = {
					which = tec_proto_cold
					value = 8
				}
				NOT = {
					has_planet_flag = tec_protoworld_changing_cold_3
				}
			}
			planet_event = {
				id = tec_protoworld.5
				days = @tec_proto_timer_2
			}
			planet_event = {
				id = tec_protoworld.10
				days = @tec_proto_timer_2
			}
		}
	}
}

# District demolished
planet_event = {
	id = tec_protoworld.2
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		uses_district_set = tec_protoworld
	}

	immediate = {
		switch = {
			trigger = last_district_changed
			district_tec_proto_city = {
				
			}
			district_tec_proto_generator = {
				change_variable = {
					which = tec_proto_hot
					value = -1
				}
			}
			district_tec_proto_mining = {
				change_variable = {
					which = tec_proto_cold
					value = -1
				}
			}
			district_tec_proto_farming = {
				change_variable = {
					which = tec_proto_wet
					value = -1
				}
			}

			# hives will come here
			default = {

			}
		}
	}
}

# Hidden planet changer and announcer
planet_event = {
	id = tec_protoworld.5
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		uses_district_set = tec_protoworld
	}

	immediate = {
		# Hot class
		if = {	# 8
			limit = {
				check_variable = {
					which = tec_proto_hot
					value >= 8
				}
				NOT = {
					has_planet_flag = tec_protoworld_changing_hot_3
				}
			}
			set_planet_flag = tec_protoworld_changing_hot_1
			set_planet_flag = tec_protoworld_changing_hot_2
			set_planet_flag = tec_protoworld_changing_hot_3
			owner = {
				create_message = {
					type = MESSAGE_TEC_PROTO_HOT_3
					localization = MESSAGE_TEC_PROTO_HOT_3
					days = 30
					target = root
					variable = {
						type = name
						localization = PLANET
						scope = root
					}
				}
			}
			planet_event = {
				id = tec_protoworld.100
				days = @tec_proto_random_1
				random = @tec_proto_random_2
			}
		}
		if = {	# 6
			limit = {
				check_variable = {
					which = tec_proto_hot
					value >= 6
				}
				NOT = {
					has_planet_flag = tec_protoworld_changing_hot_2
				}
			}
			set_planet_flag = tec_protoworld_changing_hot_1
			set_planet_flag = tec_protoworld_changing_hot_2
			owner = {
				create_message = {
					type = MESSAGE_TEC_PROTO_HOT_2
					localization = MESSAGE_TEC_PROTO_HOT_2
					days = 30
					target = root
					variable = {
						type = name
						localization = PLANET
						scope = root
					}
				}
			}
			planet_event = {
				id = tec_protoworld.400
				days = @tec_proto_random_11
				random = @tec_proto_random_22
			}
		}
		if = {	# 3
			limit = {
				check_variable = {
					which = tec_proto_hot
					value >= 3
				}
				check_variable = {
					which = tec_proto_hot
					value < 6
				}
				NOT = {
					has_planet_flag = tec_protoworld_changing_hot_1
				}
			}
			set_planet_flag = tec_protoworld_changing_hot_1
			owner = {
				create_message = {
					type = MESSAGE_TEC_PROTO_HOT_1
					localization = MESSAGE_TEC_PROTO_HOT_1
					days = 30
					target = root
					variable = {
						type = name
						localization = PLANET
						scope = root
					}
				}
			}
		}
	
		# Wet class
		if = {	# 8
			limit = {
				check_variable = {
					which = tec_proto_wet
					value >= 8
				}
				NOT = {
					has_planet_flag = tec_protoworld_changing_wet_23
				}
			}
			set_planet_flag = tec_protoworld_changing_wet_1
			set_planet_flag = tec_protoworld_changing_wet_2
			set_planet_flag = tec_protoworld_changing_wet_3
			owner = {
				create_message = {
					type = MESSAGE_TEC_PROTO_WET_3
					localization = MESSAGE_TEC_PROTO_WET_3
					days = 30
					target = root
					variable = {
						type = name
						localization = PLANET
						scope = root
					}
				}
			}
			planet_event = {
				id = tec_protoworld.200
				days = @tec_proto_random_1
				random = @tec_proto_random_2
			}
		}
		if = {	# 6
			limit = {
				check_variable = {
					which = tec_proto_wet
					value >= 6
				}
				NOT = {
					has_planet_flag = tec_protoworld_changing_wet_2
				}
			}
			set_planet_flag = tec_protoworld_changing_wet_1
			set_planet_flag = tec_protoworld_changing_wet_2
			owner = {
				create_message = {
					type = MESSAGE_TEC_PROTO_WET_2
					localization = MESSAGE_TEC_PROTO_WET_2
					days = 30
					target = root
					variable = {
						type = name
						localization = PLANET
						scope = root
					}
				}
			}
			planet_event = {
				id = tec_protoworld.400
				days = @tec_proto_random_11
				random = @tec_proto_random_22
			}
			
		}
		if = {	# 3
			limit = {
				check_variable = {
					which = tec_proto_wet
					value >= 3
				}
				check_variable = {
					which = tec_proto_wet
					value < 6
				}
				NOT = {
					has_planet_flag = tec_protoworld_changing_wet_1
				}
			}
			set_planet_flag = tec_protoworld_changing_wet_1
			owner = {
				create_message = {
					type = MESSAGE_TEC_PROTO_WET_1
					localization = MESSAGE_TEC_PROTO_WET_1
					days = 30
					target = root
					variable = {
						type = name
						localization = PLANET
						scope = root
					}
				}
			}
		}
	
		# Cold class
		if = {	# 8
			limit = {
				check_variable = {
					which = tec_proto_cold
					value >= 8
				}
				NOT = {
					has_planet_flag = tec_protoworld_changing_cold_3
				}
			}
			set_planet_flag = tec_protoworld_changing_cold_1
			set_planet_flag = tec_protoworld_changing_cold_2
			set_planet_flag = tec_protoworld_changing_cold_3
			owner = {
				create_message = {
					type = MESSAGE_TEC_PROTO_COLD_3
					localization = MESSAGE_TEC_PROTO_COLD_3
					days = 30
					target = root
					variable = {
						type = name
						localization = PLANET
						scope = root
					}
				}
			}
			planet_event = {
				id = tec_protoworld.300
				days = @tec_proto_random_1
				random = @tec_proto_random_2
			}
		}
		if = {	# 6
			limit = {
				check_variable = {
					which = tec_proto_cold
					value >= 6
				}
				NOT = {
					has_planet_flag = tec_protoworld_changing_cold_2
				}
			}
			set_planet_flag = tec_protoworld_changing_cold_1
			set_planet_flag = tec_protoworld_changing_cold_2
			owner = {
				create_message = {
					type = MESSAGE_TEC_PROTO_COLD_2
					localization = MESSAGE_TEC_PROTO_COLD_2
					days = 30
					target = root
					variable = {
						type = name
						localization = PLANET
						scope = root
					}
				}
			}
			planet_event = {
				id = tec_protoworld.400
				days = @tec_proto_random_11
				random = @tec_proto_random_22
			}
		}
		if = {	# 3
			limit = {
				check_variable = {
					which = tec_proto_cold
					value >= 3
				}
				check_variable = {
					which = tec_proto_cold
					value < 6
				}
				NOT = {
					has_planet_flag = tec_protoworld_changing_cold_1
				}
			}
			set_planet_flag = tec_protoworld_changing_cold_1
			owner = {
				create_message = {
					type = MESSAGE_TEC_PROTO_COLD_1
					localization = MESSAGE_TEC_PROTO_COLD_1
					days = 30
					target = root
					variable = {
						type = name
						localization = PLANET
						scope = root
					}
				}
			}
		}
	}
}

# Atmosphere notes:
# Reddish
	# atmosphere_color 		= hsv { 0.1 0.6 1.0 }
	# atmosphere_color 		= hsv { 0.1 0.8 1.0.0 }
	# atmosphere_color 		= hsv { 0.05 0.75 0.9 }

# Greenish
	# atmosphere_color 		= hsv { 0.4 0.35 0.9 }
	# atmosphere_color 		= hsv { 0.35 0.25 0.9 }
	# atmosphere_color 		= hsv { 0.35 0.35 0.9 }

# Blueish
	# atmosphere_color 		= hsv { 0.55 0.35 0.9 }
	# atmosphere_color 		= hsv { 0.5 0.6 0.9 }
	# atmosphere_color 		= hsv { 0.6 0.6 0.9 }

# Purple
	# 291 100 77	0.4/0/0.8
	# atmosphere_color 		= hsv { 0.4 0 0.8 }
	# atmosphere_color 		= hsv { 0.5 0.6 0.9 }
	# atmosphere_color 		= hsv { 0.6 0.6 0.9 }

	#set_planet_entity = {
	#	atmosphere_color 		= rgb { 180 45 220 }
	#}
# Perfected
# 

# Graphic planet change
planet_event = {
	id = tec_protoworld.10
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		uses_district_set = tec_protoworld
	}

	immediate = {
		# Sorts by original planet designation
		# > barren
		if = {
			limit = {
				NOR = {
					has_planet_flag = tec_molten_protoworld
					has_planet_flag = tec_toxic_protoworld
					has_planet_flag = tec_frozen_protoworld
				}
			}
			# hot
			if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_hot_1
					NOT = {
						has_planet_flag = tec_protoworld_changing_hot_2	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_basic_01_entity"
					atmosphere_color 		= hsv { 0.1 0.6 1.0 }
				}
				
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_hot_2
					NOT = {
						has_planet_flag = tec_protoworld_changing_hot_3	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_basic_01_entity"
					atmosphere_color 		= hsv { 0.1 0.8 1.0 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_hot_3
				}
				set_planet_entity = {
					entity = "tec_protoworld_basic_01_entity"
					atmosphere_color 		= hsv { 0.05 0.75 0.9 }
				}
			}

			# wet
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_wet_1
					NOT = {
						has_planet_flag = tec_protoworld_changing_wet_2	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_basic_cloudy_01_entity"
					atmosphere_color 		= hsv { 0.4 0.35 0.9 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_wet_2
					NOT = {
						has_planet_flag = tec_protoworld_changing_wet_3	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_basic_cloudy_01_entity"
					atmosphere_color 		= hsv { 0.35 0.25 0.9 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_wet_3
				}
				set_planet_entity = {
					entity = "tec_protoworld_basic_cloudy_01_entity"
					atmosphere_color 		= hsv { 0.35 0.35 0.9 }
				}
			}

			
			# cold
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_cold_1
					NOT = {
						has_planet_flag = tec_protoworld_changing_cold_2	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_basic_smog_01_entity"
					atmosphere_color 		= hsv { 0.55 0.35 0.9 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_cold_2
					NOT = {
						has_planet_flag = tec_protoworld_changing_cold_3	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_basic_smog_01_entity"
					atmosphere_color 		= hsv { 0.5 0.6 0.9 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_cold_3
				}
				set_planet_entity = {
					entity = "tec_protoworld_basic_smog_01_entity"
					atmosphere_color 		= hsv { 0.6 0.6 0.9 }
				}
			}

		}

		# > molten
		else_if = {
			limit = {
				has_planet_flag = tec_molten_protoworld
			}

			# hot
			if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_hot_1
					NOT = {
						has_planet_flag = tec_protoworld_changing_hot_2	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_hot_01_entity"
					atmosphere_color 		= hsv { 0.1 0.6 1.0 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_hot_2
					NOT = {
						has_planet_flag = tec_protoworld_changing_hot_3	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_hot_01_entity"
					atmosphere_color 		= hsv { 0.1 0.8 1.0 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_hot_3
				}
				set_planet_entity = {
					entity = "tec_protoworld_hot_01_entity"
					atmosphere_color 		= hsv { 0.05 0.75 0.9 }
				}
			}

			# wet
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_wet_1
					NOT = {
						has_planet_flag = tec_protoworld_changing_wet_2	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_hot_cloudy_01_entity"
					atmosphere_color 		= hsv { 0.4 0.35 0.9 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_wet_2
					NOT = {
						has_planet_flag = tec_protoworld_changing_wet_3	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_hot_cloudy_01_entity"
					atmosphere_color 		= hsv { 0.35 0.25 0.9 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_wet_3
				}
				set_planet_entity = {
					entity = "tec_protoworld_basic_cloudy_01_entity"
					atmosphere_color 		= hsv { 0.35 0.35 0.9 }
				}
			}

			
			# cold
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_cold_1
					NOT = {
						has_planet_flag = tec_protoworld_changing_cold_2	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_hot_smog_01_entity"
					atmosphere_color 		= hsv { 0.55 0.35 0.9 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_cold_2
					NOT = {
						has_planet_flag = tec_protoworld_changing_cold_3	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_hot_smog_01_entity"
					atmosphere_color 		= hsv { 0.5 0.6 0.9 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_cold_3
				}
				set_planet_entity = {
					entity = "tec_protoworld_cold_01_entity"
					atmosphere_color 		= hsv { 0.6 0.6 0.9 }
				}
			}

		}

		# > toxic
		else_if = {
			limit = {
				has_planet_flag = tec_toxic_protoworld
			}

			# hot
			if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_hot_1
					NOT = {
						has_planet_flag = tec_protoworld_changing_hot_2	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_wet_01_entity"
					atmosphere_color 		= hsv { 0.1 0.6 1.0 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_hot_2
					NOT = {
						has_planet_flag = tec_protoworld_changing_hot_3	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_wet_01_entity"
					atmosphere_color 		= hsv { 0.1 0.8 1.0 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_hot_3
				}
				set_planet_entity = {
					entity = "tec_protoworld_basic_01_entity"
					atmosphere_color 		= hsv { 0.05 0.75 0.9 }
				}
			}

			# wet
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_wet_1
					NOT = {
						has_planet_flag = tec_protoworld_changing_wet_2	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_wet_cloudy_01_entity"
					atmosphere_color 		= hsv { 0.4 0.35 0.9 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_wet_2
					NOT = {
						has_planet_flag = tec_protoworld_changing_wet_3	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_wet_01_entity"
					atmosphere_color 		= hsv { 0.35 0.25 0.9 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_wet_3
				}
				set_planet_entity = {
					entity = "tec_protoworld_wet_cloudy_01_entity"
					atmosphere_color 		= hsv { 0.35 0.35 0.9 }
				}
			}

			
			# cold
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_cold_1
					NOT = {
						has_planet_flag = tec_protoworld_changing_cold_2	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_wet_smog_01_entity"
					atmosphere_color 		= hsv { 0.55 0.35 0.9 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_cold_2
					NOT = {
						has_planet_flag = tec_protoworld_changing_cold_3	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_wet_01_entity"
					atmosphere_color 		= hsv { 0.5 0.6 0.9 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_cold_3
				}
				set_planet_entity = {
					entity = "tec_protoworld_cold_01_entity"
					atmosphere_color 		= hsv { 0.6 0.6 0.9 }
				}
			}
		}

		# > frozen
		else_if = {
			limit = {
				has_planet_flag = tec_frozen_protoworld
			}

			# hot
			if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_hot_1
					NOT = {
						has_planet_flag = tec_protoworld_changing_hot_2	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_cold_01_entity"
					atmosphere_color 		= hsv { 0.1 0.6 1.0 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_hot_2
					NOT = {
						has_planet_flag = tec_protoworld_changing_hot_3	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_cold_noclouds_01_entity"
					atmosphere_color 		= hsv { 0.1 0.8 1.0 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_hot_3
				}
				set_planet_entity = {
					entity = "tec_protoworld_hot_01_entity"
					atmosphere_color 		= hsv { 0.05 0.75 0.9 }
				}
			}

			# wet
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_wet_1
					NOT = {
						has_planet_flag = tec_protoworld_changing_wet_2	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_cold_cloudy_01_entity"
					atmosphere_color 		= hsv { 0.4 0.35 0.9 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_wet_2
					NOT = {
						has_planet_flag = tec_protoworld_changing_wet_3	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_cold_cloudy_01_entity"
					atmosphere_color 		= hsv { 0.35 0.25 0.9 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_wet_3
				}
				set_planet_entity = {
					entity = "tec_protoworld_wet_cloudy_01_entity"
					atmosphere_color 		= hsv { 0.35 0.35 0.9 }
				}
			}

			
			# cold
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_cold_1
					NOT = {
						has_planet_flag = tec_protoworld_changing_cold_2	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_cold_01_entity"
					atmosphere_color 		= hsv { 0.55 0.35 0.9 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_cold_2
					NOT = {
						has_planet_flag = tec_protoworld_changing_cold_3	
					}
				}
				set_planet_entity = {
					entity = "tec_protoworld_cold_smog_01_entity"
					atmosphere_color 		= hsv { 0.5 0.6 0.9 }
				}
			}
			else_if = {
				limit = {
					has_planet_flag = tec_protoworld_changing_cold_3
				}
				set_planet_entity = {
					entity = "tec_protoworld_cold_smog_01_entity"
					atmosphere_color 		= hsv { 0.6 0.6 0.9 }
				}
			}
		}
	}
}

# Planet class change
planet_event = {
	id = tec_protoworld.20
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		uses_district_set = tec_protoworld
		NOT = {
			has_planet_flag = tec_proto_locked_terraform
		}
	}
	# Protoworld terraform lotto
	# Desert - Full energy
	# Arid - Energy + minerals
	# Savannah - Energy + food
	# Continental	- Food + Energy
	# Tropical	- Full food
	# Ocean	- Food + minerals
	# Alpine - Minerals + Energy
	# Tundra - Minerals + food
	# Arctic - Full minerals
	immediate = {
		set_planet_flag = tec_terraformed_by_@from
		# Saves districts in variables
		while = {
			limit = {
				num_districts = {
					type = district_tec_proto_generator
					value > 0
				}
			}
			remove_district = district_tec_proto_generator
			change_variable = {
				which = tec_temp_generator_districts
				value = 1
			}
		}
		while = {
			limit = {
				num_districts = {
					type = district_tec_proto_mining
					value > 0
				}
			}
			remove_district = district_tec_proto_mining
			change_variable = {
				which = tec_temp_mining_districts
				value = 1
			}
		}
		while = {
			limit = {
				num_districts = {
					type = district_tec_proto_farming
					value > 0
				}
			}
			remove_district = district_tec_proto_farming
			change_variable = {
				which = tec_temp_farming_districts
				value = 1
			}
		}
		# Saves special deposits
		
		# Desert - Full energy
		if = {
			limit = {
				OR = {
					has_planet_flag = tec_protoworld_changing_hot_3
					has_planet_flag = tec_protoworld_changing_hot_2
				}
				NOR = {
					check_variable = {
						which = tec_proto_wet
						value > 3
					}
					check_variable = {
						which = tec_proto_cold
						value > 3
					}
				}
			}

			tec_planet_terraform_planet = {
				class = pc_desert
			}

			reroll_deposits = yes
			set_planet_entity = {
				atmosphere_color = hsv { 0.05 0.75 0.9 }
			}
			
			if = {
				limit = {
					check_modifier_value = {
						modifier = district_generator_max
						value < 13
					}
				}
				
				while = {
					limit = {
						check_modifier_value = {
							modifier = district_generator_max
							value < 13
						}
					}
					add_deposit = d_searing_desert
					calculate_modifier = yes
				}
			}
						
		}

		# Arid - Energy + minerals
		if = {
			limit = {
				OR = {
					has_planet_flag = tec_protoworld_changing_hot_2
					has_planet_flag = tec_protoworld_changing_hot_3
				}
				OR = {
					has_planet_flag = tec_protoworld_changing_cold_1
					check_variable = {
						which = tec_proto_cold
						value >= 3
					}
				}
			}
			tec_planet_terraform_planet = {
				class = pc_arid
			}
			reroll_deposits = yes
			set_planet_entity = {
				atmosphere_color = hsv { 0.1 0.8 1.0 }
			}

			if = {
				limit = {
					check_modifier_value = {
						modifier = district_generator_max
						value < 9
					}
				}
				while = {
					limit = {
						check_modifier_value = {
							modifier = district_generator_max
							value < 10
						}
					}
					add_deposit = d_searing_desert
					calculate_modifier = yes
				}
			}
			
			if = {
				limit = {
					check_modifier_value = {
						modifier = district_mining_max
						value < 6
					}
				}
				while = {
					limit = {
						check_modifier_value = {
							modifier = district_mining_max
							value < 7
						}
					}
					add_deposit = d_prosperous_mesa
					calculate_modifier = yes
				}
			}
		}

		# Savannah - Energy + food
		if = {
			limit = {
				OR = {
					has_planet_flag = tec_protoworld_changing_hot_2
					has_planet_flag = tec_protoworld_changing_hot_3
				}
				OR = {
					has_planet_flag = tec_protoworld_changing_wet_1
					check_variable = {
						which = tec_proto_wet
						value >= 3
					}
				}
			}
			tec_planet_terraform_planet = {
				class = pc_savannah
			}
			reroll_deposits = yes
			set_planet_entity = {
				atmosphere_color = hsv { 0.1 0.6 1.0 }
			}

			if = {
				limit = {
					check_modifier_value = {
						modifier = district_generator_max
						value < 9
					}
				}
				while = {
					limit = {
						check_modifier_value = {
							modifier = district_generator_max
							value < 10
						}
					}
					add_deposit = d_searing_desert
					calculate_modifier = yes
				}
			}
			
			if = {
				limit = {
					check_modifier_value = {
						modifier = district_farming_max
						value < 6
					}
				}
				while = {
					limit = {
						check_modifier_value = {
							modifier = district_farming_max
							value < 7
						}
					}
					add_deposit = d_fertile_lands
					calculate_modifier = yes
				}
			}
		}

		# Tropical	- Full food
		if = {
			limit = {
				OR = {
					has_planet_flag = tec_protoworld_changing_wet_3
					has_planet_flag = tec_protoworld_changing_wet_2
				}
				NOR = {
					check_variable = {
						which = tec_proto_hot
						value > 3
					}
					check_variable = {
						which = tec_proto_cold
						value > 3
					}
				}
			}
			tec_planet_terraform_planet = {
				class = pc_tropical
			}
			reroll_deposits = yes
			set_planet_entity = {
				atmosphere_color = hsv { 0.35 0.35 0.9 }
			}

			if = {
				limit = {
					check_modifier_value = {
						modifier = district_farming_max
						value < 12
					}
				}
				while = {
					limit = {
						check_modifier_value = {
							modifier = district_farming_max
							value < 13
						}
					}
					add_deposit = d_fertile_lands
					calculate_modifier = yes
				}
			}
						
		}

		# Continental	- Food + Energy
		if = {
			limit = {
				OR = {
					has_planet_flag = tec_protoworld_changing_wet_2
					has_planet_flag = tec_protoworld_changing_wet_3
				}
				OR = {
					has_planet_flag = tec_protoworld_changing_hot_1
					check_variable = {
						which = tec_proto_hot
						value >= 3
					}
				}
			}
			tec_planet_terraform_planet = {
				class = pc_continental
			}
			reroll_deposits = yes
			set_planet_entity = {
				atmosphere_color = hsv { 0.35 0.25 0.9 }
			}

			if = {
				limit = {
					check_modifier_value = {
						modifier = district_farming_max
						value < 9
					}
				}
				while = {
					limit = {
						check_modifier_value = {
							modifier = district_farming_max
							value < 10
						}
					}
					add_deposit = d_fertile_lands
					calculate_modifier = yes
				}
			}
			
			if = {
				limit = {
					check_modifier_value = {
						modifier = district_generator_max
						value < 6
					}
				}
				while = {
					limit = {
						check_modifier_value = {
							modifier = district_generator_max
							value < 7
						}
					}
					add_deposit = d_searing_desert
					calculate_modifier = yes
				}
			}
		}
		
		# Ocean	- Food + minerals
		if = {
			limit = {
				OR = {
					has_planet_flag = tec_protoworld_changing_wet_2
					has_planet_flag = tec_protoworld_changing_wet_3
				}
				OR = {
					has_planet_flag = tec_protoworld_changing_cold_1
					check_variable = {
						which = tec_proto_cold
						value >= 3
					}
				}
			}
			tec_planet_terraform_planet = {
				class = pc_ocean
			}
			reroll_deposits = yes
			set_planet_entity = {
				atmosphere_color = hsv { 0.4 0.35 0.9 }
			}

			if = {
				limit = {
					check_modifier_value = {
						modifier = district_farming_max
						value < 9
					}
				}
				while = {
					limit = {
						check_modifier_value = {
							modifier = district_farming_max
							value < 10
						}
					}
					add_deposit = d_fertile_lands
					calculate_modifier = yes
				}
			}
			
			if = {
				limit = {
					check_modifier_value = {
						modifier = district_farming_max
						value < 6
					}
				}
				while = {
					limit = {
						check_modifier_value = {
							modifier = district_mining_max
							value < 7
						}
					}
					add_deposit = d_prosperous_mesa
					calculate_modifier = yes
				}
			}
		}

		# Alpine - Minerals + Energy
		if = {
			limit = {
				OR = {
					has_planet_flag = tec_protoworld_changing_cold_2
					has_planet_flag = tec_protoworld_changing_cold_3
				}
				OR = {
					has_planet_flag = tec_protoworld_changing_hot_1
					check_variable = {
						which = tec_proto_hot
						value >= 3
					}
				}
			}
			tec_planet_terraform_planet = {
				class = pc_alpine
			}
			reroll_deposits = yes
			set_planet_entity = {
				atmosphere_color = hsv { 0.55 0.35 0.9 }
			}

			if = {
				limit = {
					check_modifier_value = {
						modifier = district_mining_max
						value < 9
					}
				}
				while = {
					limit = {
						check_modifier_value = {
							modifier = district_mining_max
							value < 10
						}
					}
					add_deposit = d_prosperous_mesa
					calculate_modifier = yes
				}
			}
			
			if = {
				limit = {
					check_modifier_value = {
						modifier = district_generator_max
						value < 6
					}
				}
				while = {
					limit = {
						check_modifier_value = {
							modifier = district_generator_max
							value < 7
						}
					}
					add_deposit = d_frozen_gas_lake
					calculate_modifier = yes
				}
			}
		}

		# Tundra - Minerals + food
		if = {
			limit = {
				OR = {
					has_planet_flag = tec_protoworld_changing_cold_2
					has_planet_flag = tec_protoworld_changing_cold_3
				}
				OR = {
					has_planet_flag = tec_protoworld_changing_wet_1
					check_variable = {
						which = tec_proto_wet
						value >= 3
					}
				}
			}
			tec_planet_terraform_planet = {
				class = pc_tundra
			}
			reroll_deposits = yes
			set_planet_entity = {
				atmosphere_color = hsv { 0.5 0.6 0.9 }
			}

			if = {
				limit = {
					check_modifier_value = {
						modifier = district_mining_max
						value < 9
					}
				}
				while = {
					limit = {
						check_modifier_value = {
							modifier = district_mining_max
							value < 10
						}
					}
					add_deposit = d_prosperous_mesa
					calculate_modifier = yes
				}
			}
			
			if = {
				limit = {
					check_modifier_value = {
						modifier = district_farming_max
						value < 6
					}
				}
				while = {
					limit = {
						check_modifier_value = {
							modifier = district_farming_max
							value < 7
						}
					}
					add_deposit = d_fertile_lands
					calculate_modifier = yes
				}
			}
		}

		# Arctic - Full minerals
		if = {
			limit = {
				OR = {
					has_planet_flag = tec_protoworld_changing_cold_3
					has_planet_flag = tec_protoworld_changing_cold_2
				}
				NOR = {
					check_variable = {
						which = tec_proto_hot
						value > 3
					}
					check_variable = {
						which = tec_proto_wet
						value > 3
					}
				}
			}
			tec_planet_terraform_planet = {
				class = pc_arctic
			}
			reroll_deposits = yes
			set_planet_entity = {
				atmosphere_color = hsv { 0.6 0.6 0.9 }
			}

			if = {
				limit = {
					check_modifier_value = {
						modifier = district_mining_max
						value < 12
					}
				}
				while = {
					limit = {
						check_modifier_value = {
							modifier = district_mining_max
							value < 13
						}
					}
					add_deposit = d_prosperous_mesa
					calculate_modifier = yes
				}
			}
						
		}

		# Gaian
		# Are you even serious?
		if = {
			limit = {
				has_planet_flag = tec_protoworld_changing_hot_3
				has_planet_flag = tec_protoworld_changing_wet_3
				has_planet_flag = tec_protoworld_changing_cold_3
				check_variable = {
					which = tec_proto_hot
					value >= 3
				}
				check_variable = {
					which = tec_proto_wet
					value >= 3
				}
				check_variable = {
					which = tec_proto_cold
					value >= 3
				}
			}
			tec_planet_make_gaia = yes
			
			reroll_deposits = yes

			if = {
				limit = {
					check_modifier_value = {
						modifier = district_generator_max
						value < 12
					}
				}
				while = {
					limit = {
						check_modifier_value = {
							modifier = district_generator_max
							value < 13
						}
					}
					add_deposit = d_rushing_waterfalls
					calculate_modifier = yes
				}
			}
			if = {
				limit = {
					check_modifier_value = {
						modifier = district_mining_max
						value < 12
					}
				}
				while = {
					limit = {
						check_modifier_value = {
							modifier = district_mining_max
							value < 13
						}
					}
					add_deposit = d_prosperous_mesa
					calculate_modifier = yes
				}
			}
			if = {
				limit = {
					check_modifier_value = {
						modifier = district_farming_max
						value < 12
					}
				}
				while = {
					limit = {
						check_modifier_value = {
							modifier = district_farming_max
							value < 13
						}
					}
					add_deposit = d_marvelous_oasis
					calculate_modifier = yes
				}
			}
						
		}


		# Changes size to fixed amounts
		#if = {
		#	limit = {
		#		check_variable = {
		#			which = tec_prev_size
		#			value >= 20
		#			value <
		#		}
		#	}
		#}

		# Removes all the flags
		remove_planet_flag = tec_protoworld_candidate

		remove_planet_flag = tec_protoworld_started_terraform

		remove_planet_flag = tec_protoworld_changing_city

		remove_planet_flag = tec_protoworld_changing_perfect

		remove_planet_flag = tec_protoworld_valid_forceform

		remove_planet_flag = tec_protoworld_changing_hot_1
		remove_planet_flag = tec_protoworld_changing_hot_2
		remove_planet_flag = tec_protoworld_changing_hot_3

		remove_planet_flag = tec_protoworld_changing_wet_1
		remove_planet_flag = tec_protoworld_changing_wet_2
		remove_planet_flag = tec_protoworld_changing_wet_3

		remove_planet_flag = tec_protoworld_changing_cold_1
		remove_planet_flag = tec_protoworld_changing_cold_2
		remove_planet_flag = tec_protoworld_changing_cold_3
		
		# Re-Creates districts
		while = {
			limit = {
				check_variable = {
					which = tec_temp_generator_districts
					value > 0
				}
			}
			add_district = district_generator
			change_variable = {
				which = tec_temp_generator_districts
				value = -1
			}
		}
		while = {
			limit = {
				check_variable = {
					which = tec_temp_mining_districts
					value > 0
				}
			}
			add_district = district_mining
			change_variable = {
				which = tec_temp_mining_districts
				value = -1
			}
		}
		while = {
			limit = {
				check_variable = {
					which = tec_temp_farming_districts
					value > 0
				}
			}
			add_district = district_farming
			change_variable = {
				which = tec_temp_farming_districts
				value = -1
			}
		}
		clear_variable = tec_temp_generator_districts
		clear_variable = tec_temp_mining_districts
		clear_variable = tec_temp_farming_districts
		remove_modifier = pm_tec_protoworld_modifier
		if = {
			limit = {
				has_modifier = pm_tec_protoworld_modifier
			}
			while = {
				limit = {
					has_modifier = pm_tec_protoworld_modifier
				}
				remove_modifier = pm_tec_protoworld_modifier
			}
		}
		if = {
			limit = {
				has_modifier = pm_tec_terra_proto_random
			}
			while = {
				limit = {
					has_modifier = pm_tec_terra_proto_random
				}
				remove_modifier = pm_tec_terra_proto_random
			}
		}
		validate_planet_buildings_and_districts = yes
	}

	after = {
		# Creates indication for owner
		owner = {
			create_message = {
				type = TERRAFORM_MESSAGE_TYPE
				localization = MESSAGE_TEC_TERRAFORMATION
				days = 30
				target = root
				variable = {
					type = name
					localization = PLANET
					scope = root
				}
			#	variable = {
			#		type = name
			#		localization = PLANET_CLASS
			#		scope = root.planet_class
			#	}
			}
			change_variable = {		# faction variable
				which = tec_terraformed_worlds
				value = 1
			}
		}
	}
}

# Planet warming
planet_event = {
	id = tec_protoworld.100
	title = "tec_protoworld.100.name"
	desc = "tec_protoworld.100.desc"
	picture = GFX_evt_arid
	show_sound = event_mystic_reveal
	trackable = yes

	is_triggered_only = yes

	trigger = {
		NOT = {
			has_planet_flag = tec_protoworld_started_terraform
		}
		NOT = {
			has_planet_flag = tec_proto_locked_terraform
		}
	}

	option = {
		name = "tec_protoworld.100.a"
		custom_tooltip = tec_protoworld.100.a.tooltip
	}
	immediate = {
		hidden_effect = {
			add_modifier = {
				modifier = pm_tec_terra_proto_random
				days = @tec_proto_terra_timer
			}
			remove_modifier = pm_tec_protoworld_modifier

			set_planet_flag = tec_protoworld_started_terraform
			set_timed_planet_flag = {	# Allows the forced terraform
				flag = tec_protoworld_valid_forceform
				days = @tec_proto_terra_timer_half
			}
			# PD Pre-script, will fill in the future
				#	if = {
				#		limit = {
				#		#	has_global_flag = 
				#		}
				#		planet_event = {
				#			id = tec_protoworld.22
				#			days = @tec_proto_terra_timer
				#		}
				#	}
				#	else = {
				#		planet_event = {
				#			id = tec_protoworld.20
				#			days = @tec_proto_terra_timer
				#		}
				#	}
			planet_event = {
				id = tec_protoworld.20
				days = @tec_proto_terra_timer
			}
		}
	}
}

# Planet wetting
planet_event = {
	id = tec_protoworld.200
	title = "tec_protoworld.200.name"
	desc = "tec_protoworld.200.desc"
	picture = GFX_evt_continental
	show_sound = event_mystic_reveal
	trackable = yes

	is_triggered_only = yes

	trigger = {
		NOT = {
			has_planet_flag = tec_protoworld_started_terraform
		}
		NOT = {
			has_planet_flag = tec_proto_locked_terraform
		}
	}

	option = {
		name = "tec_protoworld.200.a"
		custom_tooltip = tec_protoworld.200.a.tooltip
	}
	immediate = {
		hidden_effect = {
			add_modifier = {
				modifier = pm_tec_terra_proto_random
				days = @tec_proto_terra_timer
			}
			remove_modifier = pm_tec_protoworld_modifier

			set_planet_flag = tec_protoworld_started_terraform
			set_timed_planet_flag = { 	# Allows the forced terraform
				flag = tec_protoworld_valid_forceform
				days = @tec_proto_terra_timer_half
			}
			# PD Pre-script, will fill in the future
				#	if = {
				#		limit = {
				#		#	has_global_flag = 
				#		}
				#		planet_event = {
				#			id = tec_protoworld.22
				#			days = @tec_proto_terra_timer
				#		}
				#	}
				#	else = {
				#		planet_event = {
				#			id = tec_protoworld.20
				#			days = @tec_proto_terra_timer
				#		}
				#	}
			planet_event = {
				id = tec_protoworld.20
				days = @tec_proto_terra_timer
			}
		}
	}
}

# Planet cooling
planet_event = {
	id = tec_protoworld.300
	title = "tec_protoworld.300.name"
	desc = "tec_protoworld.300.desc"
	picture = GFX_evt_tundra
	show_sound = event_mystic_reveal
	trackable = yes

	is_triggered_only = yes

	trigger = {
		NOT = {
			has_planet_flag = tec_protoworld_started_terraform
		}
		NOT = {
			has_planet_flag = tec_proto_locked_terraform
		}
	}

	option = {
		name = "tec_protoworld.300.a"
		custom_tooltip = tec_protoworld.300.a.tooltip
	}
	immediate = {
		hidden_effect = {
			add_modifier = {
				modifier = pm_tec_terra_proto_random
				days = @tec_proto_terra_timer
			}
			remove_modifier = pm_tec_protoworld_modifier

			set_planet_flag = tec_protoworld_started_terraform
			set_timed_planet_flag = {	# Allows the forced terraform
				flag = tec_protoworld_valid_forceform
				days = @tec_proto_terra_timer_half
			}
			# PD Pre-script, will fill in the future
				#	if = {
				#		limit = {
				#		#	has_global_flag = 
				#		}
				#		planet_event = {
				#			id = tec_protoworld.22
				#			days = @tec_proto_terra_timer
				#		}
				#	}
				#	else = {
				#		planet_event = {
				#			id = tec_protoworld.20
				#			days = @tec_proto_terra_timer
				#		}
				#	}
			planet_event = {
				id = tec_protoworld.20
				days = @tec_proto_terra_timer
			}
		}
	}
}

# Planet unknown
planet_event = {
	id = tec_protoworld.400
	title = "tec_protoworld.400.name"
	desc = "tec_protoworld.400.desc"
	picture = GFX_evt_drilling_for_gas
	show_sound = event_mystic_reveal
	trackable = yes
	location = root

	is_triggered_only = yes

	trigger = {
		NOT = {
			has_planet_flag = tec_protoworld_started_terraform
		}
		NOT = {
			has_planet_flag = tec_proto_locked_terraform
		}
	}

	option = {
		name = "tec_protoworld.400.a"
		custom_tooltip = tec_protoworld.400.a.tooltip
	}
	immediate = {
		hidden_effect = {
			add_modifier = {
				modifier = pm_tec_terra_proto_random
				days = @tec_proto_terra_timer_long
			}
			remove_modifier = pm_tec_protoworld_modifier

			set_planet_flag = tec_protoworld_started_terraform
			set_timed_planet_flag = {	# Allows the forced terraform
				flag = tec_protoworld_valid_forceform
				days = @tec_proto_terra_timer_long_half
			}
			# PD Pre-script, will fill in the future
				#	if = {
				#		limit = {
				#		#	has_global_flag = 
				#		}
				#		planet_event = {
				#			id = tec_protoworld.22
				#			days = @tec_proto_terra_timer
				#		}
				#	}
				#	else = {
				#		planet_event = {
				#			id = tec_protoworld.20
				#			days = @tec_proto_terra_timer
				#		}
				#	}
			planet_event = {
				id = tec_protoworld.20
				days = @tec_proto_terra_timer_long
			}
		}
	}
}

# First successful terraform

# First perfect terraform

# Planet terraformed

