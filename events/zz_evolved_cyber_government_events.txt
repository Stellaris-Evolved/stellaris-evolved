
namespace = tec_cyber

country_event = {
    id = tec_cyber.1
    title = "tec_cyber.1.name"
    desc = {
        trigger = {
            check_variable = {
                which = "cyber_individualist_society"
                value > cyber_collectivist_society
            }
        }
        text = tec_cyber.1.desc.individualist
    }
    desc = {
        trigger = {
            check_variable = {
                which = "cyber_individualist_society"
                value < cyber_collectivist_society
            }
        }
        text = tec_cyber.1.desc.collectivist
    }
    desc = {
        trigger = {
            check_variable = {
                which = "cyber_individualist_society"
                value = cyber_collectivist_society
            }
        }
        text = tec_cyber.1.desc.neutral
    }
    picture = GFX_evt_cyberization_1
    show_sound = event_cityscape
    location = from
    event_chain = futureshock_chain
    is_triggered_only = yes

    option = {
        trigger = {
            check_variable = {
                which = "cyber_individualist_society"
                value >= cyber_collectivist_society
            }
        }
        name = tec_cyber.1.a
        end_event_chain = futureshock_chain
        custom_tooltip = tec_cyber.1500.ind.tt
        set_country_flag = tec_has_cyber_individualist_tenet
        tec_internal_cult_new_cult_alarm = yes
        ai_chance = {
            factor = 1
        }
    }
    option = {
        trigger = {
            check_variable = {
                which = "cyber_individualist_society"
                value <= cyber_collectivist_society
            }
        }
        name = tec_cyber.1.b
        end_event_chain = futureshock_chain
        custom_tooltip = tec_cyber.1500.col.tt
        set_country_flag = tec_has_cyber_collectivist_tenet
        tec_internal_cult_new_cult_alarm = yes
        ai_chance = {
            factor = 1
        }
    }
    option = {
        name = tec_cyber.1.c
        end_event_chain = futureshock_chain
        custom_tooltip = tec_cyber.1500.no.tt
        trigger = { is_ai = no }
    }
}

# Remove old effects before reforming cyber swap government
# THIS = country
# Fired by: on_pre_government_changed
country_event = {
    id = tec_cyber.2
    hide_window = yes
    is_triggered_only = yes

    trigger = {
        is_country_type = default
        OR = {
            AND = {
                has_authority = auth_tec_ai
                has_country_flag = cyber_individualist
            }
        }
    }

    immediate = {
        if = {
            limit = {
                has_authority = auth_tec_ai
                has_country_flag = cyber_individualist
            }
            every_owned_leader = {
                limit = {
                    has_trait = leader_trait_tec_aiauth_cyber_assistant_uplink
                }
                remove_trait = leader_trait_tec_aiauth_cyber_assistant_uplink
            }
            every_pool_leader = {
                limit = {
                    has_trait = leader_trait_tec_aiauth_cyber_assistant_uplink
                }
                remove_trait = leader_trait_tec_aiauth_cyber_assistant_uplink
            }
        }
    }
}

# Add new effects after reforming cyber swap government
# THIS = country
# Fired by: on_post_government_changed
country_event = {
    id = tec_cyber.3
    hide_window = yes
    is_triggered_only = yes

    trigger = {
        is_country_type = default
        has_authority = auth_tec_ai
        has_country_flag = cyber_individualist
    }

    immediate = {
        if = {
            limit = {
                has_authority = auth_tec_ai
                has_country_flag = cyber_individualist
            }

            every_owned_leader = {
                limit = {
                    tec_is_aiauth_node = no
                }
                add_trait = leader_trait_tec_aiauth_cyber_assistant_uplink
            }
            every_pool_leader = {
                limit = {
                    tec_is_aiauth_node = no
                }
                add_trait = leader_trait_tec_aiauth_cyber_assistant_uplink
            }
        }
    }
}



country_event = {
    id = tec_cyber.4
    title = "tec_cyber.4.name"
    desc = {
        trigger = {
            check_variable = {
                which = "cyber_individualist_society"
                value > cyber_collectivist_society
            }
        }
        text = tec_cyber.4.desc.individualist
    }
    desc = {
        trigger = {
            check_variable = {
                which = "cyber_individualist_society"
                value < cyber_collectivist_society
            }
        }
        text = tec_cyber.4.desc.collectivist
    }
    desc = {
        trigger = {
            check_variable = {
                which = "cyber_individualist_society"
                value = cyber_collectivist_society
            }
        }
        text = tec_cyber.4.desc.neutral
    }
    picture = GFX_evt_cyberization_1
    show_sound = event_cityscape
    location = from
    event_chain = futureshock_chain
    is_triggered_only = yes

    option = {
        trigger = {
            check_variable = {
                which = "cyber_individualist_society"
                value >= cyber_collectivist_society
            }
        }
        name = tec_cyber.4.a
        end_event_chain = futureshock_chain
        custom_tooltip = tec_cyber.1500.ind.tt
        set_country_flag = tec_has_cyber_individualist_tenet
        tec_internal_cult_new_cult_alarm = yes
        ai_chance = {
            factor = 1
        }
    }
    option = {
        trigger = {
            check_variable = {
                which = "cyber_individualist_society"
                value <= cyber_collectivist_society
            }
        }
        name = tec_cyber.4.b
        end_event_chain = futureshock_chain
        custom_tooltip = tec_cyber.1500.col.tt
        set_country_flag = tec_has_cyber_collectivist_tenet
        tec_internal_cult_new_cult_alarm = yes
        ai_chance = {
            factor = 1
        }
    }
    option = {
        name = tec_cyber.4.c
        end_event_chain = futureshock_chain
        custom_tooltip = tec_cyber.1500.no.tt
        trigger = { is_ai = no }
    }
}

country_event = {
    id = tec_cyber.5
    hide_window = yes
    is_triggered_only = yes

    trigger = {
        is_country_type = default
        has_authority = auth_tec_patrocorporate
        has_country_flag = cyber_individualist
        has_edict = tec_idolware_initiative
    }

    immediate = {
        if = { # gate just in case
            limit = {
                has_edict = tec_idolware_initiative
            }

            every_owned_planet = {
                limit = {
                    num_assigned_jobs = { job = tec_cyber_idol value > 0 }
                }
                every_owned_pop = {
                    limit = {
                        has_job = tec_cyber_idol
                        NOT = {
                            has_trait = trait_tec_cyborg_idol_implants
                        }
                    }
                    modify_species = {
                        species = this
                        add_trait = trait_tec_cyborg_idol_implants
                        add_traits_at_start_of_list = yes
                    }
                }
                random_list = {
                    # Ruler
                    70 = {
                        modifier = {
                            factor = 0
                            NOT = {
                                any_owned_pop = {
                                    NOT = { has_trait = trait_tec_cyborg_idol_implants }
                                    tec_is_ruler_pop_category = yes
                                }
                            }
                        }
                        modify_species = {
                            species = this
                            add_trait = trait_tec_cyborg_idol_implants
                            add_traits_at_start_of_list = yes
                        }
                    }
                    # specialist
                    20 = {
                        modifier = {
                            factor = 0
                            NOT = {
                                any_owned_pop = {
                                    NOT = { has_trait = trait_tec_cyborg_idol_implants }
                                    tec_is_specialist_pop_category = yes
                                }
                            }
                        }
                        modify_species = {
                            species = this
                            add_trait = trait_tec_cyborg_idol_implants
                            add_traits_at_start_of_list = yes
                        }
                    }
                    # worker
                    10 = {
                        modifier = {
                            factor = 0
                            NOT = {
                                any_owned_pop = {
                                    NOT = { has_trait = trait_tec_cyborg_idol_implants }
                                    tec_is_worker_pop_category = yes
                                }
                            }
                        }
                        modify_species = {
                            species = this
                            add_trait = trait_tec_cyborg_idol_implants
                            add_traits_at_start_of_list = yes
                        }}
                    # no
                    100 = {
                        modifier = {
                            factor = 10
                            owner = {
                                has_deficit = consumer_goods
                            }
                        }
                    }
                }
            }
            country_event = {
                id = tec_cyber.5
                days = 90
            }
        }
    }

}